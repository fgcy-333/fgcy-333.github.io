

<!DOCTYPE html>
<html lang="en" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="John Doe">
  <meta name="keywords" content="">
  
    <meta name="description" content="1、安装前说明1.1 Linux系统及工具的准备安装并启动好两台虚拟机： CentOS 7掌握克隆虚拟机的操作  mac地址 主机名 ip地址 UUID  1、安装有 Xshell 和 Xftp 等访问CentOS系统的工具 2、CentOS6和CentOS7在MySQL的使用中的区别  防火墙：6是iptables，7是firewalld  启动服务的命令：6是service，7是systemc">
<meta property="og:type" content="article">
<meta property="og:title" content="第01章-Linux下MySQL的安装与使用-atguigu-shk">
<meta property="og:url" content="http://example.com/2023/03/30/MySQL-%E5%AE%8B%E7%BA%A2%E5%BA%B7-%E9%AB%98%E7%BA%A7-%E7%AC%AC01%E7%AB%A0-Linux%E4%B8%8BMySQL%E7%9A%84%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/index.html">
<meta property="og:site_name" content="FGCY-BLOG">
<meta property="og:description" content="1、安装前说明1.1 Linux系统及工具的准备安装并启动好两台虚拟机： CentOS 7掌握克隆虚拟机的操作  mac地址 主机名 ip地址 UUID  1、安装有 Xshell 和 Xftp 等访问CentOS系统的工具 2、CentOS6和CentOS7在MySQL的使用中的区别  防火墙：6是iptables，7是firewalld  启动服务的命令：6是service，7是systemc">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/images/mysql.png">
<meta property="article:published_time" content="2023-03-30T12:11:23.000Z">
<meta property="article:modified_time" content="2023-03-30T14:08:12.212Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="尚硅谷-宋红康-MySQL(高级)">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://example.com/images/mysql.png">
  
  
    <meta name="referrer" content="no-referrer-when-downgrade">
  
  
  <title>第01章-Linux下MySQL的安装与使用-atguigu-shk - FGCY-BLOG</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.4","typing":{"enable":true,"typeSpeed":333,"cursorChar":"%","loop":true,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>FGCY-BLOG</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                <span>主页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签列表</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                <span>关于我</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/playlist/">
                <i class="iconfont icon-music"></i>
                <span>音乐</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="第01章-Linux下MySQL的安装与使用-atguigu-shk"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2023-03-30 20:11" pubdate>
          March 30, 2023 pm
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    

    

    
    
      
        <span id="busuanzi_container_page_pv" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="busuanzi_value_page_pv"></span> views
        </span>
        
      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">第01章-Linux下MySQL的安装与使用-atguigu-shk</h1>
            
            
              <div class="markdown-body">
                
                <h1 id="1、安装前说明"><a href="#1、安装前说明" class="headerlink" title="1、安装前说明"></a>1、安装前说明</h1><h2 id="1-1-Linux系统及工具的准备"><a href="#1-1-Linux系统及工具的准备" class="headerlink" title="1.1 Linux系统及工具的准备"></a>1.1 Linux系统及工具的准备</h2><p>安装并启动好两台虚拟机： CentOS 7<br>掌握克隆虚拟机的操作</p>
<ul>
<li>mac地址</li>
<li>主机名</li>
<li>ip地址</li>
<li>UUID</li>
</ul>
<p>1、安装有 Xshell 和 Xftp 等访问CentOS系统的工具</p>
<p>2、CentOS6和CentOS7在MySQL的使用中的区别</p>
<ul>
<li>防火墙：6是iptables，7是firewalld </li>
<li>启动服务的命令：6是service，7是systemctl</li>
</ul>
<span id="more"></span>

<h2 id="1-2-查看是否安装过MySQL"><a href="#1-2-查看是否安装过MySQL" class="headerlink" title="1.2 查看是否安装过MySQL"></a>1.2 查看是否安装过MySQL</h2><p>查看M有SQL版本</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell">mysql --version<br><br><br>mysql  Ver 8.0.25 for Linux on x86_64 (MySQL Community Server - GPL)<br></code></pre></td></tr></table></figure>





<p>如果你是用rpm安装, 检查一下RPM PACKAGE：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs shell">rpm -qa | grep -i mysql # -i 忽略大小写<br><br><br><br>mysql-community-client-8.0.25-1.el7.x86_64<br>mysql-community-common-8.0.25-1.el7.x86_64<br>mysql-community-server-8.0.25-1.el7.x86_64<br>mysql-community-client-plugins-8.0.25-1.el7.x86_64<br>mysql-community-libs-8.0.25-1.el7.x86_64<br><br></code></pre></td></tr></table></figure>





<p>检查mysql service状态：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs shell">systemctl status mysqld.service<br><br><br><br>● mysqld.service - MySQL Server<br>   Loaded: loaded (/usr/lib/systemd/system/mysqld.service; enabled; vendor preset: disabled)<br>   Active: active (running) since 一 2022-07-04 14:49:20 CST; 10min ago<br>     Docs: man:mysqld(8)<br>           http://dev.mysql.com/doc/refman/en/using-systemd.html<br>  Process: 1098 ExecStartPre=/usr/bin/mysqld_pre_systemd (code=exited, status=0/SUCCESS)<br> Main PID: 1489 (mysqld)<br>   Status: &quot;Server is operational&quot;<br>    Tasks: 37<br>   CGroup: /system.slice/mysqld.service<br>           └─1489 /usr/sbin/mysqld<br></code></pre></td></tr></table></figure>

<p>当前服务处于运行状态</p>
<h2 id="1-3-MySQL的卸载"><a href="#1-3-MySQL的卸载" class="headerlink" title="1.3 MySQL的卸载"></a>1.3 MySQL的卸载</h2><p>1、关闭 mysql 服务</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs shell">systemctl stop mysqld.service <br><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">查看状态</span><br>systemctl status mysqld.service<br>● mysqld.service - MySQL Server<br>   Loaded: loaded (/usr/lib/systemd/system/mysqld.service; enabled; vendor preset: disabled)<br>   Active: inactive (dead) since 一 2022-07-04 15:03:18 CST; 50s ago<br>     Docs: man:mysqld(8)<br>           http://dev.mysql.com/doc/refman/en/using-systemd.html<br>  Process: 1489 ExecStart=/usr/sbin/mysqld $MYSQLD_OPTS (code=exited, status=0/SUCCESS)<br>  Process: 1098 ExecStartPre=/usr/bin/mysqld_pre_systemd (code=exited, status=0/SUCCESS)<br> Main PID: 1489 (code=exited, status=0/SUCCESS)<br>   Status: &quot;Server shutdown complete&quot;<br></code></pre></td></tr></table></figure>



<p>2、查看当前 mysql 安装状况</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs shell">rpm -qa | grep -i mysql <br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">或 yum list installed | grep mysql</span><br><br><br><br>mysql-community-client-8.0.25-1.el7.x86_64<br>mysql-community-common-8.0.25-1.el7.x86_64<br>mysql-community-server-8.0.25-1.el7.x86_64<br>mysql-community-client-plugins-8.0.25-1.el7.x86_64<br>mysql-community-libs-8.0.25-1.el7.x86_64<br></code></pre></td></tr></table></figure>



<p>3、卸载上述命令查询出的已安装程序</p>
<blockquote>
<p>格式： yum remove mysql-xxx mysql-xxx mysql-xxx mysqk-xxxx</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">删除文件</span><br>yum remove mysql-community-libs.x86_64 <br><br>已加载插件：fastestmirror, langpacks<br>正在解决依赖关系<br><span class="hljs-meta prompt_">--&gt; </span><span class="language-bash">正在检查事务</span><br><span class="hljs-meta prompt_">---&gt; </span><span class="language-bash">软件包 mysql-community-libs.x86_64.0.8.0.25-1.el7 将被 删除</span><br><span class="hljs-meta prompt_">--&gt; </span><span class="language-bash">正在处理依赖关系 mysql-community-libs(x86-64) &gt;= 8.0.11，它被软件包 mysql-community-client-8.0.25-1.el7.x86_64 需要</span><br><span class="hljs-meta prompt_">--&gt; </span><span class="language-bash">正在检查事务</span><br><span class="hljs-meta prompt_">---&gt; </span><span class="language-bash">软件包 mysql-community-client.x86_64.0.8.0.25-1.el7 将被 删除</span><br><span class="hljs-meta prompt_">--&gt; </span><span class="language-bash">正在处理依赖关系 mysql-community-client(x86-64) &gt;= 8.0.11，它被软件包 mysql-community-server-8.0.25-1.el7.x86_64 需要</span><br><span class="hljs-meta prompt_">--&gt; </span><span class="language-bash">正在检查事务</span><br><span class="hljs-meta prompt_">---&gt; </span><span class="language-bash">软件包 mysql-community-server.x86_64.0.8.0.25-1.el7 将被 删除</span><br><span class="hljs-meta prompt_">--&gt; </span><span class="language-bash">解决依赖关系完成</span><br><br>依赖关系解决<br><br>================================================================================================================================<br> Package                                                     架构                                        版本                                                 源                                              大小<br>================================================================================================================================<br>正在删除:<br> mysql-community-libs                                        x86_64                                      8.0.25-1.el7                                         installed                                       20 M<br>为依赖而移除:<br> mysql-community-client                                      x86_64                                      8.0.25-1.el7                                         installed                                      220 M<br> mysql-community-server                                      x86_64                                      8.0.25-1.el7                                         installed                                      2.0 G<br><br>事务概要<br>================================================================================================================================<br>移除  1 软件包 (+2 依赖软件包)<br><br>安装大小：2.2 G<br>是否继续？[y/N]：y<br>Downloading packages:<br>Running transaction check<br>Running transaction test<br>Transaction test succeeded<br>Running transaction<br>警告：RPM 数据库已被非 yum 程序修改。<br>  正在删除    : mysql-community-server-8.0.25-1.el7.x86_64                                                                                                                                                     1/3 <br>  正在删除    : mysql-community-client-8.0.25-1.el7.x86_64                                                                                                                                                     2/3 <br>  正在删除    : mysql-community-libs-8.0.25-1.el7.x86_64                                                                                                                                                       3/3 <br>  验证中      : mysql-community-client-8.0.25-1.el7.x86_64                                                                                                                                                     1/3 <br>  验证中      : mysql-community-libs-8.0.25-1.el7.x86_64                                                                                                                                                       2/3 <br>  验证中      : mysql-community-server-8.0.25-1.el7.x86_64                                                                                                                                                     3/3 <br><br>删除:<br>  mysql-community-libs.x86_64 0:8.0.25-1.el7                                                                                                                                                                       <br><br>作为依赖被删除:<br>  mysql-community-client.x86_64 0:8.0.25-1.el7                                                             mysql-community-server.x86_64 0:8.0.25-1.el7                                                            <br><br>完毕！<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">查看剩余文件</span><br> rpm -qa | grep -i mysql<br> <br>mysql-community-common-8.0.25-1.el7.x86_64<br>mysql-community-client-plugins-8.0.25-1.el7.x86_64<br><br><br><br><br><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">继续删除文件</span><br>yum remove mysql-community-client-plugins.x86_64 <br><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">继续删除文件</span><br>yum remove mysql-community-common.x86_64<br><br><br><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">查看剩余文件</span><br> rpm -qa | grep -i mysql<br></code></pre></td></tr></table></figure>

<p>务必卸载干净，反复执行 rpm -qa | grep -i mysql 确认是否有卸载残留</p>
<p>4、删除 mysql 相关文件 </p>
<p>查找相关文件</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs shell">find / -name mysql<br><br>/etc/selinux/targeted/active/modules/100/mysql<br>/etc/selinux/targeted/tmp/modules/100/mysql<br>/var/lib/mysql<br>/var/lib/mysql/mysql<br>/usr/lib64/mysql<br><br></code></pre></td></tr></table></figure>





<p>递归删除上述命令查找出的相关文件</p>
<blockquote>
<p> 格式：rm -rf xxx</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs shell">rm -rf /etc/selinux/targeted/active/modules/100/mysql<br>rm -rf /etc/selinux/targeted/active/modules/100/mysql<br>rm -rf /etc/selinux/targeted/tmp/modules/100/mysql<br>rm -rf /var/lib/mysql<br>rm -rf /var/lib/mysql/mysql<br>rm -rf /usr/lib64/mysql<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">验证是否删除干净</span><br>find / -name mysql<br></code></pre></td></tr></table></figure>



<p>5.删除 my.cnf</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">rm -rf /etc/my.cnf<br></code></pre></td></tr></table></figure>





<p>tip:</p>
<p>关闭锁屏</p>
<hr>
<p><img src="http://img.fgcy.xyz/image-20220704152707664.png" srcset="/img/loading.gif" lazyload alt="image-20220704152707664"></p>
<hr>
<hr>
<p><img src="http://img.fgcy.xyz/image-20220704152737451.png" srcset="/img/loading.gif" lazyload alt="image-20220704152737451"></p>
<hr>
<h1 id="2-MySQL的Linux版安装"><a href="#2-MySQL的Linux版安装" class="headerlink" title="2. MySQL的Linux版安装"></a>2. MySQL的Linux版安装</h1><h2 id="2-1-MySQL的4大版本"><a href="#2-1-MySQL的4大版本" class="headerlink" title="2.1 MySQL的4大版本"></a>2.1 MySQL的4大版本</h2><p>1、MySQL Community Server 社区版本，开源免费，自由下载，但不提供官方技术支持，适用于 大多数普通用户</p>
<p>2、MySQL Enterprise Edition 企业版本，需付费，不能在线下载，可以试用30天。提供了更多的 功能和更完备的技术支持，更适合于对数据库的功能和可靠性要	  求较高的企业客户</p>
<p>3、 MySQL Cluster 集群版，开源免费。用于架设集群服务器，可将几个MySQL Server封装成一个 Server。需要在社区版或企业版的基础上使用</p>
<p> 4、MySQL Cluster CGE 高级集群版，需付费</p>
<p>截止目前，官方最新版本为 MySQL Community Server 8.0.29</p>
<p>此前，8.0.0 在 2016.9.12日就发布了</p>
<p>本课程中<strong>主要使用 8.0.25版本</strong> 。同时为了更好的说明MySQL8.0新特性，还会安装 MySQL5.7 版 本，作为对比</p>
<p>此外，官方还提供了 MySQL Workbench （GUITOOL）一款专为MySQL设计的 ER&#x2F;数据库建模工具 。</p>
<p>它是 著名的数据库设计工具DBDesigner4的继任者。MySQLWorkbench又分为两个版本，分别是 社区版 （MySQL Workbench OSS）、 商用版 （MySQL WorkbenchSE）</p>
<h2 id="2-2-下载MySQL指定版本"><a href="#2-2-下载MySQL指定版本" class="headerlink" title="2.2 下载MySQL指定版本"></a>2.2 下载MySQL指定版本</h2><blockquote>
<p> 下载地址 官网：<a target="_blank" rel="noopener" href="https://www.mysql.com/">https://www.mysql.com</a></p>
</blockquote>
<p>打开官网，点击DOWNLOADS 然后，点击 MySQL Community(GPL) Downloads</p>
<hr>
<p><img src="http://img.fgcy.xyz/image-20220704153812291.png" srcset="/img/loading.gif" lazyload alt="image-20220704153812291"></p>
<hr>
<p>点击 MySQL Community Server</p>
<hr>
<p><img src="http://img.fgcy.xyz/image-20220704153851859.png" srcset="/img/loading.gif" lazyload alt="image-20220704153851859"></p>
<hr>
<p>选择历史版本：</p>
<hr>
<p><img src="http://img.fgcy.xyz/image-20220704153935653.png" srcset="/img/loading.gif" lazyload alt="image-20220704153935653"></p>
<hr>
<hr>
<p><img src="http://img.fgcy.xyz/image-20220704154138950-16569208557851.png" srcset="/img/loading.gif" lazyload alt="image-20220704154138950"></p>
<hr>
<p>下载的tar包，用压缩工具打开</p>
<p>解压后rpm安装包 </p>
<hr>
<p><img src="http://img.fgcy.xyz/image-20220704162629115.png" srcset="/img/loading.gif" lazyload alt="image-20220704162629115"></p>
<hr>
<hr>
<p><img src="http://img.fgcy.xyz/image-20220704162206879.png" srcset="/img/loading.gif" lazyload alt="image-20220704162206879"></p>
<hr>
<h3 id="2-3-CentOS7下检查MySQL依赖"><a href="#2-3-CentOS7下检查MySQL依赖" class="headerlink" title="2.3 CentOS7下检查MySQL依赖"></a>2.3 CentOS7下检查MySQL依赖</h3><pre><code class="hljs">1. 检查/tmp临时目录权限（必不可少） 由于mysql安装过程中，会通过mysql用户在/tmp目录下新建tmp_db文件，所以请给/tmp较大的权限。执 行 ：
</code></pre>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">chmod -R 777 /tmp<br></code></pre></td></tr></table></figure>



<ol start="2">
<li>安装前，检查依赖</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">1检</span><br>rpm -qa|grep libaio<br><br>libaio-0.3.109-13.el7.x86_64<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">2检</span><br>rpm -qa|grep net-tools<br>net-tools-2.0-0.25.20131004git.el7.x86_64<br></code></pre></td></tr></table></figure>



<p>注意：</p>
<p>如果不存在需要到centos安装盘里进行rpm安装。安装linux如果带图形化界面，这些都是安装好 的</p>
<h3 id="2-4-CentOS7下MySQL安装过程"><a href="#2-4-CentOS7下MySQL安装过程" class="headerlink" title="2.4 CentOS7下MySQL安装过程"></a>2.4 CentOS7下MySQL安装过程</h3><p>1、将安装程序拷贝到&#x2F;opt目录下</p>
<p>在mysql的安装文件目录下执行：（必须按照顺序执行）</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell">rpm -ivh mysql-community-common-8.0.25-1.el7.x86_64.rpm<br>rpm -ivh mysql-community-client-plugins-8.0.25-1.el7.x86_64.rpm<br>rpm -ivh mysql-community-libs-8.0.25-1.el7.x86_64.rpm<br>rpm -ivh mysql-community-client-8.0.25-1.el7.x86_64.rpm<br>rpm -ivh mysql-community-server-8.0.25-1.el7.x86_64.rpm<br></code></pre></td></tr></table></figure>



<p>注意: </p>
<p>如在检查工作时，没有检查mysql依赖环境在安装mysql-community-server会报错</p>
<p>参数解释：</p>
<figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs ada">rpm 是Redhat <span class="hljs-keyword">Package</span> <span class="hljs-title">Manage缩写，通过RPM的管理，用户可以把源代码包装成以rpm为扩展名的 文件形式，易于安装。</span><br><br>-i , <span class="hljs-comment">--install 安装软件包 </span><br>-v , <span class="hljs-comment">--verbose 提供更多的详细信息输出 </span><br>-h , <span class="hljs-comment">--hash 软件包安装的时候列出哈希标记 (和 -v 一起使用效果更好)，展示进度条</span><br></code></pre></td></tr></table></figure>





<p>安装过程中可能的报错信息：</p>
<hr>
<p><img src="http://img.fgcy.xyz/image-20220704163300022.png" srcset="/img/loading.gif" lazyload alt="image-20220704163300022"></p>
<hr>
<p>解决：</p>
<blockquote>
<p>一个命令：yum remove mysql-libs 解决，清除之前安装过的依赖即可</p>
</blockquote>
<p>2、查看MySQL版本</p>
<p>查看MySQL版本 执行如下命令，如果成功表示安装mysql成功。类似java -version如果打出版本等信息</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell">mysql --version<br><span class="hljs-meta prompt_">#</span><span class="language-bash">或</span><br>mysqladmin --version<br><br><br>mysql  Ver 8.0.25 for Linux on x86_64 (MySQL Community Server - GPL)<br></code></pre></td></tr></table></figure>





<p>执行如下命令，查看是否安装成功。需要增加 -i 不用去区分大小写，否则搜索不到</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs shell">rpm -qa|grep -i mysql<br><br>mysql-community-client-8.0.25-1.el7.x86_64<br>mysql-community-common-8.0.25-1.el7.x86_64<br>mysql-community-server-8.0.25-1.el7.x86_64<br>mysql-community-client-plugins-8.0.25-1.el7.x86_64<br>mysql-community-libs-8.0.25-1.el7.x86_64<br><br></code></pre></td></tr></table></figure>







<p>3、 服务的初始化 </p>
<p>为了保证数据库目录与文件的所有者为 mysql 登录用户，如果你是以 root 身份运行 mysql 服务，需要执 行下面的命令初始化：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">mysqld --initialize --user=mysql<br></code></pre></td></tr></table></figure>



<p>说明：</p>
<p> –initialize 选项默认以“安全”模式来初始化，则会为 root 用户生成一个密码并将 该密码标记为过 期 ，登录后你需要设置一个新的密码</p>
<p>生成的 临时密码 会往日志中记录一份</p>
<p>查看密码：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">cat /var/log/mysqld.log<br></code></pre></td></tr></table></figure>



<hr>
<p><img src="http://img.fgcy.xyz/image-20220704164119274.png" srcset="/img/loading.gif" lazyload alt="image-20220704164119274"></p>
<hr>
<p>root@localhost: 后面就是初始化的密码</p>
<p>4、启动MySQL，查看状态</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">#</span><span class="language-bash">加不加.service后缀都可以</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">启动：</span><br>systemctl start mysqld.service<br><br><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">关闭：</span><br>systemctl stop mysqld.service<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">重启：</span><br><br><br>systemctl restart mysqld.service<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">查看状态：</span><br>systemctl status mysqld.service<br><br>mysqld.service - MySQL Server<br>   Loaded: loaded (/usr/lib/systemd/system/mysqld.service; enabled; vendor preset: disabled)<br>   Active: active (running) since 一 2022-07-04 16:40:32 CST; 3s ago   # 启动状态<br>     Docs: man:mysqld(8)<br>           http://dev.mysql.com/doc/refman/en/using-systemd.html<br>  Process: 2942 ExecStartPre=/usr/bin/mysqld_pre_systemd (code=exited, status=0/SUCCESS)<br> Main PID: 2970 (mysqld)<br>   Status: &quot;Server is operational&quot;<br>    Tasks: 38<br>   CGroup: /system.slice/mysqld.service<br>           └─2970 /usr/sbin/mysqld<br><br></code></pre></td></tr></table></figure>





<p>注意：</p>
<p>mysqld 这个可执行文件就代表着 MySQL 服务器程序，运行这个可执行文件就可以直接启动一个 服务器进程</p>
<p>5、查看MySQL服务是否自启动</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs mysql">systemctl list-unit-files|grep mysqld.service<br><br><br><br><br>mysqld.service                                enabled <br></code></pre></td></tr></table></figure>

<p>默认是enabled</p>
<p>如不是enabled可以运行如下命令设置自启动</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">systemctl enable mysqld.service<br></code></pre></td></tr></table></figure>



<p>如果希望不进行自启动，运行如下命令设置</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">systemctl disable mysqld.service<br></code></pre></td></tr></table></figure>

<hr>
<p><img src="http://img.fgcy.xyz/image-20220704164656502.png" srcset="/img/loading.gif" lazyload alt="image-20220704164656502"></p>
<hr>
<h2 id="Linux系统下安装MySQL的几种方式"><a href="#Linux系统下安装MySQL的几种方式" class="headerlink" title="Linux系统下安装MySQL的几种方式"></a>Linux系统下安装MySQL的几种方式</h2><p> <strong>Linux系统下安装软件的常用三种方式：</strong> </p>
<h3 id="方式1：rpm命令"><a href="#方式1：rpm命令" class="headerlink" title="方式1：rpm命令"></a>方式1：rpm命令</h3><p>使用rpm命令安装扩展名为”.rpm”的软件包</p>
<p>.rpm包的一般格式：</p>
<hr>
<p><img src="http://img.fgcy.xyz/image-20220704154411875.png" srcset="/img/loading.gif" lazyload alt="image-20220704154411875"></p>
<hr>
<h3 id="方式2：yum命令"><a href="#方式2：yum命令" class="headerlink" title="方式2：yum命令"></a>方式2：yum命令</h3><p>需联网，从 互联网获取 的yum源，直接使用yum命令安装</p>
<h3 id="方式3：编译安装源码包"><a href="#方式3：编译安装源码包" class="headerlink" title="方式3：编译安装源码包"></a>方式3：编译安装源码包</h3><p>针对 tar.gz 这样的压缩格式，要用tar命令来解压；</p>
<p>如果是其它压缩格式，就使用其它命令</p>
<p>Linux系统下安装MySQL，官方给出多种安装方式</p>
<hr>
<p><img src="http://img.fgcy.xyz/image-20220704154630530.png" srcset="/img/loading.gif" lazyload alt="image-20220704154630530"></p>
<hr>
<p>这里不能直接选择CentOS 7系统的版本，所以选择与之对应的 Red Hat Enterprise Linux</p>
<p><a target="_blank" rel="noopener" href="https://downloads.mysql.com/archives/community/">https://downloads.mysql.com/archives/community/</a> 直接点Download下载RPM Bundle全量 包</p>
<p>包括了所有下面的组件。不需要一个一个下载了。</p>
<h1 id="3-MySQL登录"><a href="#3-MySQL登录" class="headerlink" title="3. MySQL登录"></a>3. MySQL登录</h1><h2 id="3-1-首次登录"><a href="#3-1-首次登录" class="headerlink" title="3.1 首次登录"></a>3.1 首次登录</h2><p>通过 mysql -hlocalhost -P3306 -uroot -p 进行登录，在Enter password：录入初始化密码</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs shell">mysql -uroot -p<br>Enter password: <br>Welcome to the MySQL monitor.  Commands end with ; or \g.<br>Your MySQL connection id is 3<br>Server version: 5.7.28<br><br>Copyright (c) 2000, 2019, Oracle and/or its affiliates. All rights reserved.<br><br>Oracle is a registered trademark of Oracle Corporation and/or its<br>affiliates. Other names may be trademarks of their respective<br>owners.<br><br>Type &#x27;help;&#x27; or &#x27;\h&#x27; for help. Type &#x27;\c&#x27; to clear the current input statement.<br><span class="hljs-meta prompt_">mysql&gt; </span><span class="language-bash"></span><br><span class="language-bash"></span><br></code></pre></td></tr></table></figure>





<h2 id="3-2-修改密码"><a href="#3-2-修改密码" class="headerlink" title="3.2 修改密码"></a>3.2 修改密码</h2><p>因为初始化密码默认是过期的，所以查看数据库会报错 </p>
<p>修改密码：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">ALTER USER &#x27;root&#x27;@&#x27;localhost&#x27; IDENTIFIED BY &#x27;new_password&#x27;;<br></code></pre></td></tr></table></figure>



<p>5.7版本之后（不含5.7），mysql加入了全新的密码安全机制。设置新密码太简单会报错</p>
<hr>
<p><img src="http://img.fgcy.xyz/image-20220704171016461.png" srcset="/img/loading.gif" lazyload alt="image-20220704171016461"></p>
<hr>
<p>改为更复杂的密码规则之后，设置成功，可以正常使用数据库了</p>
<hr>
<p><img src="http://img.fgcy.xyz/image-20220704171053988.png" srcset="/img/loading.gif" lazyload alt="image-20220704171053988"></p>
<hr>
<h2 id="3-3-设置远程登录"><a href="#3-3-设置远程登录" class="headerlink" title="3.3 设置远程登录"></a>3.3 设置远程登录</h2><p>1、 当前问题 在用SQLyog或Navicat中配置远程连接Mysql数据库时遇到如下报错信息，这是由于Mysql配置了不支持远 程连接引起的。</p>
<hr>
<p><img src="http://img.fgcy.xyz/image-20220704171529501.png" srcset="/img/loading.gif" lazyload alt="image-20220704171529501"></p>
<hr>
<p>2、确认网络</p>
<p> 1.在远程机器上使用ping ip地址 保证网络畅通</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs shell">ping 192.168.175.134<br><br>正在 Ping 192.168.175.134 具有 32 字节的数据:<br>来自 192.168.175.134 的回复: 字节=32 时间&lt;1ms TTL=64<br>来自 192.168.175.134 的回复: 字节=32 时间&lt;1ms TTL=64<br>来自 192.168.175.134 的回复: 字节=32 时间&lt;1ms TTL=64<br>来自 192.168.175.134 的回复: 字节=32 时间&lt;1ms TTL=64<br><br>192.168.175.134 的 Ping 统计信息:<br>    数据包: 已发送 = 4，已接收 = 4，丢失 = 0 (0% 丢失)，<br>往返行程的估计时间(以毫秒为单位):<br>    最短 = 0ms，最长 = 0ms，平均 = 0ms<br></code></pre></td></tr></table></figure>



<p> 2.在远程机器上使用telnet命令 保证端口号开放 访问</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">telnet 192.168.175.134 3306<br></code></pre></td></tr></table></figure>



<p>拓展： telnet命令开启 :</p>
<hr>
<p><img src="http://img.fgcy.xyz/image-20220704171746126.png" srcset="/img/loading.gif" lazyload alt="image-20220704171746126"></p>
<hr>
<hr>
<p><img src="http://img.fgcy.xyz/image-20220704171801356.png" srcset="/img/loading.gif" lazyload alt="image-20220704171801356"></p>
<hr>
<hr>
<p><img src="http://img.fgcy.xyz/image-20220704171902604.png" srcset="/img/loading.gif" lazyload alt="image-20220704171902604"></p>
<hr>
<p>3、.关闭防火墙或开放端口</p>
<p>方式一：关闭防火墙</p>
<p>CentOS6 ：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">service iptables stop<br></code></pre></td></tr></table></figure>



<p>CentOS7：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">开启防火墙</span><br>systemctl start firewalld.service<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">查看防火墙状态</span><br>systemctl status firewalld.service<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">停用</span><br>systemctl stop firewalld.service<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">设置开机启用防火墙</span><br>systemctl enable firewalld.service<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">设置开机禁用防火墙</span><br>systemctl disable firewalld.service<br><br></code></pre></td></tr></table></figure>



<p>方式二：开放端口</p>
<p>查看开放的端口号</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">firewall-cmd --list-all<br></code></pre></td></tr></table></figure>





<p>设置开放的端口号</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell">firewall-cmd --add-service=http --permanent<br><br><br>firewall-cmd --add-port=3306/tcp --permanent<br></code></pre></td></tr></table></figure>





<p>重启防火墙</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">firewall-cmd --reload<br></code></pre></td></tr></table></figure>







<p>4、Linux下修改配置 在Linux系统MySQL下测试：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs mysql">use mysql;<br><br>select Host,User from user;<br></code></pre></td></tr></table></figure>

<hr>
<p><img src="http://img.fgcy.xyz/image-20220704221609794.png" srcset="/img/loading.gif" lazyload alt="image-20220704221609794"></p>
<hr>
<p>可以看到root用户的当前主机配置信息为localhost</p>
<p>这里修改Host为通配符%</p>
<p>1、Host列指定了允许用户登录所使用的IP，比如user&#x3D;root Host&#x3D;192.168.1.1</p>
<p>2、这里的意思就是说root用户只 能通过192.168.1.1的客户端去访问</p>
<p>3、user&#x3D;root Host&#x3D;localhost，表示只能通过本机客户端去访问</p>
<p>4、而 % 是个 通配符 ，如果Host&#x3D;192.168.1.%，那么就表示只要是IP地址前缀为“192.168.1.”的客户端都可以连 接</p>
<p>5、如果 Host&#x3D;% ，表示所有IP都有连接权限</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">#</span><span class="language-bash">修改权限</span><br>update user<br>set host = &#x27;%&#x27;<br>where user =&#x27;root&#x27;;<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">Host修改完成后记得执行flush privileges使配置立即生效：</span><br>flush privileges;<br><br><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">查看权限</span><br>select Host,User from user;<br><br>+-----------+------------------+<br>| host      | user             |<br>+-----------+------------------+<br>| %         | root             |<br>| localhost | mysql.infoschema |<br>| localhost | mysql.session    |<br>| localhost | mysql.sys        |<br>+-----------+------------------+<br>4 rows in set (0.00 sec)<br></code></pre></td></tr></table></figure>





<p>注意：</p>
<p>在生产环境下不能为了省事将host设置为%，这样做会存在安全问题，具体的设置可以根据生产环境的IP进行设置</p>
<p>5、 测试</p>
<p>如果是 MySQL5.7 版本，接下来就可以使用SQLyog或者Navicat成功连接至MySQL了。</p>
<p>如果是 MySQL8 版本，连接时还会出现如下问题：</p>
<hr>
<p><img src="http://img.fgcy.xyz/image-20220704222031972.png" srcset="/img/loading.gif" lazyload alt="image-20220704222031972"></p>
<hr>
<p>问题：配置新连接报错：错误号码 2058，分析是 mysql 密码加密方法变了</p>
<p>解决方法：</p>
<p>1、Linux下 mysql -u root -p 登录你的 mysql 数据库</p>
<p>2、然后 执行这条SQL：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">ALTER USER &#x27;root&#x27;@&#x27;%&#x27; IDENTIFIED WITH mysql_native_password BY &#x27;your_password&#x27;;<br></code></pre></td></tr></table></figure>



<p>3、然后在重新配置SQLyog的连接，则可连接成功了，OK</p>
<h1 id="4-MySQL8的密码强度评估（了解）"><a href="#4-MySQL8的密码强度评估（了解）" class="headerlink" title="4. MySQL8的密码强度评估（了解）"></a>4. MySQL8的密码强度评估（了解）</h1><h2 id="4-1-MySQL不同版本设置密码-可能出现"><a href="#4-1-MySQL不同版本设置密码-可能出现" class="headerlink" title="4.1 MySQL不同版本设置密码(可能出现)"></a>4.1 MySQL不同版本设置密码(可能出现)</h2><p> MySQL5.7中：成功</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs mysql">alter user &#x27;root&#x27; identified by &#x27;root123&#x27;;<br><br>Query OK, 0 rows affected (0.00 sec)<br></code></pre></td></tr></table></figure>



<p>MySQL8.0中：失败</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs mysql">alter user &#x27;root&#x27; identified by &#x27;root123&#x27;;<br><br>ERROR 1819 (HY000): Your password does not satisfy the current policy requirements<br></code></pre></td></tr></table></figure>







<h2 id="4-2-MySQL8之前的安全策略"><a href="#4-2-MySQL8之前的安全策略" class="headerlink" title="4.2 MySQL8之前的安全策略"></a>4.2 MySQL8之前的安全策略</h2><p>在MySQL 8.0之前，MySQL使用的是validate_password插件检测、验证账号密码强度，保障账号的安全 性。</p>
<p>安装&#x2F;启用插件方式1：在参数文件my.cnf中添加参数</p>
<blockquote>
<p>vim &#x2F;etc&#x2F;my.cnf</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs shell">[mysqld]<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">添加如下内容</span><br>plugin-load-add=validate_password.so<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">ON/OFF/FORCE/FORCE_PLUS_PERMANENT: 是否使用该插件(及强制/永久强制使用)</span><br><br>validate-password=FORCE_PLUS_PERMANENT<br></code></pre></td></tr></table></figure>



<p>说明1： plugin library中的validate_password文件名的后缀名根据平台不同有所差异</p>
<p>​				对于Unix和 Unix-like系统而言，它的文件后缀名是.so，对于Windows系统而言，它的文件后缀名是.dll</p>
<p>说明2： 修改参数后<strong>必须重启MySQL服务才能生效</strong></p>
<p>说明3： 参数FORCE_PLUS_PERMANENT是为了防止插件在MySQL运行时的时候被卸载。当你卸载插 件时就会报错。如下所示。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs mysql">-- 查看插件信息<br>SELECT PLUGIN_NAME, PLUGIN_LIBRARY, PLUGIN_STATUS, LOAD_OPTION<br>FROM INFORMATION_SCHEMA.PLUGINS<br>WHERE PLUGIN_NAME = &#x27;validate_password&#x27;;<br> <br>+-------------------+----------------------+---------------+----------------------+<br>| PLUGIN_NAME       | PLUGIN_LIBRARY       | PLUGIN_STATUS | LOAD_OPTION          |<br>+-------------------+----------------------+---------------+----------------------+<br>| validate_password | validate_password.so | ACTIVE        | FORCE_PLUS_PERMANENT |<br>+-------------------+----------------------+---------------+----------------------+<br>1 row in set (0.00 sec)<br><br><br><br>-- 当卸载插件时，会报错<br>UNINSTALL PLUGIN validate_password;<br>ERROR 1702 (HY000): Plugin &#x27;validate_password&#x27; is force_plus_permanent and can not be<br>unloaded<br></code></pre></td></tr></table></figure>





<p>安装&#x2F;启用插件方式2：运行时命令安装（推荐）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs mysql">INSTALL PLUGIN validate_password SONAME &#x27;validate_password.so&#x27;;<br><br><br>Query OK, 0 rows affected, 1 warning (0.11 sec)<br></code></pre></td></tr></table></figure>

<p>此方法也会注册到元数据，也就是mysql.plugin表中，所以不用担心MySQL重启后插件会失效</p>
<h2 id="4-3-MySQL8的安全策略"><a href="#4-3-MySQL8的安全策略" class="headerlink" title="4.3 MySQL8的安全策略"></a>4.3 MySQL8的安全策略</h2><p>MySQL 8.0，引入了服务器组件（Components）这个特性，validate_password插件已用服务器组件重新实现。</p>
<p>8.0.25版本的数据库中，默认自动安装validate_password组件。</p>
<p> 未安装插件前，执行如下两个指令 ，执行效果：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs mysql">show variables like &#x27;validate_password%&#x27;;<br>Empty set (0.04 sec)<br><br><br>SELECT * FROM mysql.component;<br>ERROR 1146 (42S02): Table &#x27;mysql.component&#x27; doesn&#x27;t exist<br></code></pre></td></tr></table></figure>





<p>安装插件后，执行如下两个指令 ，执行效果：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs mysql">SELECT * FROM mysql.component;<br><br>+--------------+--------------------+------------------------------------+<br>| component_id | component_group_id | component_urn                      |<br>+--------------+--------------------+------------------------------------+<br>| 1            | 1                  | file://component_validate_password |<br>+--------------+--------------------+------------------------------------+<br>1 row in set (0.00 sec)<br><br><br><br><br>show variables like &#x27;validate_password%&#x27;;<br><br>+--------------------------------------+--------+<br>| Variable_name                        | Value  |<br>+--------------------------------------+--------+<br>| validate_password.check_user_name    | ON     |<br>| validate_password.dictionary_file    |        |<br>| validate_password.length             | 8      |<br>| validate_password.mixed_case_count   | 1      |<br>| validate_password.number_count       | 1      |<br>| validate_password.policy             | MEDIUM |<br>| validate_password.special_char_count | 1      |<br>+--------------------------------------+--------+<br>7 rows in set (0.01 sec<br></code></pre></td></tr></table></figure>





<p>关于 validate_password 组件对应的系统变量说明：</p>
<hr>
<p><img src="http://img.fgcy.xyz/image-20220704224157306.png" srcset="/img/loading.gif" lazyload alt="image-20220704224157306"></p>
<hr>
<p>提示： </p>
<p>组件和插件的默认值可能有所不同。例如，MySQL 5.7. validate_password_check_user_name的默认 值为OFF</p>
<p><strong>修改安全策略</strong></p>
<p>修改密码验证安全强度</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs mysql">SET GLOBAL validate_password_policy=LOW;<br><br>SET GLOBAL validate_password_policy=MEDIUM;<br><br>SET GLOBAL validate_password_policy=STRONG;<br><br>SET GLOBAL validate_password_policy=0; # For LOW<br><br>SET GLOBAL validate_password_policy=1; # For MEDIUM<br><br>SET GLOBAL validate_password_policy=2; # For HIGH<br><br>#注意，如果是插件的话,SQL为set global validate_password_policy=LOW<br></code></pre></td></tr></table></figure>





<p>此外，还可以修改密码中字符的长度</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">set global validate_password_length=1;<br></code></pre></td></tr></table></figure>





<p><strong>密码强度测试</strong></p>
<p>如果你创建密码是遇到“Your password does not satisfy the current policy requirements”，可以通过函数组 件去检测密码是否满足条件： 0-100</p>
<p>当评估在100时就是说明使用上了最基本的规则：大写+小写+特殊 字符+数字组成的8位以上密码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs mysql">SELECT VALIDATE_PASSWORD_STRENGTH(&#x27;medium&#x27;);<br><br>+--------------------------------------+<br>| VALIDATE_PASSWORD_STRENGTH(&#x27;medium&#x27;) |<br>+--------------------------------------+<br>| 25                                   |<br>+--------------------------------------+<br>1 row in set (0.00 sec)<br><br><br><br><br><br>SELECT VALIDATE_PASSWORD_STRENGTH(&#x27;K354*45jKd5&#x27;);<br>+-------------------------------------------+<br>| VALIDATE_PASSWORD_STRENGTH(&#x27;K354*45jKd5&#x27;) |<br>+-------------------------------------------+<br>|                   100                     |<br>+-------------------------------------------+<br>1 row in set (0.00 sec)<br><br></code></pre></td></tr></table></figure>

<p>注意：</p>
<p>如果没有安装validate_password组件或插件的话，那么这个函数永远都返回0</p>
<p> 关于密码复杂度对 应的密码复杂度策略。如下表格所示：</p>
<hr>
<p><img src="http://img.fgcy.xyz/image-20220704224730865.png" srcset="/img/loading.gif" lazyload alt="image-20220704224730865"></p>
<hr>
<h2 id="4-4-卸载插件、组件-了解"><a href="#4-4-卸载插件、组件-了解" class="headerlink" title="4.4 卸载插件、组件(了解)"></a>4.4 卸载插件、组件(了解)</h2><p>卸载插件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs mysql">UNINSTALL PLUGIN validate_password;<br><br>Query OK, 0 rows affected, 1 warning (0.01 sec)<br></code></pre></td></tr></table></figure>



<p>卸载组件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs mysql">UNINSTALL COMPONENT &#x27;file://component_validate_password&#x27;;<br><br>Query OK, 0 rows affected (0.02 sec)<br></code></pre></td></tr></table></figure>





<h1 id="5-字符集的相关操作"><a href="#5-字符集的相关操作" class="headerlink" title="5. 字符集的相关操作"></a>5. 字符集的相关操作</h1><h2 id="5-1-修改MySQL5-7字符集"><a href="#5-1-修改MySQL5-7字符集" class="headerlink" title="5.1 修改MySQL5.7字符集"></a>5.1 修改MySQL5.7字符集</h2><p><strong>1、修改步骤</strong></p>
<p>在MySQL 8.0版本之前，默认字符集为 latin1 ，utf8字符集指向的是 utf8mb3 </p>
<p>网站开发人员在数据库 设计的时候往往会将编码修改为utf8字符集</p>
<p>如果遗忘修改默认的编码，就会出现乱码的问题</p>
<p>从MySQL 8.0开始，数据库的默认编码将改为 utf8mb4 ，从而避免上述乱码的问题</p>
<p>操作1：查看默认使用的字符集</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs mysql">show variables like &#x27;character%&#x27;;<br><br>+--------------------------+----------------------------+<br>| Variable_name            | Value                      |<br>+--------------------------+----------------------------+<br>| character_set_client     | utf8                       |<br>| character_set_connection | utf8                       |<br>| character_set_database   | latin1                     |<br>| character_set_filesystem | binary                     |<br>| character_set_results    | utf8                       |<br>| character_set_server     | latin1                     |<br>| character_set_system     | utf8                       |<br>| character_sets_dir       | /usr/share/mysql/charsets/ |<br>+--------------------------+----------------------------+<br>8 rows in set (0.01 sec)<br><br><br># 或者<br>show variables like &#x27;%char%&#x27;;<br><br>+--------------------------+----------------------------+<br>| Variable_name            | Value                      |<br>+--------------------------+----------------------------+<br>| character_set_client     | utf8                       |<br>| character_set_connection | utf8                       |<br>| character_set_database   | latin1                     | -- 默认使用该字符集<br>| character_set_filesystem | binary                     |<br>| character_set_results    | utf8                       |<br>| character_set_server     | latin1                     | -- 服务器使用该字符集<br>| character_set_system     | utf8                       |<br>| character_sets_dir       | /usr/share/mysql/charsets/ |<br>+--------------------------+----------------------------+<br>8 rows in set (0.00 sec)<br></code></pre></td></tr></table></figure>

<p>注意：</p>
<p>MySQL 5.7 默认的客户端和服务器都用了 latin1 ，不支持中文，保存中文会报错</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs mysql">-- 使用默认字符集建库<br>CREATE DATABASE dbtest1;<br><br>Query OK, 1 row affected (0.01 sec)<br><br><br><br>-- 切换数据库<br>use dbtest1;<br><br>Database changed<br><br>-- 使用当前数据库的字符集 作为建表的字符集<br>CREATE TABLE emp1(<br>	id INT,<br>    lname varchar(15)<br>);<br><br>Query OK, 0 rows affected (0.01 sec)<br></code></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs mysql">-- 在MySQL5.7中添加中文数据时，报错：<br>INSERT INTO emp1 (id,lname)<br>VALUES(1,&#x27;张三&#x27;);<br><br>ERROR 1366 (HY000): Incorrect string value: &#x27;\xD5\xC5\xC8\xFD&#x27; for column &#x27;lname&#x27; at row 1<br><br><br><br><br>-- 因为默认情况下，创建表使用的是 latin1 。如下：<br><br>-- 查看建库语句<br>SHOW CREATE DATABASE dbtest1;<br><br>+----------+--------------------------------------------------------------------+<br>| Database | Create Database                                                    |<br>+----------+--------------------------------------------------------------------+<br>| dbtest1  | CREATE DATABASE `dbtest1` /*!40100 DEFAULT CHARACTER SET latin1 */ |<br>+----------+--------------------------------------------------------------------+<br>1 row in set (0.01 sec)<br><br><br><br>-- 查看建表语句<br>SHOW CREATE TABLE emp1;<br><br>+-------+----------------------------------------------+<br>| Table |         Create Table                         |                                                                                 |                                              |   <br>+-------+-----------------------------------------------<br>| emp1  | CREATE TABLE `emp1` (                        |<br>  `id` int(11) DEFAULT NULL,<br>  `lname` varchar(15) DEFAULT NULL<br>) ENGINE=InnoDB DEFAULT CHARSET=latin1                 |<br>+-------+----------------------------------------------+<br>1 row in set (0.00 sec)<br></code></pre></td></tr></table></figure>





<p><strong>操作2：修改字符集</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">vim /etc/my.cnf<br></code></pre></td></tr></table></figure>





<p>在文件最后 [mysqld]之后 加上中文字符集配置：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">character_set_server=utf8<br></code></pre></td></tr></table></figure>



<p><strong>操作3：重新启动MySQL服务</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">systemctl restart mysqld<br></code></pre></td></tr></table></figure>



<p>注意：</p>
<p>原库、原表的设定不会发生变化，参数修改只对新建的数据库生效</p>
<p>字符集已经变更</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs mysql">show variables like &#x27;%character%&#x27;;<br>+--------------------------+----------------------------+<br>| Variable_name            | Value                      |<br>+--------------------------+----------------------------+<br>| character_set_client     | gbk                        |<br>| character_set_connection | gbk                        |<br>| character_set_database   | utf8                       |<br>| character_set_filesystem | binary                     |<br>| character_set_results    | gbk                        |<br>| character_set_server     | utf8                       |<br>| character_set_system     | utf8                       |<br>| character_sets_dir       | /usr/share/mysql/charsets/ |<br>+--------------------------+----------------------------+<br>8 rows in set (0.01 sec)<br></code></pre></td></tr></table></figure>







<p><strong>已有库&amp;表字符集的变更</strong></p>
<p>MySQL5.7版本中，以前创建的库，创建的表字符集还是latin1</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs mysql">-- 查看建库语句<br>SHOW CREATE DATABASE dbtest1;<br><br>+----------+--------------------------------------------------------------------+<br>| Database | Create Database                                                    |<br>+----------+--------------------------------------------------------------------+<br>| dbtest1  | CREATE DATABASE `dbtest1` /*!40100 DEFAULT CHARACTER SET latin1 */ |<br>+----------+--------------------------------------------------------------------+<br>1 row in set (0.01 sec)<br><br><br><br>-- 查看建表语句<br>SHOW CREATE TABLE emp1;<br><br>+-------+----------------------------------------------+<br>| Table |         Create Table                         |                                                                                 |                                              |   <br>+-------+-----------------------------------------------<br>| emp1  | CREATE TABLE `emp1` (                        |<br>  `id` int(11) DEFAULT NULL,<br>  `lname` varchar(15) DEFAULT NULL<br>) ENGINE=InnoDB DEFAULT CHARSET=latin1                 |<br>+-------+----------------------------------------------+<br>1 row in set (0.00 sec)<br></code></pre></td></tr></table></figure>





<p>修改已创建数据库的字符集</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs mysql">alter database dbtest1 character set &#x27;utf8&#x27;;<br><br>Query OK, 1 row affected (0.00 sec)<br></code></pre></td></tr></table></figure>







<p>修改已创建数据表的字符集</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs mysql">-- alter table emp1 convert to character set &#x27;utf8&#x27;;<br><br>alter table emp1  character set &#x27;utf8&#x27;;<br><br><br>Query OK, 0 rows affected (0.03 sec)<br>Records: 0  Duplicates: 0  Warnings: 0<br></code></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs mysql">-- 查看建库语句<br>SHOW CREATE DATABASE dbtest1;<br><br>+----------+--------------------------------------------------------------------+<br>| Database | Create Database                                                    |<br>+----------+--------------------------------------------------------------------+<br>| dbtest1  |  CREATE DATABASE `dbtest1` /*!40100 DEFAULT CHARACTER SET utf8 */ |<br>+----------+--------------------------------------------------------------------+<br>1 row in set (0.01 sec)<br><br><br><br>-- 查看建表语句<br>SHOW CREATE TABLE emp1;<br><br>+-------+----------------------------------------------+<br>| Table |         Create Table                         |                                                                                 |                                              |   <br>+-------+-----------------------------------------------<br>| emp1  | CREATE TABLE `emp1` (                        |<br>  `id` int(11) DEFAULT NULL,<br>  `lname` varchar(15) DEFAULT NULL<br>) ENGINE=InnoDB DEFAULT CHARSET=utf8                   |<br>+-------+----------------------------------------------+<br>1 row in set (0.00 sec)<br></code></pre></td></tr></table></figure>





<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs mysql">-- 添加数据<br>INSERT INTO emp1 (id,lname)<br>VALUES(1,&#x27;张三&#x27;);<br><br>Query OK, 1 row affected (0.00 sec)<br><br><br><br><br><br>-- 查看数据<br>SELECT * FROM emp1;<br><br>+------+-------+<br>| id   | lname |<br>+------+-------+<br>|    1 | 张三  |<br>+------+-------+<br>1 row in set (0.00 sec)<br></code></pre></td></tr></table></figure>

<p>注意：</p>
<p>但是原有的数据如果是用非’utf8’编码的话，数据本身编码不会发生改变。已有数据需要导 出或删除，然后重新插入</p>
<h2 id="5-2-各级别的字符集"><a href="#5-2-各级别的字符集" class="headerlink" title="5.2 各级别的字符集"></a>5.2 各级别的字符集</h2><p>MySQL有4个级别的字符集和比较规则，</p>
<p>分别是：</p>
<p>1、服务器级别</p>
<p>2、数据库级别</p>
<p>3、表级别</p>
<p>4、列级别</p>
<p>执行如下SQL语句：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs mysql">show variables like &#x27;character%&#x27;;<br><br>+--------------------------+----------------------------+<br>| Variable_name            | Value                      |<br>+--------------------------+----------------------------+<br>| character_set_client     | gbk                        |<br>| character_set_connection | gbk                        |<br>| character_set_database   | utf8                       |<br>| character_set_filesystem | binary                     |<br>| character_set_results    | gbk                        |<br>| character_set_server     | utf8                       |<br>| character_set_system     | utf8                       |<br>| character_sets_dir       | /usr/share/mysql/charsets/ |<br>+--------------------------+----------------------------+<br>8 rows in set (0.00 sec)<br></code></pre></td></tr></table></figure>



<p>character_set_server：服务器级别的字符集 </p>
<p>character_set_database：当前数据库的字符集</p>
<p> character_set_client：服务器解码请求时使用的字符集</p>
<p> character_set_connection：服务器处理请求时会把请求字符串从</p>
<p>character_set_client转为 character_set_connection </p>
<p>character_set_results：服务器向客户端返回数据时使用的字符集</p>
<ol>
<li>服务器级别</li>
</ol>
<p>character_set_server ：服务器级别的字符集</p>
<p>我们可以在启动服务器程序时通过启动选项或者在服务器程序运行过程中使用 SET 语句修改这两个变量（字符集与比较规则）的值</p>
<p>比如我们可以在配置文件中这样写：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">server]<br>character_set_server=gbk # 默认字符集<br>collation_server=gbk_chinese_ci #对应的默认的比较规则<br></code></pre></td></tr></table></figure>

<p>重启服务</p>
<p>当服务器启动的时候读取这个配置文件后这两个系统变量的值便修改了</p>
<ol start="2">
<li>数据库级别</li>
</ol>
<p> character_set_database ：当前数据库的字符集</p>
<p>我们在创建和修改数据库的时候可以指定该数据库的字符集和比较规则，具体语法如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs mysql">-- 建库时指定字符集<br>CREATE DATABASE 数据库名<br>[[DEFAULT] CHARACTER SET 字符集名称]<br>[[DEFAULT] COLLATE 比较规则名称];<br><br><br>-- 建库后指定修改字符集<br>ALTER DATABASE 数据库名<br>[[DEFAULT] CHARACTER SET 字符集名称]<br>[[DEFAULT] COLLATE 比较规则名称];<br><br></code></pre></td></tr></table></figure>





<ol start="3">
<li>表级别</li>
</ol>
<p>我们也可以在创建和修改表的时候指定表的字符集和比较规则，语法如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs mysql">-- 建表时指定字符集<br>CREATE TABLE 表名 (列的信息)<br>[[DEFAULT] CHARACTER SET 字符集名称]<br>[COLLATE 比较规则名称]]<br><br><br><br><br>-- 建表后指定修改字符集<br>ALTER TABLE 表名<br>[[DEFAULT] CHARACTER SET 字符集名称]<br>[COLLATE 比较规则名称]<br></code></pre></td></tr></table></figure>



<p>注意：</p>
<p>如果创建和修改表的语句中没有指明字符集和比较规则，将使用该表所在数据库的字符集和比较规则作 为该表的字符集和比较规则</p>
<ol start="4">
<li>列级别</li>
</ol>
<p>对于存储字符串的列，同一个表中的不同的列也可以有不同的字符集和比较规则</p>
<p>我们在创建和修改列 定义的时候可以指定该列的字符集和比较规则语法如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs mysql">-- 建表时指定字段的字符集<br>CREATE TABLE 表名(<br>列名 字符串类型 [CHARACTER SET 字符集名称] [COLLATE 比较规则名称],<br>其他列...<br>);<br><br><br><br><br>-- 建表后 指定字段的字符集<br>ALTER TABLE 表名 <br>MODIFY 列名 字符串类型 [CHARACTER SET 字符集名称] [COLLATE 比较规则名称];<br><br></code></pre></td></tr></table></figure>

<p>对于某个列来说，如果在创建和修改的语句中没有指明字符集和比较规则，将使用该列所在表的字符集 和比较规则作为该列的字符集和比较规则</p>
<p>注意：</p>
<p>1、server决定database ，修改配置文件改的时server</p>
<p>2、如果 创建或修改列 时没有显式的指定字符集和比较规则，则该列 默认用表的 字符集和比较规则</p>
<p>3、如果 创建表时 没有显式的指定字符集和比较规则，则该表 默认用数据库的 字符集和比较规则 </p>
<p>4、如果 创建数据库时 没有显式的指定字符集和比较规则，则该数据库 默认用服务器的 字符集和比较规则</p>
<p>提示 </p>
<p>在转换列的字符集时需要注意，如果转换前列中存储的数据不能用转换后的字符集进行表示会发生 错误</p>
<p>比方说原先列使用的字符集是utf8，列中存储了一些汉字，现在把列的字符集转换为ascii的 话就会出错，因为ascii字符集并不能表示汉字字符</p>
<p>知道了这些规则之后，对于给定的表，我们应该知道它的各个列的字符集和比较规则是什么，从而根据 这个列的类型来确定存储数据时每个列的实际数据占用的存储空间大小了。</p>
<p>比方说我们向表 t 中插入一 条记录：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs mysql">INSERT INTO t(col) VALUES(&#x27;我们&#x27;);<br><br>Query OK, 1 row affected (0.00 sec)<br><br><br>SELECT * FROM t;<br><br>+--------+<br>| s      |<br>+--------+<br>| 我们    |<br>+--------+<br>1 row in set (0.00 sec)<br><br></code></pre></td></tr></table></figure>



<p>首先列 col 使用的字符集是 gbk </p>
<p>一个字符 ‘我’ 在 gbk 中的编码为 0xCED2 ，占用两个字节，两个字 符的实际数据就占用4个字节</p>
<p>如果把该列的字符集修改为 utf8 的话，这两个字符就实际占用6个字节</p>
<h2 id="5-3-字符集与比较规则-了解"><a href="#5-3-字符集与比较规则-了解" class="headerlink" title="5.3 字符集与比较规则(了解)"></a>5.3 字符集与比较规则(了解)</h2><p>1、utf8 与 utf8mb4</p>
<p>utf8 字符集表示一个字符需要使用1～4个字节，但是我们常用的一些字符使用1～3个字节就可以表示 了</p>
<p>而字符集表示一个字符所用的最大字节长度，在某些方面会影响系统的存储和性能</p>
<p>所以设计 MySQL的设计者偷偷的定义了两个概念：</p>
<ul>
<li><p>utf8mb3 ：阉割过的 utf8 字符集，只使用1～3个字节表示字符</p>
</li>
<li><p>utf8mb4 ：正宗的 utf8 字符集，使用1～4个字节表示字符</p>
</li>
</ul>
<p>2、比较规则</p>
<p>上表中，MySQL版本一共支持41种字符集，其中的 Default collation 列表示这种字符集中一种默认 的比较规则，里面包含着该比较规则主要作用于哪种语言</p>
<p>比如 utf8_polish_ci 表示以波兰语的规则 比较， utf8_spanish_ci 是以西班牙语的规则比较， utf8_general_ci 是一种通用的比较规则</p>
<p>后缀表示该比较规则是否区分语言中的重音、大小写。具体如下：</p>
<hr>
<p><img src="http://img.fgcy.xyz/image-20220705093632533.png" srcset="/img/loading.gif" lazyload alt="image-20220705093632533"></p>
<hr>
<p>查看字符集：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs mysql"> SHOW CHARSET;<br> <br>+----------+---------------------------------+---------------------+--------+<br>| Charset  | Description                     | Default collation   | Maxlen |<br>+----------+---------------------------------+---------------------+--------+<br>| armscii8 | ARMSCII-8 Armenian              | armscii8_general_ci |      1 |<br>| ascii    | US ASCII                        | ascii_general_ci    |      1 |<br>| big5     | Big5 Traditional Chinese        | big5_chinese_ci     |      2 |<br>| binary   | Binary pseudo charset           | binary              |      1 |<br>| cp1250   | Windows Central European        | cp1250_general_ci   |      1 |<br>| cp1251   | Windows Cyrillic                | cp1251_general_ci   |      1 |<br>| cp1256   | Windows Arabic                  | cp1256_general_ci   |      1 |<br>| cp1257   | Windows Baltic                  | cp1257_general_ci   |      1 |<br>| cp850    | DOS West European               | cp850_general_ci    |      1 |<br>| cp852    | DOS Central European            | cp852_general_ci    |      1 |<br>| cp866    | DOS Russian                     | cp866_general_ci    |      1 |<br>| cp932    | SJIS for Windows Japanese       | cp932_japanese_ci   |      2 |<br>| dec8     | DEC West European               | dec8_swedish_ci     |      1 |<br>| eucjpms  | UJIS for Windows Japanese       | eucjpms_japanese_ci |      3 |<br>| euckr    | EUC-KR Korean                   | euckr_korean_ci     |      2 |<br>| gb18030  | China National Standard GB18030 | gb18030_chinese_ci  |      4 |<br>| gb2312   | GB2312 Simplified Chinese       | gb2312_chinese_ci   |      2 |<br>| gbk      | GBK Simplified Chinese          | gbk_chinese_ci      |      2 |<br>| geostd8  | GEOSTD8 Georgian                | geostd8_general_ci  |      1 |<br>| greek    | ISO 8859-7 Greek                | greek_general_ci    |      1 |<br>| hebrew   | ISO 8859-8 Hebrew               | hebrew_general_ci   |      1 |<br>| hp8      | HP West European                | hp8_english_ci      |      1 |<br>| keybcs2  | DOS Kamenicky Czech-Slovak      | keybcs2_general_ci  |      1 |<br>| koi8r    | KOI8-R Relcom Russian           | koi8r_general_ci    |      1 |<br>| koi8u    | KOI8-U Ukrainian                | koi8u_general_ci    |      1 |<br>| latin1   | cp1252 West European            | latin1_swedish_ci   |      1 |<br>| latin2   | ISO 8859-2 Central European     | latin2_general_ci   |      1 |<br>| latin5   | ISO 8859-9 Turkish              | latin5_turkish_ci   |      1 |<br>| latin7   | ISO 8859-13 Baltic              | latin7_general_ci   |      1 |<br>| macce    | Mac Central European            | macce_general_ci    |      1 |<br>| macroman | Mac West European               | macroman_general_ci |      1 |<br>| sjis     | Shift-JIS Japanese              | sjis_japanese_ci    |      2 |<br>| swe7     | 7bit Swedish                    | swe7_swedish_ci     |      1 |<br>| tis620   | TIS620 Thai                     | tis620_thai_ci      |      1 |<br>| ucs2     | UCS-2 Unicode                   | ucs2_general_ci     |      2 |<br>| ujis     | EUC-JP Japanese                 | ujis_japanese_ci    |      3 |<br>| utf16    | UTF-16 Unicode                  | utf16_general_ci    |      4 |<br>| utf16le  | UTF-16LE Unicode                | utf16le_general_ci  |      4 |<br>| utf32    | UTF-32 Unicode                  | utf32_general_ci    |      4 |<br>| utf8     | UTF-8 Unicode                   | utf8_general_ci     |      3 |<br>| utf8mb4  | UTF-8 Unicode                   | utf8mb4_0900_ai_ci  |      4 |<br>+----------+---------------------------------+---------------------+--------+<br>41 rows in set (0.01 sec)<br><br>-- 或者<br>-- SHOW CHARACTER SET;<br></code></pre></td></tr></table></figure>



<p>Default collation 对应的是该字符集的比较规则 </p>
<p>最后一列 Maxlen ，它代表该种字符集表示一个字符最多需要几个字节</p>
<p>常见的字符集和Maxlen对应关系如下：</p>
<hr>
<p><img src="http://img.fgcy.xyz/image-20220705100940341.png" srcset="/img/loading.gif" lazyload alt="image-20220705100940341"></p>
<hr>
<p>常用操作1：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br></pre></td><td class="code"><pre><code class="hljs mysql">#查看GBK字符集的比较规则<br>SHOW COLLATION LIKE &#x27;gbk%&#x27;;<br><br>+----------------+---------+----+---------+----------+---------+---------------+<br>| Collation      | Charset | Id | Default | Compiled | Sortlen | Pad_attribute |<br>+----------------+---------+----+---------+----------+---------+---------------+<br>| gbk_bin        | gbk     | 87 |         | Yes      |       1 | PAD SPACE     |<br>| gbk_chinese_ci | gbk     | 28 | Yes     | Yes      |       1 | PAD SPACE     |<br>+----------------+---------+----+---------+----------+---------+---------------+<br>2 rows in set (0.00 sec)<br><br><br><br><br><br>#查看UTF-8字符集的比较规则<br>SHOW COLLATION LIKE &#x27;utf8%&#x27;;<br><br>+----------------------------+---------+-----+---------+----------+---------+---------------+<br>| Collation                  | Charset | Id  | Default | Compiled | Sortlen | Pad_attribute |<br>+----------------------------+---------+-----+---------+----------+---------+---------------+<br>| utf8mb4_0900_ai_ci         | utf8mb4 | 255 | Yes     | Yes      |       0 | NO PAD        |<br>| utf8mb4_0900_as_ci         | utf8mb4 | 305 |         | Yes      |       0 | NO PAD        |<br>| utf8mb4_0900_as_cs         | utf8mb4 | 278 |         | Yes      |       0 | NO PAD        |<br>| utf8mb4_0900_bin           | utf8mb4 | 309 |         | Yes      |       1 | NO PAD        |<br>| utf8mb4_bin                | utf8mb4 |  46 |         | Yes      |       1 | PAD SPACE     |<br>| utf8mb4_croatian_ci        | utf8mb4 | 245 |         | Yes      |       8 | PAD SPACE     |<br>| utf8mb4_cs_0900_ai_ci      | utf8mb4 | 266 |         | Yes      |       0 | NO PAD        |<br>| utf8mb4_cs_0900_as_cs      | utf8mb4 | 289 |         | Yes      |       0 | NO PAD        |<br>| utf8mb4_czech_ci           | utf8mb4 | 234 |         | Yes      |       8 | PAD SPACE     |<br>| utf8mb4_danish_ci          | utf8mb4 | 235 |         | Yes      |       8 | PAD SPACE     |<br>| utf8mb4_da_0900_ai_ci      | utf8mb4 | 267 |         | Yes      |       0 | NO PAD        |<br>| utf8mb4_da_0900_as_cs      | utf8mb4 | 290 |         | Yes      |       0 | NO PAD        |<br>| utf8mb4_de_pb_0900_ai_ci   | utf8mb4 | 256 |         | Yes      |       0 | NO PAD        |<br>| utf8mb4_de_pb_0900_as_cs   | utf8mb4 | 279 |         | Yes      |       0 | NO PAD        |<br>| utf8mb4_eo_0900_ai_ci      | utf8mb4 | 273 |         | Yes      |       0 | NO PAD        |<br>| utf8mb4_eo_0900_as_cs      | utf8mb4 | 296 |         | Yes      |       0 | NO PAD        |<br>| utf8mb4_esperanto_ci       | utf8mb4 | 241 |         | Yes      |       8 | PAD SPACE     |<br>| utf8mb4_estonian_ci        | utf8mb4 | 230 |         | Yes      |       8 | PAD SPACE     |<br>| utf8mb4_es_0900_ai_ci      | utf8mb4 | 263 |         | Yes      |       0 | NO PAD        |<br>| utf8mb4_es_0900_as_cs      | utf8mb4 | 286 |         | Yes      |       0 | NO PAD        |<br>| utf8mb4_es_trad_0900_ai_ci | utf8mb4 | 270 |         | Yes      |       0 | NO PAD        |<br>| utf8mb4_es_trad_0900_as_cs | utf8mb4 | 293 |         | Yes      |       0 | NO PAD        |<br>| utf8mb4_et_0900_ai_ci      | utf8mb4 | 262 |         | Yes      |       0 | NO PAD        |<br>| utf8mb4_et_0900_as_cs      | utf8mb4 | 285 |         | Yes      |       0 | NO PAD        |<br>| utf8mb4_general_ci         | utf8mb4 |  45 |         | Yes      |       1 | PAD SPACE     | --  一般用这个<br>| utf8mb4_german2_ci         | utf8mb4 | 244 |         | Yes      |       8 | PAD SPACE     |<br>| utf8mb4_hr_0900_ai_ci      | utf8mb4 | 275 |         | Yes      |       0 | NO PAD        |<br>| utf8mb4_hr_0900_as_cs      | utf8mb4 | 298 |         | Yes      |       0 | NO PAD        |<br>| utf8mb4_hungarian_ci       | utf8mb4 | 242 |         | Yes      |       8 | PAD SPACE     |<br>| utf8mb4_hu_0900_ai_ci      | utf8mb4 | 274 |         | Yes      |       0 | NO PAD        |<br>| utf8mb4_hu_0900_as_cs      | utf8mb4 | 297 |         | Yes      |       0 | NO PAD        |<br>| utf8mb4_icelandic_ci       | utf8mb4 | 225 |         | Yes      |       8 | PAD SPACE     |<br>| utf8mb4_is_0900_ai_ci      | utf8mb4 | 257 |         | Yes      |       0 | NO PAD        |<br>| utf8mb4_is_0900_as_cs      | utf8mb4 | 280 |         | Yes      |       0 | NO PAD        |<br>| utf8mb4_ja_0900_as_cs      | utf8mb4 | 303 |         | Yes      |       0 | NO PAD        |<br>| utf8mb4_ja_0900_as_cs_ks   | utf8mb4 | 304 |         | Yes      |      24 | NO PAD        |<br>| utf8mb4_latvian_ci         | utf8mb4 | 226 |         | Yes      |       8 | PAD SPACE     |<br>| utf8mb4_la_0900_ai_ci      | utf8mb4 | 271 |         | Yes      |       0 | NO PAD        |<br>| utf8mb4_la_0900_as_cs      | utf8mb4 | 294 |         | Yes      |       0 | NO PAD        |<br>| utf8mb4_lithuanian_ci      | utf8mb4 | 236 |         | Yes      |       8 | PAD SPACE     |<br>| utf8mb4_lt_0900_ai_ci      | utf8mb4 | 268 |         | Yes      |       0 | NO PAD        |<br>| utf8mb4_lt_0900_as_cs      | utf8mb4 | 291 |         | Yes      |       0 | NO PAD        |<br>| utf8mb4_lv_0900_ai_ci      | utf8mb4 | 258 |         | Yes      |       0 | NO PAD        |<br>| utf8mb4_lv_0900_as_cs      | utf8mb4 | 281 |         | Yes      |       0 | NO PAD        |<br>| utf8mb4_persian_ci         | utf8mb4 | 240 |         | Yes      |       8 | PAD SPACE     |<br>| utf8mb4_pl_0900_ai_ci      | utf8mb4 | 261 |         | Yes      |       0 | NO PAD        |<br>| utf8mb4_pl_0900_as_cs      | utf8mb4 | 284 |         | Yes      |       0 | NO PAD        |<br>| utf8mb4_polish_ci          | utf8mb4 | 229 |         | Yes      |       8 | PAD SPACE     |<br>| utf8mb4_romanian_ci        | utf8mb4 | 227 |         | Yes      |       8 | PAD SPACE     |<br>| utf8mb4_roman_ci           | utf8mb4 | 239 |         | Yes      |       8 | PAD SPACE     |<br>| utf8mb4_ro_0900_ai_ci      | utf8mb4 | 259 |         | Yes      |       0 | NO PAD        |<br>| utf8mb4_ro_0900_as_cs      | utf8mb4 | 282 |         | Yes      |       0 | NO PAD        |<br>| utf8mb4_ru_0900_ai_ci      | utf8mb4 | 306 |         | Yes      |       0 | NO PAD        |<br>| utf8mb4_ru_0900_as_cs      | utf8mb4 | 307 |         | Yes      |       0 | NO PAD        |<br>| utf8mb4_sinhala_ci         | utf8mb4 | 243 |         | Yes      |       8 | PAD SPACE     |<br>| utf8mb4_sk_0900_ai_ci      | utf8mb4 | 269 |         | Yes      |       0 | NO PAD        |<br>| utf8mb4_sk_0900_as_cs      | utf8mb4 | 292 |         | Yes      |       0 | NO PAD        |<br>| utf8mb4_slovak_ci          | utf8mb4 | 237 |         | Yes      |       8 | PAD SPACE     |<br>| utf8mb4_slovenian_ci       | utf8mb4 | 228 |         | Yes      |       8 | PAD SPACE     |<br>| utf8mb4_sl_0900_ai_ci      | utf8mb4 | 260 |         | Yes      |       0 | NO PAD        |<br>| utf8mb4_sl_0900_as_cs      | utf8mb4 | 283 |         | Yes      |       0 | NO PAD        |<br>| utf8mb4_spanish2_ci        | utf8mb4 | 238 |         | Yes      |       8 | PAD SPACE     |<br>| utf8mb4_spanish_ci         | utf8mb4 | 231 |         | Yes      |       8 | PAD SPACE     |<br>| utf8mb4_sv_0900_ai_ci      | utf8mb4 | 264 |         | Yes      |       0 | NO PAD        |<br>| utf8mb4_sv_0900_as_cs      | utf8mb4 | 287 |         | Yes      |       0 | NO PAD        |<br>| utf8mb4_swedish_ci         | utf8mb4 | 232 |         | Yes      |       8 | PAD SPACE     |<br>| utf8mb4_tr_0900_ai_ci      | utf8mb4 | 265 |         | Yes      |       0 | NO PAD        |<br>| utf8mb4_tr_0900_as_cs      | utf8mb4 | 288 |         | Yes      |       0 | NO PAD        |<br>| utf8mb4_turkish_ci         | utf8mb4 | 233 |         | Yes      |       8 | PAD SPACE     |<br>| utf8mb4_unicode_520_ci     | utf8mb4 | 246 |         | Yes      |       8 | PAD SPACE     |<br>| utf8mb4_unicode_ci         | utf8mb4 | 224 |         | Yes      |       8 | PAD SPACE     |<br>| utf8mb4_vietnamese_ci      | utf8mb4 | 247 |         | Yes      |       8 | PAD SPACE     |<br>| utf8mb4_vi_0900_ai_ci      | utf8mb4 | 277 |         | Yes      |       0 | NO PAD        |<br>| utf8mb4_vi_0900_as_cs      | utf8mb4 | 300 |         | Yes      |       0 | NO PAD        |<br>| utf8mb4_zh_0900_as_cs      | utf8mb4 | 308 |         | Yes      |       0 | NO PAD        |<br>| utf8_bin                   | utf8    |  83 |         | Yes      |       1 | PAD SPACE     |<br>| utf8_croatian_ci           | utf8    | 213 |         | Yes      |       8 | PAD SPACE     |<br>| utf8_czech_ci              | utf8    | 202 |         | Yes      |       8 | PAD SPACE     |<br>| utf8_danish_ci             | utf8    | 203 |         | Yes      |       8 | PAD SPACE     |<br>| utf8_esperanto_ci          | utf8    | 209 |         | Yes      |       8 | PAD SPACE     |<br>| utf8_estonian_ci           | utf8    | 198 |         | Yes      |       8 | PAD SPACE     |<br>| utf8_general_ci            | utf8    |  33 | Yes     | Yes      |       1 | PAD SPACE     |<br>| utf8_general_mysql500_ci   | utf8    | 223 |         | Yes      |       1 | PAD SPACE     |<br>| utf8_german2_ci            | utf8    | 212 |         | Yes      |       8 | PAD SPACE     |<br>| utf8_hungarian_ci          | utf8    | 210 |         | Yes      |       8 | PAD SPACE     |<br>| utf8_icelandic_ci          | utf8    | 193 |         | Yes      |       8 | PAD SPACE     |<br>| utf8_latvian_ci            | utf8    | 194 |         | Yes      |       8 | PAD SPACE     |<br>| utf8_lithuanian_ci         | utf8    | 204 |         | Yes      |       8 | PAD SPACE     |<br>| utf8_persian_ci            | utf8    | 208 |         | Yes      |       8 | PAD SPACE     |<br>| utf8_polish_ci             | utf8    | 197 |         | Yes      |       8 | PAD SPACE     |<br>| utf8_romanian_ci           | utf8    | 195 |         | Yes      |       8 | PAD SPACE     |<br>| utf8_roman_ci              | utf8    | 207 |         | Yes      |       8 | PAD SPACE     |<br>| utf8_sinhala_ci            | utf8    | 211 |         | Yes      |       8 | PAD SPACE     |<br>| utf8_slovak_ci             | utf8    | 205 |         | Yes      |       8 | PAD SPACE     |<br>| utf8_slovenian_ci          | utf8    | 196 |         | Yes      |       8 | PAD SPACE     |<br>| utf8_spanish2_ci           | utf8    | 206 |         | Yes      |       8 | PAD SPACE     |<br>| utf8_spanish_ci            | utf8    | 199 |         | Yes      |       8 | PAD SPACE     |<br>| utf8_swedish_ci            | utf8    | 200 |         | Yes      |       8 | PAD SPACE     |<br>| utf8_tolower_ci            | utf8    |  76 |         | Yes      |       1 | PAD SPACE     |<br>| utf8_turkish_ci            | utf8    | 201 |         | Yes      |       8 | PAD SPACE     |<br>| utf8_unicode_520_ci        | utf8    | 214 |         | Yes      |       8 | PAD SPACE     |<br>| utf8_unicode_ci            | utf8    | 192 |         | Yes      |       8 | PAD SPACE     |<br>| utf8_vietnamese_ci         | utf8    | 215 |         | Yes      |       8 | PAD SPACE     |<br>+----------------------------+---------+-----+---------+----------+---------+---------------+<br>103 rows in set (0.00 sec)<br></code></pre></td></tr></table></figure>



<p>常用操作2：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><code class="hljs mysql">#查看服务器的字符集和比较规则<br>SHOW VARIABLES LIKE &#x27;%_server&#x27;;<br><br>+-------------------------+--------------------+<br>| Variable_name           | Value              |<br>+-------------------------+--------------------+<br>| character_set_server    | utf8mb4            |<br>| collation_server        | utf8mb4_0900_ai_ci |<br>| innodb_dedicated_server | OFF                |<br>+-------------------------+--------------------+<br>3 rows in set, 1 warning (0.01 sec)<br><br><br><br><br>#查看数据库的字符集和比较规则<br>SHOW VARIABLES LIKE &#x27;%_database&#x27;;<br><br>+------------------------+--------------------+<br>| Variable_name          | Value              |<br>+------------------------+--------------------+<br>| character_set_database | utf8mb4            |<br>| collation_database     | utf8mb4_0900_ai_ci |<br>| skip_show_database     | OFF                |<br>+------------------------+--------------------+<br>3 rows in set, 1 warning (0.00 sec)<br><br><br><br><br><br><br><br>#查看具体数据库的字符集<br>SHOW CREATE DATABASE dbtest1;<br><br>+----------+------------------------------------------------------------------+<br>| Database | Create Database                                                  |<br>+----------+------------------------------------------------------------------+<br>| dbtest1  | CREATE DATABASE `dbtest1` /*!40100 DEFAULT CHARACTER SET utf8 */ |<br>+----------+------------------------------------------------------------------+<br>1 row in set (0.01 sec)<br><br><br><br><br><br>#修改具体数据库的字符集、比较规则<br>ALTER DATABASE dbtest1 CHARACTER SET &#x27;utf8&#x27; COLLATE &#x27;utf8_general_ci&#x27;;<br><br>Query OK, 1 row affected (0.00 sec)<br><br><br>#查看具体数据库的字符集<br>SHOW CREATE DATABASE dbtest1;<br><br>+----------+------------------------------------------------------------------+<br>| Database | Create Database                                                  |<br>+----------+------------------------------------------------------------------+<br>| dbtest1  | CREATE DATABASE `dbtest1` /*!40100 DEFAULT CHARACTER SET utf8 */ |<br>+----------+------------------------------------------------------------------+<br>1 row in set (0.00 sec)<br></code></pre></td></tr></table></figure>



<p>说明一：</p>
<p>utf8_unicode_ci和utf8_general_ci对中、英文来说没有实质的差别</p>
<p>utf8_general_ci 校对速度快,但准确度稍差</p>
<p>utf8_unicode_ci准确度高,但校对速度稍慢</p>
<p>一般情况,用utf8_general_ci就够了,但如果你的应用有德语、法语或者俄语,请一定使用utf8_unicode_ci</p>
<p>说明二：</p>
<p>修改了数据库的默认字符集和比较规则后,原来已经创建的表格的字符集和比较规则并不会改变,如果需要,那么需单独修改</p>
<p>常用操作3：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs mysql">#查看表的字符集<br>show create table emp1;<br><br>+-------+-----------------------------------------+<br>| Table | Create Table                            |                                                                             +-------+-----------------------------------------+<br>| emp1  | CREATE TABLE `emp1` (                   |<br>  `id` int(11) DEFAULT NULL,<br>  `lname` varchar(15) DEFAULT NULL<br>) ENGINE=InnoDB DEFAULT CHARSET=utf8              |<br>+-------+-----------------------------------------+<br>1 row in set (0.03 sec)<br><br><br><br><br><br><br>#查看表的比较规则<br>show table status from dbtest1 like &#x27;emp1&#x27;;<br><br><br><br>#修改表的字符集和比较规则<br>ALTER TABLE emp1  CHARACTER SET &#x27;utf8&#x27; COLLATE &#x27;utf8_general_ci&#x27;;<br></code></pre></td></tr></table></figure>





<h2 id="5-4-请求到响应过程中字符集的变化"><a href="#5-4-请求到响应过程中字符集的变化" class="headerlink" title="5.4 请求到响应过程中字符集的变化"></a>5.4 请求到响应过程中字符集的变化</h2><hr>
<p><img src="http://img.fgcy.xyz/image-20220705094245485.png" srcset="/img/loading.gif" lazyload alt="image-20220705094245485"></p>
<hr>
<hr>
<p><img src="http://img.fgcy.xyz/image-20220705102828512.png" srcset="/img/loading.gif" lazyload alt="image-20220705102828512"></p>
<hr>
<p>为了体现出字符集在请求处理过程中的变化，我们这里特意修改一个系统变量的值：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs mysql">set character_set_connection = gbk;<br><br>Query OK, 0 rows affected (0.00 sec)<br></code></pre></td></tr></table></figure>





<p>现在假设我们客户端发送的请求是下边这个字符串：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs mysql">SELECT * FROM t <br>	WHERE s = &#x27;我&#x27;;<br></code></pre></td></tr></table></figure>



<p>为了方便理解这个过程，我们只分析字符 ‘我’ 在这个过程中字符集的转换</p>
<p>现在看一下在请求从发送到结果返回过程中字符集的变化：</p>
<p>1、 客户端发送请求所使用的字符集 一般情况下客户端所使用的字符集和当前操作系统一致，不同操作系统使用的字符集可能不一 样</p>
<p>如下：</p>
<p>类 Unix 系统使用的是 utf8</p>
<p> Windows 使用的是 gbk </p>
<p>当客户端使用的是 utf8 字符集，字符 ‘我’ 在发送给服务器的请求中的字节形式就是： <code>0xE68891</code></p>
<p>提示 :</p>
<p>如果你使用的是可视化工具，比如navicat之类的，这些工具可能会使用自定义的字符集来编 码发送到服务器的字符串</p>
<p>而不采用操作系统默认的字符集（所以在学习的时候还是尽量用 命令行窗口）</p>
<p>2、服务器接收到客户端发送来的请求其实是一串二进制的字节，它会认为这串字节采用的字符集是 character_set_client ，然后把这串字节转换为 character_set_connection 字符集编码的 字符</p>
<p>由于我的计算机上 character_set_client 的值是 utf8 ，首先会按照 utf8 字符集对字节串 0xE68891 进行解码，得到的字符串就是 ‘我’ ，然后按照 character_set_connection 代表的 字符集，也就是 gbk 进行编码，得到的结果就是字节串   <code>0xCED2</code></p>
<p>3、因为表 t 的列 col 采用的是 gbk 字符集，与 character_set_connection 一致，所以直接到列 中找字节值为 0xCED2 的记录，最后找到了一条记录</p>
<p>提示 ：</p>
<p>如果某个列使用的字符集和character_set_connection代表的字符集不一致的话，还需要进行 一次字符集转换</p>
<p>4、上一步骤找到的记录中的 col 列其实是一个字节串 0xCED2 ， col 列是采用 gbk 进行编码的，所 以首先会将这个字节串使用 gbk 进行解码，得到字符串 ‘我’ ，然后再把这个字符串使用 character_set_results 代表的字符集，也就是 utf8 进行编码，得到了新的字节串： 0xE68891 ，然后发送给客户端</p>
<p>5、由于客户端是用的字符集是 utf8 ，所以可以顺利的将 0xE68891 解释成字符 我 ，从而显示到我 们的显示器上，所以我们人类也读懂了返回的结果</p>
<p>总结图示如下：</p>
<hr>
<p><img src="http://img.fgcy.xyz/image-20220705110941243.png" srcset="/img/loading.gif" lazyload alt="image-20220705110941243"></p>
<hr>
<p>从这个分析中我们可以得出这么几点需要注意的地方:</p>
<ul>
<li><p>服务器认为客户端发送过来的请求是用character_set_client编码的。假设你的客户端采用的字符集和character_set_client不一样的话,这就会出现识别不准确的情况</p>
<p>比如我的客户端使用的是utf8字符集,如果把系统变量character_set_client的值设置为ascii的话,服务器可能无法理解我们发送的请求,更别谈处理这个请求了</p>
</li>
<li><p>服务器将把得到的结果集使用character_set_results编码后发送给客户端。假设你的客户端采用的字符集和 aharacter_set_results不一样的话,这就可能会出现客户端无法解码结果集的情况,结果就是在你的屏幕上出现乱码</p>
<p>比如我的客户端使用的是utf8字符集,如果把系统变量character_set_results 的值设置为ascii的话,可能会产生乱码</p>
</li>
<li><p>character_set_connection 只是服务器在将请求的字节串从character_set_client转换为character_set_connection 时使用</p>
<p>一定要注意,该字符集包含的字符范围一定涵盖请求中的字符,要不然会导致有的字符无法使用character_set_connection代表的字符集进行编码</p>
</li>
</ul>
<p>经验:</p>
<p>开发中通常把<code>character_set_client</code>、<code>character_set_connection</code>,<code> character_set_results</code>这三个系统变量设置成和客户端使用的字符集一致的情况,这样减少了很多无谓的字符集转换。</p>
<p>为了方便我们设置, MySQL提供了一条非常简便的语句:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">SET NAMES 字符集名;<br></code></pre></td></tr></table></figure>



<p>这一条语句产生的效果和我们执行这3条的效果是一样的:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs mysql">SET character_set_client = 字符集名;<br>SET character_set_connection = 字符集名;<br>SET character_set_results = 字符集名;<br></code></pre></td></tr></table></figure>



<p>比方说我的客户端使用的是utf8字符集,所以需要把这几个系统变量的值都设置为utf8:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">SET NAMES utf8;<br></code></pre></td></tr></table></figure>



<p>另外,如果你想在启动客户端的时候就把character_set_client、character_set_connection、character_set_results这三个系统变量的值设置成一样的</p>
<p>那我们可以在启动客户端的时候指定一个叫default-character-set的启动选项,比如在配置文件里可以这么写:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">[client]<br>default-character-set=utf8<br></code></pre></td></tr></table></figure>



<p>它起到的效果和执行一遍SET NAMES utf8是一样一样的,都会将那三个系统变量的值设置成utf8</p>
<h1 id="6-SQL大小写规范"><a href="#6-SQL大小写规范" class="headerlink" title="6. SQL大小写规范"></a>6. SQL大小写规范</h1><h2 id="6-1-Windows和Linux平台区别"><a href="#6-1-Windows和Linux平台区别" class="headerlink" title="6.1 Windows和Linux平台区别"></a>6.1 Windows和Linux平台区别</h2><p> 在 SQL 中，关键字和函数名是不用区分字母大小写的</p>
<p>比如 SELECT、WHERE、ORDER、GROUP BY 等关 键字，以及 ABS、MOD、ROUND、MAX 等函数名</p>
<p>不过在 SQL 中，你还是要确定大小写的规范，因为在 Linux 和 Windows 环境下，你可能会遇到不同的大 小写问题。</p>
<p>windows系统默认大小写不敏感 </p>
<p>但是 linux系统是大小写敏感的 </p>
<p> 通过如下命令查看：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs mysql">SHOW VARIABLES LIKE &#x27;%lower_case_table_names%&#x27;;<br><br><br>-- Linux<br>+------------------------+-------+<br>| Variable_name          | Value |<br>+------------------------+-------+<br>| lower_case_table_names | 0     |<br>+------------------------+-------+<br>1 row in set (0.03 sec)<br><br><br>-- window<br>+------------------------+-------+<br>| Variable_name          | Value |<br>+------------------------+-------+<br>| lower_case_table_names | 1     |<br>+------------------------+-------+<br>1 row in set, 1 warning (0.00 sec)<br></code></pre></td></tr></table></figure>





<p>lower_case_table_names参数值的设置： </p>
<p>默认为0，大小写 <code>敏感</code> 。</p>
<p>设置1，大小写<strong>不敏感</strong>。创建的表，数据库都是以<strong>小写形式存放在磁盘上</strong>，对于sql语句都是转 <strong>换为小写对表和数据库进行查找</strong>。</p>
<p>设置2，创建的表和数据库依据语句上格式存放（怎么创的，怎么存），<strong>凡是查找都是转换为小写进行</strong>。</p>
<p> 两个平台上SQL大小写的区别具体来说：</p>
<p>MySQL在Linux下数据库名、表名、列名、别名大小写<strong>规则</strong>是这样的： </p>
<p>1、<strong>数据库名</strong>、<strong>表名</strong>、<strong>表的别名</strong>、变量名是<strong>严格区分大小写的</strong>；</p>
<p> 2、<code>关键字</code>、 <code>函数名称</code> 在 SQL 中<strong>不区分大小写</strong>；</p>
<p> 3、<strong>列名</strong>（或字段名）与<strong>列的别名</strong>（或字段别名）<strong>在所有的情况下均是忽略大小写</strong>的；</p>
<p>MySQL在Windows的环境下全部不区分大小写</p>
<h2 id="6-2-Linux下大小写规则设置"><a href="#6-2-Linux下大小写规则设置" class="headerlink" title="6.2 Linux下大小写规则设置"></a>6.2 Linux下大小写规则设置</h2><p>当想设置为大小写不敏感时，要在 my.cnf 这个配置文件 [mysqld] 中加入 lower_case_table_names&#x3D;1 ，然后重启服务器。</p>
<p>但是要在重启数据库实例之前就需要将原来的数据库和表转换为小写，否则将找不到数据库名</p>
<blockquote>
<p>  SHOW VARIABLES LIKE ‘%lower_case_table_names%’        此参数适用于MySQL5.7</p>
</blockquote>
<p>在MySQL 8下  禁止  在重新启动 MySQL 服务时将 lower_case_table_names 设置成不同于初始化 MySQL 服务时设置的 lower_case_table_names 值。如果非要将MySQL8设置为大小写不敏感，具体步骤为：</p>
<p>1、停止MySQL服务 </p>
<p>2、删除数据目录，即删除 &#x2F;var&#x2F;lib&#x2F;mysql 目录 （删除数据库文件）</p>
<p>3、在MySQL配置文件（ &#x2F;etc&#x2F;my.cnf ）中添加 lower_case_table_names&#x3D;1 </p>
<p>4、启动MySQL服务</p>
<h2 id="6-3-SQL编写建议"><a href="#6-3-SQL编写建议" class="headerlink" title="6.3 SQL编写建议"></a>6.3 SQL编写建议</h2><p>如果你的变量名命名规范没有统一，就可能产生错误。</p>
<p>这里有一个有关命名规范的建议：</p>
<p>1、<strong>关键字</strong>和<strong>函数名称</strong>全部大写； <strong>（关键字、函数名不区分大小写）</strong></p>
<p>2、 数据库名、表名、表别名、字段名、字段别名等全部小写； <strong>（字段名、字段别名在任何情况下都不区分大小写）</strong></p>
<p>3.、SQL 语句必须以分号结尾。</p>
<p>数据库名、表名和字段名在 Linux MySQL 环境下是区分大小写的，因此建议你统一这些字段的命名规 则，比如全部采用小写的方式</p>
<p>虽然关键字和函数名称在 SQL 中不区分大小写，也就是如果小写的话同样可以执行</p>
<p>但是同时将关键词 和函数名称全部大写，以便于区分数据库名、表名、字段名</p>
<h1 id="7-sql-mode的合理设置"><a href="#7-sql-mode的合理设置" class="headerlink" title="7. sql_mode的合理设置"></a>7. sql_mode的合理设置</h1><h2 id="7-1-宽松模式-vs-严格模式"><a href="#7-1-宽松模式-vs-严格模式" class="headerlink" title="7.1 宽松模式 vs 严格模式"></a>7.1 宽松模式 vs 严格模式</h2><p>宽松模式： </p>
<p>如果设置的是宽松模式，那么我们在插入数据的时候，即便是给了一个错误的数据，也可能会被接受， 并且不报错</p>
<p>举例 ：</p>
<p>我在创建一个表时，该表中有一个字段为name，给name设置的字段类型时 char(10) ，如果我 在插入数据的时候，其中name这个字段对应的有一条数据的 长度超过了10 ，例如’1234567890abc’，超 过了设定的字段长度10，那么不会报错，并且取前10个字符存上，也就是说你这个数据被存为 了’1234567890’，而’abc’就没有了。但是，我们给的这条数据是错误的，因为超过了字段长度，但是并没 有报错，并且mysql自行处理并接受了，这就是宽松模式的效果。 </p>
<p>应用场景 ：</p>
<p>通过设置sql mode为宽松模式，来保证大多数sql符合标准的sql语法，这样应用在不同数据 库之间进行 迁移 时，则不需要对业务sql 进行较大的修改</p>
<hr>
<p> 严格模式：</p>
<p>出现上面宽松模式的错误，应该报错才对，所以MySQL5.7版本就将sql_mode默认值改为了严格模式</p>
<p>所 以在 生产等环境 中，我们必须采用的是严格模式，进而 开发、测试环境 的数据库也必须要设置，这样在 开发测试阶段就可以发现问题。并且我们即便是用的MySQL5.6，也应该自行将其改为严格模式。</p>
<p>开发经验 ：</p>
<p>MySQL等数据库总想把关于数据的所有操作都自己包揽下来，包括数据的校验，其实开发 中，我们应该在自己 开发的项目程序级别将这些校验给做了 ，虽然写项目的时候麻烦了一些步骤，但是这 样做之后，我们在进行数据库迁移或者在项目的迁移时，就会方便很多。</p>
<p>改为严格模式后可能会存在的问题：</p>
<p>若设置模式中包含了 NO_ZERO_DATE ，那么MySQL数据库不允许插入零日期，插入零日期会抛出错误而 不是警告。</p>
<p>例如，表中含字段TIMESTAMP列（如果未声明为NULL或显示DEFAULT子句）将自动分配 DEFAULT ‘0000-00-00 00:00:00’（零时间戳），这显然是不满足sql_mode中的NO_ZERO_DATE而报错。</p>
<h2 id="7-2-模式查看"><a href="#7-2-模式查看" class="headerlink" title="7.2 模式查看"></a>7.2 模式查看</h2><p><strong>查看当前的sql_mode</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs mysql">-- 当前会话范围<br>select @@session.sql_mode;<br><br>-- 全局范围 （重启服务器后可能失效）<br>select @@global.sql_mode;<br> <br>#或者<br>show variables like &#x27;sql_mode&#x27;;<br></code></pre></td></tr></table></figure>



<hr>
<p><img src="http://img.fgcy.xyz/image-20220705142444026.png" srcset="/img/loading.gif" lazyload alt="image-20220705142444026"></p>
<hr>
<h2 id="7-3-宽松模式的举例"><a href="#7-3-宽松模式的举例" class="headerlink" title="7.3 宽松模式的举例"></a>7.3 宽松模式的举例</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><code class="hljs mysql">-- 切换数据库<br>USE dbtest1;<br><br>Database changed<br><br><br><br>-- 建表<br>CREATE TABLE mytb12(<br>	id INT ,<br>    name VARCHAR(16),<br>    age INT,<br>    dept INT<br>);<br><br>Query OK, 0 rows affected (0.02 sec)<br><br><br><br><br>-- 添加数据<br>INSERT INTO mytb12 VALUES<br>(1,&#x27;ZHANG3&#x27;,33,101),<br>(2,&#x27;LI4&#x27;,34,101),<br>(3,&#x27;WANG5&#x27;,34,102),<br>(4,&#x27;ZHAO6&#x27;,34,102),<br>(5,&#x27;TIAN7&#x27;,36,102);<br><br>Query OK, 5 rows affected (0.00 sec)<br>Records: 5  Duplicates: 0  Warnings: 0<br><br><br><br><br><br>-- 查看每个部门年龄最大的人（错误写法）<br>SELECT max(age),dept,name<br>FROM mytb12<br>GROUP BY dept;<br><br>ERROR 1055 (42000): Expression #3 of SELECT list is not in GROUP BY clause and contains nonaggregated column &#x27;dbtest1.mytb12.name&#x27; which is not functionally dependent on columns in GROUP BY clause; this is incompatible with sql_mode=only_full_group_by<br><br><br><br><br><br>-- 设置sql_mode 宽松模式<br>SET SESSION sql_mode=&#x27;&#x27;;<br><br>Query OK, 0 rows affected, 1 warning (0.00 sec)<br><br><br><br><br><br><br><br>-- 查看每个部门年龄最大的人错误写法）<br>SELECT max(age),dept,name<br>FROM mytb12<br>GROUP BY dept;<br><br>+----------+------+--------+<br>| max(age) | dept | name   |<br>+----------+------+--------+<br>|       34 |  101 | ZHANG3 |<br>|       36 |  102 | WANG5  |<br>+----------+------+--------+<br>2 rows in set (0.00 sec)<br><br><br><br><br><br><br><br>-- 添加类型不正确的数据<br>INSERT INTO mytb12 (id,name,age)<br>VALUES(6,&#x27;Tom&#x27;,&#x27;aaa&#x27;);<br><br>Query OK, 1 row affected, 1 warning (0.00 sec)<br><br><br><br><br><br>-- 查看数据<br>SELECT * FROM mytb12;<br><br>+------+--------+------+------+<br>| id   | name   | age  | dept |<br>+------+--------+------+------+<br>|    1 | ZHANG3 |   33 |  101 |<br>|    2 | LI4    |   34 |  101 |<br>|    3 | WANG5  |   34 |  102 |<br>|    4 | ZHAO6  |   34 |  102 |<br>|    5 | TIAN7  |   36 |  102 |<br>|    6 | Tom    |    0 | NULL |   -- int类型的age 插入字符串<br>+------+--------+------+------+<br>6 rows in set (0.00 sec)<br></code></pre></td></tr></table></figure>



<h2 id="7-4-模式的设置"><a href="#7-4-模式的设置" class="headerlink" title="7.4 模式的设置"></a>7.4 模式的设置</h2><p>1、<strong>临时设置方式：设置当前窗口中设置sql_mode</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs mysql">SET GLOBAL sql_mode = &#x27;modes...&#x27;; #全局<br>SET SESSION sql_mode = &#x27;modes...&#x27;; #当前会话<br></code></pre></td></tr></table></figure>





<p>举例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs mysql">#改为严格模式。此方法只在当前会话中生效，关闭当前会话就不生效了。<br>set SESSION sql_mode=&#x27;STRICT_TRANS_TABLES&#x27;;<br><br><br>#改为严格模式。此方法在当前服务中生效，重启MySQL服务后失效。<br>set GLOBAL sql_mode=&#x27;STRICT_TRANS_TABLES&#x27;;<br></code></pre></td></tr></table></figure>





<p>2、<strong>永久设置方式：在&#x2F;etc&#x2F;my.cnf中配置sql_mode</strong></p>
<p>在my.cnf文件(windows系统是my.ini文件)，新增：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">[mysqld]<br>sql_mode=ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR<br>_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION<br></code></pre></td></tr></table></figure>

<p>然后 重启MySQL </p>
<p>当然生产环境上是禁止重启MySQL服务的，所以采用 临时设置方式 + 永久设置方式 来解决线上的问题， 那么即便是有一天真的重启了MySQL服务，也会永久生效了。</p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/%E8%A7%86%E9%A2%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" class="category-chain-item">视频学习笔记</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/%E5%B0%9A%E7%A1%85%E8%B0%B7-%E5%AE%8B%E7%BA%A2%E5%BA%B7-MySQL-%E9%AB%98%E7%BA%A7/">#尚硅谷-宋红康-MySQL(高级)</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>第01章-Linux下MySQL的安装与使用-atguigu-shk</div>
      <div>http://example.com/2023/03/30/MySQL-宋红康-高级-第01章-Linux下MySQL的安装与使用/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>Author</div>
          <div>John Doe</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>Posted on</div>
          <div>March 30, 2023</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>Licensed under</div>
          <div>
            
              
              
                <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - Attribution">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2023/03/30/MySQL-%E5%AE%8B%E7%BA%A2%E5%BA%B7-%E9%AB%98%E7%BA%A7-%E7%AC%AC0%E7%AB%A0%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%85%8B%E9%9A%86/" title="第0章虚拟机克隆-atguigu-shk">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">第0章虚拟机克隆-atguigu-shk</span>
                        <span class="visible-mobile">Previous</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2023/03/30/MySQL-%E5%AE%8B%E7%BA%A2%E5%BA%B7-%E9%AB%98%E7%BA%A7-%E7%AC%AC02%E7%AB%A0-MySQL%E7%9A%84%E6%95%B0%E6%8D%AE%E7%9B%AE%E5%BD%95/" title="第02章-MySQL的数据目录-atguigu-shk">
                        <span class="hidden-mobile">第02章-MySQL的数据目录-atguigu-shk</span>
                        <span class="visible-mobile">Next</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  
  
    <article id="comments" lazyload>
      
  <div id="waline"></div>
  <script type="text/javascript">
    Fluid.utils.loadComments('#waline', function() {
      Fluid.utils.createCssLink('https://lib.baomitu.com/waline/2.14.1/waline.min.css')
      Fluid.utils.createScript('https://lib.baomitu.com/waline/2.14.1/waline.min.js', function() {
        var options = Object.assign(
          {"serverURL":"https://oze0hj3a.api.lncldglobal.com","path":"window.location.pathname","meta":["nick","mail","link"],"requiredMeta":["nick"],"lang":"zh-CN","emoji":["https://cdn.jsdelivr.net/gh/walinejs/emojis/weibo"],"dark":"html[data-user-color-scheme=\"dark\"]","wordLimit":0,"pageSize":10},
          {
            el: '#waline',
            path: window.location.pathname
          }
        )
        Waline.init(options);
        Fluid.utils.waitElementVisible('#waline .vcontent', () => {
          var imgSelector = '#waline .vcontent img:not(.vemoji)';
          Fluid.plugins.imageCaption(imgSelector);
          Fluid.plugins.fancyBox(imgSelector);
        })
      });
    });
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


    </article>
  


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>Table of Contents</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">Keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>WAITING</span></a> 
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="busuanzi_container_site_pv" style="display: none">
        总访问量 
        <span id="busuanzi_value_site_pv"></span>
         次
      </span>
    
    
      <span id="busuanzi_container_site_uv" style="display: none">
        总访客数 
        <span id="busuanzi_value_site_uv"></span>
         人
      </span>
    
    
  
</div>

  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>

  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">Blog works best with JavaScript enabled</div>
  </noscript>
</body>
</html>
