

<!DOCTYPE html>
<html lang="en" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="John Doe">
  <meta name="keywords" content="">
  
    <meta name="description" content="一、框架概述1.软件开发常用结构1.1.三层架构什么是三层架构  在项目开发中,遵循的一种形式模式.分为三层.  界面层（User Interface layer）、业务逻辑层（Business Logic Layer）、数据访问层（Data access layer)      1)界面层表示层，视图层):用来接收客 户端的输入,调用业务逻辑层进行功能处理,返回结果给客户端.过去的servlet">
<meta property="og:type" content="article">
<meta property="og:title" content="Mybatis-dongli">
<meta property="og:url" content="http://example.com/2023/03/30/%E5%8A%A8%E5%8A%9B-Mybatis/index.html">
<meta property="og:site_name" content="FGCY-BLOG">
<meta property="og:description" content="一、框架概述1.软件开发常用结构1.1.三层架构什么是三层架构  在项目开发中,遵循的一种形式模式.分为三层.  界面层（User Interface layer）、业务逻辑层（Business Logic Layer）、数据访问层（Data access layer)      1)界面层表示层，视图层):用来接收客 户端的输入,调用业务逻辑层进行功能处理,返回结果给客户端.过去的servlet">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/images/mybatis.png">
<meta property="article:published_time" content="2023-03-30T12:13:34.000Z">
<meta property="article:modified_time" content="2023-03-30T13:29:48.456Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="Mybatis-DongLi">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://example.com/images/mybatis.png">
  
  
    <meta name="referrer" content="no-referrer-when-downgrade">
  
  
  <title>Mybatis-dongli - FGCY-BLOG</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.4","typing":{"enable":true,"typeSpeed":333,"cursorChar":"%","loop":true,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>FGCY-BLOG</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                <span>主页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签列表</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                <span>关于我</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/playlist/">
                <i class="iconfont icon-music"></i>
                <span>音乐</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="Mybatis-dongli"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2023-03-30 20:13" pubdate>
          March 30, 2023 pm
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    

    

    
    
      
        <span id="busuanzi_container_page_pv" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="busuanzi_value_page_pv"></span> views
        </span>
        
      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">Mybatis-dongli</h1>
            
            
              <div class="markdown-body">
                
                <h1 id="一、框架概述"><a href="#一、框架概述" class="headerlink" title="一、框架概述"></a>一、框架概述</h1><h2 id="1-软件开发常用结构"><a href="#1-软件开发常用结构" class="headerlink" title="1.软件开发常用结构"></a>1.软件开发常用结构</h2><h3 id="1-1-三层架构"><a href="#1-1-三层架构" class="headerlink" title="1.1.三层架构"></a>1.1.三层架构</h3><p>什么是三层架构<br>  在项目开发中,遵循的一种形式模式.分为三层.<br>  界面层（User Interface layer）、业务逻辑层（Business Logic Layer）、数据访问层（Data access layer)<br>      1)界面层表示层，视图层):用来接收客 户端的输入,调用业务逻辑层进行功能处理,返回结果给客户端.过去的servlet就是界面层的功能.<br>      2)业务逻辑层:用来进行整个项目的业务逻辑处理,向上为界面层提供处理结果,向下问数据访问层要数据.<br>      3)数据访问层:专门用来进行数据库的增删改查操作,向上为业务逻辑层提供数据.</p>
<ul>
<li><strong>三层的处理请求的交互：</strong></li>
</ul>
<figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs clean">客户端&lt;---&gt;界面层&lt;---&gt;业务逻辑层&lt;---&gt;数据访问层&lt;---&gt;数据库。<br></code></pre></td></tr></table></figure>

<p>  各层之间的调用顺序是固定的,不允许跨层访问</p>
<span id="more"></span>

<hr>
<p><img src="https://cdn.jsdelivr.net/gh/fgcy-333/gitnote-images/2022/8/27202208261726037.png" srcset="/img/loading.gif" lazyload></p>
<hr>
<ul>
<li><strong>为什么要使用三层？</strong></li>
</ul>
<p>1.结构清晰、耦合度低,  各层分工明确<br>2.可维护性高，可扩展性高<br>3.有利于标准化<br>4.开发人员可以只关注整个结构中的其中某一层的功能实现<br>5.有利于各层逻辑的复用</p>
<h3 id="1-2常用框架"><a href="#1-2常用框架" class="headerlink" title="1.2常用框架"></a>1.2常用框架</h3><ul>
<li><strong>MyBatis 框架</strong></li>
</ul>
<p>1、MyBatis 是一个优秀的基于 java 的持久层框架，内部封装了 jdbc，开发者只需要关注 sql 语句本身，而不需要处理加载驱动、创建连接、创建 statement、关闭连接，资源等繁杂的过程。</p>
<p>2、MyBatis 通过 xml 或注解两种方式将要执行的各种 sql 语句配置起来，并通过 java 对象和 sql 的动态参数进行映射生成最终执行的 sql 语句，最后由 mybatis 框架执行 sql 并将结果映射为 java 对象并返回</p>
<ul>
<li><strong>Spring 框架</strong></li>
</ul>
<p>1、Spring 框架为了解决软件开发的复杂性而创建的。<br>2、Spring 使用的是基本的 JavaBean 来完成以前非常复杂的企业级开发。<br>3、Spring 解决了业务对象，功能模块之间的耦合，不仅在 javase,web 中使用， 大部分 Java 应用都可以从 Spring 中受益。<br>4、Spring 是一个轻量级控制反转(IoC)和面向切面(AOP)的容器</p>
<ul>
<li><strong>SpringMVC 框架</strong></li>
</ul>
<p>Spring MVC 属于 SpringFrameWork 3.0 版本加入的一个模块，为 Spring 框架提供了构建 Web 应用程序的能力<br>现在可以用Spring 框架提供的 SpringMVC 模块实现 web 应用开发，在 web 项目中可以无缝使用 Spring 和 Spring MVC 框架</p>
<ul>
<li><strong>SSM</strong></li>
</ul>
<p> 1、 Spring:它是整合其它框架的框架.它的核心是IOC和AOP.它由20多个模块构成.在很多领域都提供了很好的解决方案.是一个大佬级别的存在.<br>  2、SpringMVC:它是Spring家族的一员.专门用来优化控制器(Servlet)的.提供了极简单 数据提交, 数据携带, 页面跳转 等功能.<br>  3、MyBatis:是持久化层的一个框架.用来进行数据库访问的优化.专注于sql语句.极大的简化了JDBC的访问</p>
<ul>
<li><strong>什么是框架</strong></li>
</ul>
<p>它是一个半成品软件.将所有的公共的,重复的功能解决掉,帮助程序快速高效的进行开发.它是可复用,可扩展的.</p>
<h2 id="2-JDBC编程"><a href="#2-JDBC编程" class="headerlink" title="2. JDBC编程"></a>2. JDBC编程</h2><h3 id="2-1JDBC编程回顾"><a href="#2-1JDBC编程回顾" class="headerlink" title="2.1JDBC编程回顾"></a>2.1JDBC编程回顾</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">findStudent</span><span class="hljs-params">()</span> &#123;<br><span class="hljs-type">Connection</span> <span class="hljs-variable">conn</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>; <br><span class="hljs-type">Statement</span> <span class="hljs-variable">stmt</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br><span class="hljs-type">ResultSet</span> <span class="hljs-variable">rs</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br><span class="hljs-keyword">try</span> &#123;<br><span class="hljs-comment">//注册 mysql 驱动 </span><br>  Class.forName(<span class="hljs-string">&quot;com.mysql.jdbc.Driver&quot;</span>);<br><span class="hljs-comment">//连接数据的基本信息 url ，username，password</span><br><span class="hljs-type">String</span> <span class="hljs-variable">url</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;jdbc:mysql://localhost:3306/springdb&quot;</span>; <br><span class="hljs-type">String</span> <span class="hljs-variable">username</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;root&quot;</span>;<br><span class="hljs-type">String</span> <span class="hljs-variable">password</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;123456&quot;</span>;<br><span class="hljs-comment">//创建连接对象 </span><br>conn = DriverManager.getConnection(url, username, password);<br><span class="hljs-comment">//保存查询结果 </span><br>List&lt;Student&gt; stuList = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br><span class="hljs-comment">//创建 Statement, 用来执行 sql 语句 </span><br>stmt = conn.createStatement();<br><span class="hljs-comment">//执行查询，创建记录集， </span><br>rs = stmt.executeQuery(<span class="hljs-string">&quot;select * from student&quot;</span>);<br><span class="hljs-keyword">while</span> (rs.next()) &#123;<br><span class="hljs-type">Student</span> <span class="hljs-variable">stu</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Student</span>(); <br>stu.setId(rs.getInt(<span class="hljs-string">&quot;id&quot;</span>));<br>stu.setName(rs.getString(<span class="hljs-string">&quot;name&quot;</span>));<br>stu.setAge(rs.getInt(<span class="hljs-string">&quot;age&quot;</span>));<br><span class="hljs-comment">//从数据库取出数据转为 Student 对象，封装到 List 集合 </span><br>stuList.add(stu);&#125;<br>  &#125;<span class="hljs-keyword">catch</span>(Exception e)&#123;<br>      e.printStackTrace();<br>&#125;<span class="hljs-keyword">finally</span>&#123;<br>   <span class="hljs-keyword">try</span>&#123;<br><span class="hljs-keyword">if</span>(rs != <span class="hljs-literal">null</span>)<br>      rs.lose();<br><span class="hljs-keyword">if</span>(pstm != <span class="hljs-literal">null</span>)<br>      pstm.close();<br>   <span class="hljs-keyword">if</span>(con != <span class="hljs-literal">null</span>)<br>      con.close();<br>   <br>&#125;<span class="hljs-keyword">catch</span>(Exception e)&#123;<br>  e.printStackTrace();<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="2-2使用JDBC的缺陷"><a href="#2-2使用JDBC的缺陷" class="headerlink" title="2.2使用JDBC的缺陷"></a>2.2使用JDBC的缺陷</h3><p>1.代码比较多，开发效率低<br>2.需要关注 Connection ,Statement, ResultSet 对象创建和销毁<br>3.对 ResultSet 查询的结果，需要自己封装为 List<br>4.重复的代码比较多些<br>5.业务代码和数据库的操作混在一起</p>
<h2 id="3-MyBatis框架概述"><a href="#3-MyBatis框架概述" class="headerlink" title="3.MyBatis框架概述"></a>3.MyBatis框架概述</h2><h3 id="3-1概述"><a href="#3-1概述" class="headerlink" title="3.1概述"></a><strong>3.1概述</strong></h3><p>MyBatis 本是 apache 的一个开源项目 iBatis<br>2010 年这个项目由 apache software foundation 迁移到了 google code，并且改名为 MyBatis<br>2013 年 11 月迁移到 Github<br>iBATIS 一词来源于“internet”和“abatis”的组合，是一个基于 Java 的持久层框架。<br>iBATIS 提供的持久层框架包括 SQL Maps 和 Data Access Objects（DAOs）<br>当前，最新版本是 MyBatis 3.5.7 ，其发布时间是 2021 年 4月 7日</p>
<h3 id="3-2框架解决的主要问题"><a href="#3-2框架解决的主要问题" class="headerlink" title="3.2框架解决的主要问题"></a>3.2<strong>框架解决的主要问题</strong></h3><p>1、减轻使用 JDBC 的复杂性，不用编写重复的创建 Connetion , Statement ; 不用编写关闭资源代码。<br>2、直接使用 java 对象，表示结果数据。让开发者专注 SQL的处理。 其他分心的工作由 MyBatis 代劳。</p>
<p>MyBatis 可以完成：</p>
<p>1.注册数据库的驱动，例如 Class.forName(“com.mysql.jdbc.Driver”))</p>
<p>2.创建 JDBC 中必须使用的 Connection  ， Statement， ResultSet 对象</p>
<p>3.从 xml 中获取 sql，并执行 sql 语句，把 ResultSet 结果转换 java 对象</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"> List&lt;Student&gt; list = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayLsit</span>&lt;&gt;();<br>    <span class="hljs-type">ResultSet</span> <span class="hljs-variable">rs</span> <span class="hljs-operator">=</span> state.executeQuery(“select * from student”); <br>    <span class="hljs-keyword">while</span>(rs.next)&#123;<br>    <span class="hljs-type">Student</span> <span class="hljs-variable">student</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Student</span>();<br>    student.setName(rs.getString(“name”)); student.setAge(rs.getInt(“age”));<br>    list.add(student);<br>    &#125;<br><span class="hljs-comment">//4.关闭资源</span><br>ResultSet.close() , Statement.close() , Conenection.close()<br></code></pre></td></tr></table></figure>

<h3 id="3-3MyBatis框架的结构"><a href="#3-3MyBatis框架的结构" class="headerlink" title="3.3MyBatis框架的结构"></a>3.3MyBatis框架的结构</h3><hr>
<p><img src="https://cdn.jsdelivr.net/gh/fgcy-333/gitnote-images/2022/8/27202208261727004.png" srcset="/img/loading.gif" lazyload>****</p>
<hr>
<h1 id="二、MyBatis框架快速入门"><a href="#二、MyBatis框架快速入门" class="headerlink" title="二、MyBatis框架快速入门"></a>二、MyBatis框架快速入门</h1><h2 id="1-0添加框架步骤"><a href="#1-0添加框架步骤" class="headerlink" title="1.0添加框架步骤"></a>1.0添加框架步骤</h2><ol>
<li>新建库建表</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs mysql">#创建数据库ssm<br>CREATE DATABASE IF NOT EXISTS ssm DEFAULT CHARSET utf8;<br><br>#使用(打开)ssm数据库<br>use ssm;<br><br>#创建表student<br>CREATE TABLE IF NOT EXISTS `student` (<br>`id` int(11)  AUTO_INCREMENT primary key ,<br>`name` varchar(255) DEFAULT NULL,<br>`email` varchar(255) DEFAULT NULL,<br>`age` int(11) DEFAULT NULL<br>) ENGINE=InnoDB DEFAULT CHARSET=utf8;<br><br>insert into student(name,email,age) values(&#x27;张三&#x27;,&#x27;zhangsan@126.com&#x27;,22);<br>insert into student(name,email,age) values(&#x27;李四&#x27;,&#x27;lisi@126.com&#x27;,21);<br>insert into student(name,email,age) values(&#x27;王五&#x27;,&#x27;wangwu@163.com&#x27;,22);<br>insert into student(name,email,age) values(&#x27;赵六&#x27;,&#x27;zhaoliun@qq.com&#x27;,24);<br>select * from student;<br></code></pre></td></tr></table></figure>

<ol start="2">
<li>新建maven项目,选quickstart模板</li>
<li>修改目录,添加缺失的目录,修改目录属性</li>
<li>修改pom.xml文件,添加MyBatis的依赖,添加mysql的依赖</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs xml"> <span class="hljs-comment">&lt;!--添加MyBatis框架的依赖--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.mybatis<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mybatis<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.5.6<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-comment">&lt;!--添加mysql依赖--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>mysql<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mysql-connector-java<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>5.1.32<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure>

<ol start="5">
<li>修改pom.xml文件,添加资源文件指定</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--</span><br><span class="hljs-comment">maven约定大于配置：所以要配置java目录下可以进行资源导出</span><br><span class="hljs-comment">--&gt;</span> <br><span class="hljs-tag">&lt;<span class="hljs-name">build</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">resources</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">resource</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">directory</span>&gt;</span>src/main/java<span class="hljs-tag">&lt;/<span class="hljs-name">directory</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">includes</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">include</span>&gt;</span>**/*.xml<span class="hljs-tag">&lt;/<span class="hljs-name">include</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">include</span>&gt;</span>**/*.properties<span class="hljs-tag">&lt;/<span class="hljs-name">include</span>&gt;</span><br>                <span class="hljs-tag">&lt;/<span class="hljs-name">includes</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">resource</span>&gt;</span><br>            <span class="hljs-comment">&lt;!--配置了java目录下可以进行资源导出，就必须配置resouces目录下的文件的导出否则失效--&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">resource</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">directory</span>&gt;</span>src/main/resources<span class="hljs-tag">&lt;/<span class="hljs-name">directory</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">includes</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">include</span>&gt;</span>**/*.xml<span class="hljs-tag">&lt;/<span class="hljs-name">include</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">include</span>&gt;</span>**/*.properties<span class="hljs-tag">&lt;/<span class="hljs-name">include</span>&gt;</span><br>                <span class="hljs-tag">&lt;/<span class="hljs-name">includes</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">resource</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">resources</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">build</span>&gt;</span><br></code></pre></td></tr></table></figure>

<ol start="6">
<li><p>在idea中添加数据库的可视化</p>
</li>
<li><p>在resources下添加jdbc.properties属性文件(数据库的配置)</p>
</li>
</ol>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-attr">jdbc.driverClassName</span>=<span class="hljs-string">com.mysql.jdbc.Driver</span><br><span class="hljs-attr">jdbc.url</span>=<span class="hljs-string">jdbc:mysql://localhost:3306/ssm?useUnicode=true&amp;characterEncoding=utf8</span><br><span class="hljs-attr">jdbc.username</span>=<span class="hljs-string">root</span><br><span class="hljs-attr">jdbc.password</span>=<span class="hljs-string">root123</span><br></code></pre></td></tr></table></figure>

<ol start="8">
<li>添加SqlMapConfig.xml文件,MyBatis的核心配置文件</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span> ?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">configuration</span> <span class="hljs-keyword">PUBLIC</span> <span class="hljs-string">&quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span></span><br><span class="hljs-meta">        <span class="hljs-string">&quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">configuration</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!--</span><br><span class="hljs-comment">	  取属性文件(jdbc.properties)</span><br><span class="hljs-comment">      属性:</span><br><span class="hljs-comment">         resources:从resources目录下找指定名称的文件加载</span><br><span class="hljs-comment">         url:使用绝对路径加载属性文件</span><br><span class="hljs-comment">    --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">properties</span> <span class="hljs-attr">resource</span>=<span class="hljs-string">&quot;jdbc.properties&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">properties</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!--设置日志输出底层执行的代码--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">settings</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">setting</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;logImpl&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;STDOUT_LOGGING&quot;</span>/&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">settings</span>&gt;</span><br>    <span class="hljs-comment">&lt;!--注册实体类的别名--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">typeAliases</span>&gt;</span><br>        <span class="hljs-comment">&lt;!--单个实体类别名注册--&gt;</span><br>        <span class="hljs-comment">&lt;!--&lt;typeAlias type=&quot;com.bjpowernode.pojo.Student&quot; alias=&quot;student&quot;&gt;&lt;/typeAlias&gt;--&gt;</span><br>        <span class="hljs-comment">&lt;!--批量注册别名</span><br><span class="hljs-comment">          别名是类名的驼峰命名法(规范)</span><br><span class="hljs-comment">        --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">package</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;com.bjpowernode.pojo&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">package</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">typeAliases</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!--</span><br><span class="hljs-comment">		配置数据库的环境变量(数据库连接配置)</span><br><span class="hljs-comment">        default:使用下面的environment标签的id属性进行指定配置</span><br><span class="hljs-comment">    --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">environments</span> <span class="hljs-attr">default</span>=<span class="hljs-string">&quot;development&quot;</span>&gt;</span><br>        <span class="hljs-comment">&lt;!--</span><br><span class="hljs-comment">			开发时在公司使用的数据库配置</span><br><span class="hljs-comment">            id:就是提供给environments的default属性使用</span><br><span class="hljs-comment">        --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">environment</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;development&quot;</span>&gt;</span><br>            <span class="hljs-comment">&lt;!--</span><br><span class="hljs-comment">				配置事务管理器</span><br><span class="hljs-comment">                 type:指定事务管理的方式</span><br><span class="hljs-comment">                  	JDBC:事务的控制交给程序员处理</span><br><span class="hljs-comment">                  	MANAGED:由容器(Spring)来管理事务</span><br><span class="hljs-comment">            --&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">transactionManager</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;JDBC&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">transactionManager</span>&gt;</span><br>            <span class="hljs-comment">&lt;!--</span><br><span class="hljs-comment">			 配置数据源</span><br><span class="hljs-comment">               type:指定不同的配置方式</span><br><span class="hljs-comment">                  JNDI:java命名目录接口,在服务器端进行数据库连接池的管理</span><br><span class="hljs-comment">                  POOLED:使用数据库连接池</span><br><span class="hljs-comment">                  UNPOLLED:不使用数据库连接池</span><br><span class="hljs-comment">            --&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">dataSource</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;POOLED&quot;</span>&gt;</span><br>                <span class="hljs-comment">&lt;!--配置数据库连接的基本参数 连接池和非连接池都会复用这些属性</span><br><span class="hljs-comment">                    private String driver;</span><br><span class="hljs-comment">                    private String url;</span><br><span class="hljs-comment">                    private String username;</span><br><span class="hljs-comment">                    private String password;</span><br><span class="hljs-comment">                --&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;driver&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;$&#123;jdbc.driverClassName&#125;&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;url&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;$&#123;jdbc.url&#125;&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;username&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;$&#123;jdbc.username&#125;&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;$&#123;jdbc.password&#125;&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">dataSource</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">environment</span>&gt;</span><br><br>        <span class="hljs-comment">&lt;!--在家的数据库配置--&gt;</span><br>        <span class="hljs-comment">&lt;!--&lt;environment id=&quot;home&quot;&gt;--&gt;</span><br>            <span class="hljs-comment">&lt;!--&lt;transactionManager type=&quot;&quot;&gt;&lt;/transactionManager&gt;--&gt;</span><br>            <span class="hljs-comment">&lt;!--&lt;dataSource type=&quot;&quot;&gt;&lt;/dataSource&gt;--&gt;</span><br>        <span class="hljs-comment">&lt;!--&lt;/environment&gt;--&gt;</span><br><br>        <span class="hljs-comment">&lt;!--上线后的数据库配置--&gt;</span><br>        <span class="hljs-comment">&lt;!--&lt;environment id=&quot;online&quot;&gt;--&gt;</span><br>            <span class="hljs-comment">&lt;!--&lt;transactionManager type=&quot;&quot;&gt;&lt;/transactionManager&gt;--&gt;</span><br>            <span class="hljs-comment">&lt;!--&lt;dataSource type=&quot;&quot;&gt;&lt;/dataSource&gt;--&gt;</span><br>        <span class="hljs-comment">&lt;!--&lt;/environment&gt;--&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">environments</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!--注册mapper.xml文件</span><br><span class="hljs-comment">       resource:从resources目录下找指定名称的文件注册</span><br><span class="hljs-comment">       url:使用绝对路径注册</span><br><span class="hljs-comment">       class:动态代理方式下的注册</span><br><span class="hljs-comment">    --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">mappers</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">resource</span>=<span class="hljs-string">&quot;StudentMapper.xml&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">mappers</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">configuration</span>&gt;</span><br></code></pre></td></tr></table></figure>

<ul>
<li>sqlMapperConfig.xml的dtd约束</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;!ELEMENT <span class="hljs-keyword">configuration</span> </span><br><span class="hljs-meta">(<span class="hljs-keyword">properties</span>?, <span class="hljs-keyword">settings</span>?, <span class="hljs-keyword">typeAliases</span>?,</span><br><span class="hljs-meta"><span class="hljs-keyword">typeHandlers</span>?, <span class="hljs-keyword">objectFactory</span>?, <span class="hljs-keyword">objectWrapperFactory</span>?</span><br><span class="hljs-meta"><span class="hljs-keyword">reflectorFactory</span>?, <span class="hljs-keyword">plugins</span>?, <span class="hljs-keyword">environments</span>?,</span><br><span class="hljs-meta"><span class="hljs-keyword">databaseIdProvider</span>?, <span class="hljs-keyword">mappers</span>?)&gt;</span><br></code></pre></td></tr></table></figure>

<ul>
<li>sqlMapperConfig.xml【mybatis的核心配置文件】的约束文件</li>
</ul>
<hr>
<p><img src="https://cdn.jsdelivr.net/gh/fgcy-333/gitnote-images/2022/8/27202208261727966.png" srcset="/img/loading.gif" lazyload></p>
<hr>
<ul>
<li><strong>事务管理器属性类型</strong></li>
</ul>
<hr>
<p><img src="https://cdn.jsdelivr.net/gh/fgcy-333/gitnote-images/2022/8/27202208261728494.png" srcset="/img/loading.gif" lazyload></p>
<hr>
<ul>
<li><strong>数据源管理配置</strong></li>
</ul>
<hr>
<p><img src="https://cdn.jsdelivr.net/gh/fgcy-333/gitnote-images/2022/8/27202208261727703.png" srcset="/img/loading.gif" lazyload></p>
<hr>
<h2 id="2-0-MyBatis对象分析"><a href="#2-0-MyBatis对象分析" class="headerlink" title="2.0 MyBatis对象分析"></a>2.0 MyBatis对象分析</h2><p><strong>1)Resources类</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// 就是解析SqlMapConfig.xml文件,创建出java的对象</span><br><span class="hljs-type">InputStream</span> <span class="hljs-variable">in</span> <span class="hljs-operator">=</span> Resources.getResourceAsStream(<span class="hljs-string">&quot;SqlMapConfig.xml&quot;</span>);<br></code></pre></td></tr></table></figure>

<hr>
<p><strong>2)SqlSessionFactory接口</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"> <span class="hljs-comment">//使用ctrl+h快捷键查看本接口的子接口及实现类</span><br><span class="hljs-comment">// DefaultSqlSessionFactory是实现类</span><br> <span class="hljs-comment">//读取上一步创建的对象进行工厂初始化</span><br> <span class="hljs-type">SqlSessionFactory</span> <span class="hljs-variable">factory</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SqlSessionFactoryBuilder</span>().build(in);<br></code></pre></td></tr></table></figure>

<p><strong>3)SqlSession接口</strong></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">DefaultSqlSession是SqlSession接口的实现类<br></code></pre></td></tr></table></figure>



<h2 id="3-0-SqlMapConfig-xml文件的优化"><a href="#3-0-SqlMapConfig-xml文件的优化" class="headerlink" title="3.0 SqlMapConfig.xml文件的优化"></a>3.0 SqlMapConfig.xml文件的优化</h2><ul>
<li><strong>为实体类注册别名</strong></li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs xml">1)单个注册<br>   <span class="hljs-tag">&lt;<span class="hljs-name">typeAlias</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;com.bjpowernode.pojo.Student&quot;</span> <span class="hljs-attr">alias</span>=<span class="hljs-string">&quot;student&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">typeAlias</span>&gt;</span><br>2)批量注册<br>      <span class="hljs-comment">&lt;!--</span><br><span class="hljs-comment">        批量注册别名</span><br><span class="hljs-comment">        别名是类名的驼峰命名法(规范)</span><br><span class="hljs-comment">      --&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">package</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;com.bjpowernode.pojo&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">package</span>&gt;</span><br></code></pre></td></tr></table></figure>

<ul>
<li><strong>设置日志输出</strong></li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--设置日志输出底层执行的代码--&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">settings</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">setting</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;logImpl&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;STDOUT_LOGGING&quot;</span>/&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">settings</span>&gt;</span><br></code></pre></td></tr></table></figure>



<h2 id="在SqlMapConfig-xml件中注册XXMapper-xml"><a href="#在SqlMapConfig-xml件中注册XXMapper-xml" class="headerlink" title="在SqlMapConfig.xml件中注册XXMapper.xml"></a><strong>在SqlMapConfig.xml件中注册XXMapper.xml</strong></h2><p>(1)使用resource注册</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">resource</span>=<span class="hljs-string">&quot;com/bjpowernode/mapper/UsersMapper.xml&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>​    注意: UserMapper.xml是带后缀的,分隔符使用&#x2F;</p>
<p>(2)使用class注册</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.bjpowernode.mapper.UsersMapper&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>​    注意: class的值是接口的完全限定名称.没有后缀</p>
<p>(3)使用url注册</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">url</span>=<span class="hljs-string">&quot;file:///E:/UserMapper.xml&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>​	指定绝对路径注册,注意file后面是双杠.有后缀<br>​	<br>(4)使用packag&gt;注册</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">package</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;com.bjpowernode.mapper&quot;</span>/&gt;</span><br></code></pre></td></tr></table></figure>

<p>​	注意：可以写在resource中【同java之下的mapper包路径】，编译出来可以合并在java写的包下</p>
<p><strong>注意：以上四种都可以注册在resource中的mapper</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs xml">        <span class="hljs-comment">&lt;!--&lt;package name=&quot;com.bjpowernode.mapper&quot;&gt;&lt;/package&gt;--&gt;</span><br><br>        <span class="hljs-comment">&lt;!--&lt;mapper class=&quot;com.bjpowernode.mapper.UsersMapper&quot;/&gt;--&gt;</span><br><br><span class="hljs-comment">&lt;!--        &lt;mapper url=&quot;file:///D:\learn\动力节点\mybatis-张阿荣\04_project\04_project\mybatisall\mybatis_002_users\src\main\resources\com\bjpowernode\mapper\UsersMapper.xml&quot;/&gt;--&gt;</span><br><br><span class="hljs-comment">&lt;!--        &lt;mapper resource=&quot;com/bjpowernode/mapper/UsersMapper.xml&quot;/&gt;--&gt;</span><br></code></pre></td></tr></table></figure>



<h1 id="不使用动态代理的Mybatis开发"><a href="#不使用动态代理的Mybatis开发" class="headerlink" title="不使用动态代理的Mybatis开发"></a>不使用动态代理的Mybatis开发</h1><h2 id="pom-xml"><a href="#pom-xml" class="headerlink" title="pom.xml"></a>pom.xml</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span>?&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">project</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span> <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="hljs-tag">  <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">modelVersion</span>&gt;</span>4.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">modelVersion</span>&gt;</span><br><br>  <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.bjpowernode<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mybatis_001_student<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><br><br><br>  <span class="hljs-tag">&lt;<span class="hljs-name">properties</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="hljs-tag">&lt;/<span class="hljs-name">project.build.sourceEncoding</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">maven.compiler.source</span>&gt;</span>1.8<span class="hljs-tag">&lt;/<span class="hljs-name">maven.compiler.source</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">maven.compiler.target</span>&gt;</span>1.8<span class="hljs-tag">&lt;/<span class="hljs-name">maven.compiler.target</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">properties</span>&gt;</span><br><br>  <span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>junit<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>junit<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>4.11<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-comment">&lt;!--添加MyBatis框架的依赖--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.mybatis<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mybatis<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.5.6<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-comment">&lt;!--添加mysql依赖--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>mysql<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mysql-connector-java<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>5.1.32<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span><br><br>  <span class="hljs-comment">&lt;!--添加资源文件的指定--&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">build</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">resources</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">resource</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">directory</span>&gt;</span>src/main/java<span class="hljs-tag">&lt;/<span class="hljs-name">directory</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">includes</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">include</span>&gt;</span>**/*.xml<span class="hljs-tag">&lt;/<span class="hljs-name">include</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">include</span>&gt;</span>**/*.properties<span class="hljs-tag">&lt;/<span class="hljs-name">include</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">includes</span>&gt;</span><br>      <span class="hljs-tag">&lt;/<span class="hljs-name">resource</span>&gt;</span><br><br>      <span class="hljs-tag">&lt;<span class="hljs-name">resource</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">directory</span>&gt;</span>src/main/resources<span class="hljs-tag">&lt;/<span class="hljs-name">directory</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">includes</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">include</span>&gt;</span>**/*.xml<span class="hljs-tag">&lt;/<span class="hljs-name">include</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">include</span>&gt;</span>**/*.properties<span class="hljs-tag">&lt;/<span class="hljs-name">include</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">includes</span>&gt;</span><br>      <span class="hljs-tag">&lt;/<span class="hljs-name">resource</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">resources</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">build</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">project</span>&gt;</span><br><br></code></pre></td></tr></table></figure>





<h2 id="mybatis核心配置文件"><a href="#mybatis核心配置文件" class="headerlink" title="mybatis核心配置文件"></a>mybatis核心配置文件</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span> ?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">configuration</span> <span class="hljs-keyword">PUBLIC</span> <span class="hljs-string">&quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span></span><br><span class="hljs-meta">        <span class="hljs-string">&quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">configuration</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!--读取属性文件(jdbc.properties)</span><br><span class="hljs-comment">      属性:</span><br><span class="hljs-comment">         resources:从resources目录下找指定名称的文件加载</span><br><span class="hljs-comment">         url:使用绝对路径加载属性文件</span><br><span class="hljs-comment">         D:\course\16.MyBatis\04_project\mybatisall\mybatis_001_student\src\main\resources\jdbc.properties</span><br><span class="hljs-comment">    --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">properties</span> <span class="hljs-attr">resource</span>=<span class="hljs-string">&quot;jdbc.properties&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">properties</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!--设置日志输出底层执行的代码--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">settings</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">setting</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;logImpl&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;STDOUT_LOGGING&quot;</span>/&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">settings</span>&gt;</span><br>    <br>    <span class="hljs-comment">&lt;!--注册实体类的别名--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">typeAliases</span>&gt;</span><br>        <span class="hljs-comment">&lt;!--单个实体类别名注册--&gt;</span><br>        <span class="hljs-comment">&lt;!--&lt;typeAlias type=&quot;com.bjpowernode.pojo.Student&quot; alias=&quot;student&quot;&gt;&lt;/typeAlias&gt;--&gt;</span><br>        <span class="hljs-comment">&lt;!--</span><br><span class="hljs-comment">			批量注册别名</span><br><span class="hljs-comment">            别名是类名的小驼峰命名法(规范)</span><br><span class="hljs-comment">        --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">package</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;com.bjpowernode.pojo&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">package</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">typeAliases</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!--</span><br><span class="hljs-comment">		配置数据库的环境变量(数据库连接配置)</span><br><span class="hljs-comment">        default:使用下面的environment标签的id属性进行指定配置</span><br><span class="hljs-comment">    --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">environments</span> <span class="hljs-attr">default</span>=<span class="hljs-string">&quot;development&quot;</span>&gt;</span><br>        <span class="hljs-comment">&lt;!--开发时在公司使用的数据库配置</span><br><span class="hljs-comment">          id:就是提供给environments的default属性使用</span><br><span class="hljs-comment">        --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">environment</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;development&quot;</span>&gt;</span><br>            <span class="hljs-comment">&lt;!--</span><br><span class="hljs-comment">				配置事务管理器</span><br><span class="hljs-comment">               	  type:指定事务管理的方式</span><br><span class="hljs-comment">                    JDBC:事务的控制交给程序员处理</span><br><span class="hljs-comment">                    MANAGED:由容器(Spring)来管理事务</span><br><span class="hljs-comment">            --&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">transactionManager</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;JDBC&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">transactionManager</span>&gt;</span><br>            <span class="hljs-comment">&lt;!--配置数据源</span><br><span class="hljs-comment">               type:指定不同的配置方式</span><br><span class="hljs-comment">                  JNDI:java命名目录接口,在服务器端进行数据库连接池的管理</span><br><span class="hljs-comment">                  POOLED:使用数据库连接池</span><br><span class="hljs-comment">                  UNPOLLED:不使用数据库连接池</span><br><span class="hljs-comment">            --&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">dataSource</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;POOLED&quot;</span>&gt;</span><br>                <span class="hljs-comment">&lt;!--配置数据库连接的基本参数</span><br><span class="hljs-comment">                    private String driver;</span><br><span class="hljs-comment">                    private String url;</span><br><span class="hljs-comment">                    private String username;</span><br><span class="hljs-comment">                    private String password;</span><br><span class="hljs-comment">                --&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;driver&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;$&#123;jdbc.driverClassName&#125;&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;url&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;$&#123;jdbc.url&#125;&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;username&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;$&#123;jdbc.username&#125;&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;$&#123;jdbc.password&#125;&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">dataSource</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">environment</span>&gt;</span><br><br>        <span class="hljs-comment">&lt;!--在家的数据库配置--&gt;</span><br>        <span class="hljs-comment">&lt;!--&lt;environment id=&quot;home&quot;&gt;--&gt;</span><br>            <span class="hljs-comment">&lt;!--&lt;transactionManager type=&quot;&quot;&gt;&lt;/transactionManager&gt;--&gt;</span><br>            <span class="hljs-comment">&lt;!--&lt;dataSource type=&quot;&quot;&gt;&lt;/dataSource&gt;--&gt;</span><br>        <span class="hljs-comment">&lt;!--&lt;/environment&gt;--&gt;</span><br><br>        <span class="hljs-comment">&lt;!--上线后的数据库配置--&gt;</span><br>        <span class="hljs-comment">&lt;!--&lt;environment id=&quot;online&quot;&gt;--&gt;</span><br>            <span class="hljs-comment">&lt;!--&lt;transactionManager type=&quot;&quot;&gt;&lt;/transactionManager&gt;--&gt;</span><br>            <span class="hljs-comment">&lt;!--&lt;dataSource type=&quot;&quot;&gt;&lt;/dataSource&gt;--&gt;</span><br>        <span class="hljs-comment">&lt;!--&lt;/environment&gt;--&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">environments</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!--注册mapper.xml文件</span><br><span class="hljs-comment">       resource:从resources目录下找指定名称的文件注册</span><br><span class="hljs-comment">       url:使用绝对路径注册</span><br><span class="hljs-comment">       class:全限定类名  没有后缀</span><br><span class="hljs-comment">	   package：类路径下某个包 可以是java目录下，也可以是resource目录下 只是包名</span><br><span class="hljs-comment">    --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">mappers</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">resource</span>=<span class="hljs-string">&quot;StudentMapper.xml&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">mappers</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">configuration</span>&gt;</span><br></code></pre></td></tr></table></figure>

<h2 id="jdbc-properties"><a href="#jdbc-properties" class="headerlink" title="jdbc.properties"></a>jdbc.properties</h2><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-attr">jdbc.driverClassName</span>=<span class="hljs-string">com.mysql.jdbc.Driver</span><br><span class="hljs-attr">jdbc.url</span>=<span class="hljs-string">jdbc:mysql://localhost:13306/ssm?useUnicode=true&amp;characterEncoding=utf8&amp;serverTimezone=UTC</span><br><span class="hljs-attr">jdbc.username</span>=<span class="hljs-string">root</span><br><span class="hljs-attr">jdbc.password</span>=<span class="hljs-string">root123</span><br></code></pre></td></tr></table></figure>



<h2 id="实体类"><a href="#实体类" class="headerlink" title="实体类"></a>实体类</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Student</span> &#123;<br>    <span class="hljs-keyword">private</span> Integer id;<br>    <span class="hljs-keyword">private</span> String name;<br>    <span class="hljs-keyword">private</span> String email;<br>    <span class="hljs-keyword">private</span> Integer age;<br>&#125;<br></code></pre></td></tr></table></figure>



<h2 id="xxxMapper-xml"><a href="#xxxMapper-xml" class="headerlink" title="xxxMapper.xml"></a>xxxMapper.xml</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span> ?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">mapper</span> <span class="hljs-keyword">PUBLIC</span> <span class="hljs-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span><br><span class="hljs-meta">        <span class="hljs-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span><br><span class="hljs-comment">&lt;!--</span><br><span class="hljs-comment">  mapper:是整个文件的大标签,用来开始和结束xml文件</span><br><span class="hljs-comment">  属性:</span><br><span class="hljs-comment">     namespace:指定命名空间(相当于包名),用来区分不同mapper.xml文件中相同的id属性</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;zar&quot;</span>&gt;</span><br>    <span class="hljs-comment">&lt;!--</span><br><span class="hljs-comment">      完成查询全部学生的功能</span><br><span class="hljs-comment">      List&lt;Student&gt; getALL();</span><br><span class="hljs-comment">         resultType:指定查询返回的结果集的类型,如果是集合,则必须是泛型的类型</span><br><span class="hljs-comment">         parameterType:如果有参数,则通过它来指定参数的类型</span><br><span class="hljs-comment">    --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getAll&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;student&quot;</span> &gt;</span><br>       select id,name,email,age<br>       from student<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!--</span><br><span class="hljs-comment">      按主键id查询学生信息</span><br><span class="hljs-comment">      Student getById(Integer id);</span><br><span class="hljs-comment">    --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getById&quot;</span> <span class="hljs-attr">parameterType</span>=<span class="hljs-string">&quot;int&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;student&quot;</span>&gt;</span><br>        select id,name,email,age<br>        from student<br>        where id=#&#123;id&#125;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!--</span><br><span class="hljs-comment">      按学生名称模糊查询</span><br><span class="hljs-comment">      List&lt;Student&gt; getByName(String name);</span><br><span class="hljs-comment">    --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getByName&quot;</span> <span class="hljs-attr">parameterType</span>=<span class="hljs-string">&quot;string&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;student&quot;</span>&gt;</span><br>        select id,name,email,age<br>        from student<br>        where name like &#x27;%$&#123;name&#125;%&#x27;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!--</span><br><span class="hljs-comment">      增加学生</span><br><span class="hljs-comment">      int insert(Student stu);</span><br><span class="hljs-comment">      实体类:</span><br><span class="hljs-comment">        private Integer id;</span><br><span class="hljs-comment">        private String name;</span><br><span class="hljs-comment">        private String email;</span><br><span class="hljs-comment">        private Integer age;</span><br><span class="hljs-comment">    --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">insert</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;insert&quot;</span> <span class="hljs-attr">parameterType</span>=<span class="hljs-string">&quot;student&quot;</span>&gt;</span><br>        insert into student (name,email ,age) values(#&#123;name&#125;,#&#123;email&#125;,#&#123;age&#125;)<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">insert</span>&gt;</span><br>    <span class="hljs-comment">&lt;!--</span><br><span class="hljs-comment">      按主键删除学生</span><br><span class="hljs-comment">      int delete(Integer id);</span><br><span class="hljs-comment">    --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">delete</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;delete&quot;</span> <span class="hljs-attr">parameterType</span>=<span class="hljs-string">&quot;int&quot;</span> &gt;</span><br>        delete from student where id=#&#123;id&#125;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">delete</span>&gt;</span><br>    <span class="hljs-comment">&lt;!--</span><br><span class="hljs-comment">      更新学生</span><br><span class="hljs-comment">      int update(Student stu);</span><br><span class="hljs-comment">    --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">update</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;update&quot;</span> <span class="hljs-attr">parameterType</span>=<span class="hljs-string">&quot;student&quot;</span>&gt;</span><br>        update student set name=#&#123;name&#125;,email=#&#123;email&#125;,age=#&#123;age&#125;<br>        where id=#&#123;id&#125;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">update</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span><br></code></pre></td></tr></table></figure>



<h2 id="测试类"><a href="#测试类" class="headerlink" title="测试类"></a>测试类</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyTest</span> &#123;<br>    SqlSession sqlSession;<br><br>    <span class="hljs-meta">@Before</span>  <span class="hljs-comment">//在所有的@Test方法执行前先执行的代码</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">openSqlSession</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>        <span class="hljs-comment">//使用文件流读取核心配置文件SqlMapConfig.xml</span><br>        <span class="hljs-type">InputStream</span> <span class="hljs-variable">in</span> <span class="hljs-operator">=</span> Resources.getResourceAsStream(<span class="hljs-string">&quot;SqlMapConfig.xml&quot;</span>);<br>        <span class="hljs-comment">//创建SqlSessionFactory工厂</span><br>        <span class="hljs-type">SqlSessionFactory</span> <span class="hljs-variable">factory</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SqlSessionFactoryBuilder</span>().build(in);<br>        <span class="hljs-comment">//取出sqlSession的对象</span><br>        sqlSession = factory.openSession();<br>    &#125;<br><br>    <span class="hljs-meta">@After</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">closeSqlSession</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-comment">//关闭sqlSession</span><br>        sqlSession.close();<br>    &#125;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testGetAll</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>        <span class="hljs-comment">//完成查询操作</span><br>        List&lt;Student&gt; list = sqlSession.selectList(<span class="hljs-string">&quot;zar.getAll&quot;</span>);<br>        list.forEach(student -&gt; System.out.println(student));<br>    &#125;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testGetById</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>        <span class="hljs-comment">//按主键查学生</span><br>        <span class="hljs-type">Student</span> <span class="hljs-variable">stu</span> <span class="hljs-operator">=</span> sqlSession.selectOne(<span class="hljs-string">&quot;zar.getById&quot;</span>,<span class="hljs-number">3</span>);<br>        System.out.println(stu);<br>    &#125;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testGetByName</span><span class="hljs-params">()</span><span class="hljs-keyword">throws</span> IOException&#123;<br><br>        <span class="hljs-comment">//4.调用方法</span><br>        List&lt;Student&gt; list = sqlSession.selectList(<span class="hljs-string">&quot;zar.getByName&quot;</span>,<span class="hljs-string">&quot;李&quot;</span>);<br>        list.forEach(student -&gt; System.out.println(student));<br><br>    &#125;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testInsert</span><span class="hljs-params">()</span><span class="hljs-keyword">throws</span> IOException&#123;<br><br>        <span class="hljs-comment">//4.调用方法</span><br>       <span class="hljs-type">int</span> <span class="hljs-variable">num</span> <span class="hljs-operator">=</span> sqlSession.insert(<span class="hljs-string">&quot;zar.insert&quot;</span>,<span class="hljs-keyword">new</span> <span class="hljs-title class_">Student</span>(<span class="hljs-string">&quot;haha666&quot;</span>,<span class="hljs-string">&quot;haha@126.com&quot;</span>,<span class="hljs-number">23</span>));<br>       <span class="hljs-comment">//切记切记切记:在所有的增删改后必须手工提交事务!!!</span><br>        sqlSession.commit();<br><br>    &#125;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testDelete</span><span class="hljs-params">()</span><span class="hljs-keyword">throws</span> IOException &#123;<br><br>        <span class="hljs-comment">//4.调用方法</span><br>        <span class="hljs-type">int</span> <span class="hljs-variable">num</span> <span class="hljs-operator">=</span> sqlSession.delete(<span class="hljs-string">&quot;zar.delete&quot;</span>,<span class="hljs-number">1</span>);<br>        System.out.println(num);<br>        <span class="hljs-comment">//切记切记切记:在所有的增删改后必须手工提交事务!!!</span><br>        sqlSession.commit();<br><br>    &#125;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testUpdate</span><span class="hljs-params">()</span><span class="hljs-keyword">throws</span> IOException &#123;<br><br>        <span class="hljs-comment">//4.调用方法</span><br>        <span class="hljs-type">int</span> <span class="hljs-variable">num</span> <span class="hljs-operator">=</span> sqlSession.update(<span class="hljs-string">&quot;zar.update&quot;</span>,<span class="hljs-keyword">new</span> <span class="hljs-title class_">Student</span>(<span class="hljs-number">3</span>,<span class="hljs-string">&quot;hehe&quot;</span>,<span class="hljs-string">&quot;hehe@126.com&quot;</span>,<span class="hljs-number">30</span>));<br>        System.out.println(num);<br>        sqlSession.commit();<br><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>





<h1 id="三、动态代理"><a href="#三、动态代理" class="headerlink" title="三、动态代理"></a>三、动态代理</h1><h2 id="1-0-动态代理存在意义"><a href="#1-0-动态代理存在意义" class="headerlink" title="1.0 动态代理存在意义"></a>1.0 动态代理存在意义</h2><p>  在三层架构中,业务逻辑层要通过接口访问数据访问层的功能.动态代理可以实现</p>
<hr>
<p><img src="https://cdn.jsdelivr.net/gh/fgcy-333/gitnote-images/2022/8/27202208261727333.png" srcset="/img/loading.gif" lazyload></p>
<hr>
<p>业务逻辑层需要调用数据访问层的接口，此时需要动态代理将mapper.xml文件中的功能代理出来</p>
<h2 id="2-0-动态代理的实现规范"><a href="#2-0-动态代理的实现规范" class="headerlink" title="2.0 动态代理的实现规范"></a>2.0 动态代理的实现规范</h2><ul>
<li><strong>引用</strong></li>
</ul>
<p>MyBatis框架使用动态代理的方式来进行数据库的访问.<br>Mapper接口的开发相当于是过去的Dao接口的开发。由MyBatis框架根据接口定义创建动态代理对象，代理对象的方法体同Dao接口实现类的方法</p>
<ul>
<li><p><strong>规范</strong></p>
<p>1)UsersMapper.xml文件与UsersMapper.java的接口必须同一个目录下.<br>2)UsersMapper.xml文件与UsersMapper.java的接口的文件名必须一致,后缀不管.<br>3)UserMapper.xml文件中标签的id值与与UserMapper.java的接口中方法的名称完全一致.<br>4)UserMapper.xml文件中标签的parameterType属性值与与UserMapper.java的接口中方法的参数类型完全一致.<br>5)UserMapper.xml文件中标签的resultType值与与UserMapper.java的接口中方法的返回值类型完全一致.<br>6)UserMapper.xml文件中namespace属性必须是接口的完全限定名称com.fgcy.mapper.UsersMapper<br>7)在SqlMapConfig.xml文件中注册mapper文件时,使用class&#x3D;接口的完全限定名称com.fgcy.mapper.UsersMapper</p>
</li>
</ul>
<h2 id="4-0-与"><a href="#4-0-与" class="headerlink" title="4.0 #{}与${}"></a>4.0 #{}与${}</h2><ul>
<li><h6 id="x3D-x3D-传参-x3D-x3D"><a href="#x3D-x3D-传参-x3D-x3D" class="headerlink" title="#{}     &#x3D;&#x3D;传参&#x3D;&#x3D;"></a><strong>#{}</strong>     &#x3D;&#x3D;传参&#x3D;&#x3D;</h6></li>
</ul>
<p>传参大部分使用#{}传参, 它的<strong>底层使用的是PreparedStatement对象</strong>,是安全的数据库访问  , <strong>防止sql注入</strong>.</p>
<p>如果入参是简单数据类型【即：parameterType&#x3D; ‘8中基本数据类型 | String’ 】，#{}里可以任意写；【注意此时：parameterType中只能是一个类型参数】</p>
<p>但是如果入参是对象类型，则#{}里必须是对象的成员变量的名称，#{}可以有效防止sql注入。</p>
<ul>
<li>演示</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getById&quot;</span> <span class="hljs-attr">parameterType</span>=<span class="hljs-string">&quot;int&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;users&quot;</span>&gt;</span>  ===&gt;入参类型是简单类型<br>       select id,username,birthday,sex,address<br>       from users<br>       where id=#&#123;zar&#125;  ===&gt;随便写<br> <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">insert</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;insert&quot;</span> <span class="hljs-attr">parameterType</span>=<span class="hljs-string">&quot;users&quot;</span> &gt;</span>  ===&gt;入参是实体类<br>       insert into users (username, birthday, sex, address) values(#&#123;userName&#125;,#&#123;birthday&#125;,#&#123;sex&#125;,#&#123;address&#125;)  ==&gt;成员变量名称<br>   <span class="hljs-tag">&lt;/<span class="hljs-name">insert</span>&gt;</span><br></code></pre></td></tr></table></figure>

<hr>
<p><img src="https://cdn.jsdelivr.net/gh/fgcy-333/gitnote-images/2022/8/27202208261727779.png" srcset="/img/loading.gif" lazyload alt="image-20220513152156510"></p>
<hr>
<ul>
<li><strong>${}</strong>   &#x3D;&#x3D;字符串替换与拼接&#x3D;&#x3D;</li>
</ul>
<p>${}主要是针对字符串拼接替换，如果入参是基本数据类型，${}里必须是value【mybatis3.5.1一下的版本】，否则随意</p>
<p>但是如果入参是对象类型，则${}里必须是对象的成员变量的名称。</p>
<p>${}还可以替换列名和表名，存在sql注入风险，尽量少用。</p>
<ul>
<li>演示</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getByName&quot;</span> <span class="hljs-attr">parameterType</span>=<span class="hljs-string">&quot;string&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;users&quot;</span>&gt;</span>  ===&gt;入参是简单类型<br>       select id,username,birthday,sex,address<br>       from users<br>       where username like &#x27;%$&#123;zar&#125;%&#x27;   ===&gt;随便写<br>   <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span> <br>   <br><br><br>	//如果参数超过一个,则parameterType不写<br>      <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getByNameOrAddress&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;users&quot;</span>&gt;</span><br>       select id,username,birthday,sex,address<br>       from users<br>       where $&#123;columnName&#125; like concat(&#x27;%&#x27;,#&#123;columnValue&#125;,&#x27;%&#x27;)  ==&gt;此处使用的是@Param注解里的名称<br>  	 <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span> <br>  	 <br>  <br>   List<span class="hljs-tag">&lt;<span class="hljs-name">Users</span>&gt;</span> getByNameOrAddress(<br>           @Param(&quot;columnName&quot;)  ===&gt;为了在sql语句中使用的名称<br>           String columnName,<br>           @Param(&quot;columnValue&quot;)   ===&gt;为了在sql语句中使用的名称<br>           String columnValue);<br></code></pre></td></tr></table></figure>

<hr>
<p><img src="https://cdn.jsdelivr.net/gh/fgcy-333/gitnote-images/2022/8/27202208261727962.png" srcset="/img/loading.gif" lazyload alt="image-20220513152227214"></p>
<hr>
<h2 id="5-0-返回主键标签"><a href="#5-0-返回主键标签" class="headerlink" title="5.0 返回主键标签"></a>5.0 返回主键标签</h2><p>在完成插入操作后，将生成的主键信息通过实体类对象返回，在进行后继关联插入操作时，不用再次访问数据库</p>
<ul>
<li><strong>主键回填</strong></li>
</ul>
<p>在完成插入操作后，将生成的主键信息通过实体类对象返回，在进行后继关联插入操作时，不用再次访问数据库</p>
<ul>
<li><strong>自增id  【主键回填】</strong></li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs xml">  <span class="hljs-comment">&lt;!--在插入语句结束后, 返回自增的主键值到入参的users对象的id属性中.--&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">insert</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;insert&quot;</span> <span class="hljs-attr">parameterType</span>=<span class="hljs-string">&quot;users&quot;</span> &gt;</span><br>	    <span class="hljs-tag">&lt;<span class="hljs-name">selectKey</span>  <span class="hljs-attr">keyProperty</span>=<span class="hljs-string">&quot;id&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;int&quot;</span> <span class="hljs-attr">order</span>=<span class="hljs-string">&quot;AFTER&quot;</span>&gt;</span><br>	        select last_insert_id()<br>	    <span class="hljs-tag">&lt;/<span class="hljs-name">selectKey</span>&gt;</span><br>        insert into users (username, birthday, sex, address) values(#&#123;userName&#125;,#&#123;birthday&#125;,#&#123;sex&#125;,#&#123;address&#125;)<br>  <span class="hljs-tag">&lt;/<span class="hljs-name">insert</span>&gt;</span><br><br><span class="hljs-comment">&lt;!--</span><br><span class="hljs-comment">  &lt;selectKey&gt;标签的参数详解:</span><br><span class="hljs-comment">        keyProperty: users对象的哪个属性来接返回的主键值</span><br><span class="hljs-comment">        resultType:返回的主键的类型</span><br><span class="hljs-comment">        order:在插入语句执行前,还是执行后返回主键的值 AFTER：先插入再返回主键 BEFORE: 先生成再完成插入</span><br><span class="hljs-comment">      	select last_insert_id()函数：返回最近一条插入记录的主键</span><br><span class="hljs-comment">--&gt;</span><br></code></pre></td></tr></table></figure>

<ul>
<li><strong>UUID 【生成主键】</strong></li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs XML">    <span class="hljs-comment">&lt;!--生成一个UUID作为主键，并回填到入参中--&gt;</span><br>	<span class="hljs-tag">&lt;<span class="hljs-name">insert</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;addUser&quot;</span> <span class="hljs-attr">parameterType</span>=<span class="hljs-string">&quot;users&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">selectKey</span> <span class="hljs-attr">order</span>=<span class="hljs-string">&quot;BEFORE&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;String&quot;</span> <span class="hljs-attr">keyProperty</span>=<span class="hljs-string">&quot;id&quot;</span>&gt;</span><br>            select uuid()<br>        <span class="hljs-tag">&lt;/<span class="hljs-name">selectKey</span>&gt;</span><br>        insert into users (id,username, birthday, sex, address)<br>        values (#&#123;id&#125;,#&#123;username&#125;, #&#123;birthDate&#125;, #&#123;sex&#125;, #&#123;address&#125;)<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">insert</span>&gt;</span><br><br><br><span class="hljs-comment">&lt;!--</span><br><span class="hljs-comment">这是一个全球唯一随机字符串,由36个字母数字中划线组.</span><br><span class="hljs-comment">  UUID uuid = UUID.randomUUID();</span><br><span class="hljs-comment">  System.out.println(uuid.toString().replace(&quot;-&quot;,&quot;&quot;).substring(20));</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">  select uuid()</span><br><span class="hljs-comment">--&gt;</span><br></code></pre></td></tr></table></figure>



<h1 id="动态代理的Mybatis开发"><a href="#动态代理的Mybatis开发" class="headerlink" title="动态代理的Mybatis开发"></a>动态代理的Mybatis开发</h1><h2 id="新建项目添加依赖"><a href="#新建项目添加依赖" class="headerlink" title="新建项目添加依赖"></a>新建项目添加依赖</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span>?&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">project</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span> <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="hljs-tag">         <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">modelVersion</span>&gt;</span>4.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">modelVersion</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.fgcy<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mybatis_002<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">properties</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="hljs-tag">&lt;/<span class="hljs-name">project.build.sourceEncoding</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">maven.compiler.source</span>&gt;</span>1.8<span class="hljs-tag">&lt;/<span class="hljs-name">maven.compiler.source</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">maven.compiler.target</span>&gt;</span>1.8<span class="hljs-tag">&lt;/<span class="hljs-name">maven.compiler.target</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">properties</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>junit<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>junit<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>4.11<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>mysql<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mysql-connector-java<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>5.1.48<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>        <br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.mybatis<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mybatis<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.5.6<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span><br><br>    <br>    <span class="hljs-comment">&lt;!--maven资源导出--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">build</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">resources</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">resource</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">directory</span>&gt;</span>src/main/java<span class="hljs-tag">&lt;/<span class="hljs-name">directory</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">includes</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">include</span>&gt;</span>**/*.xml<span class="hljs-tag">&lt;/<span class="hljs-name">include</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">include</span>&gt;</span>**/*.properties<span class="hljs-tag">&lt;/<span class="hljs-name">include</span>&gt;</span><br>                <span class="hljs-tag">&lt;/<span class="hljs-name">includes</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">resource</span>&gt;</span><br><br>            <span class="hljs-tag">&lt;<span class="hljs-name">resource</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">directory</span>&gt;</span>src/resources<span class="hljs-tag">&lt;/<span class="hljs-name">directory</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">includes</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">include</span>&gt;</span>**/*.xml<span class="hljs-tag">&lt;/<span class="hljs-name">include</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">include</span>&gt;</span>**/*.properties<span class="hljs-tag">&lt;/<span class="hljs-name">include</span>&gt;</span><br>                <span class="hljs-tag">&lt;/<span class="hljs-name">includes</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">resource</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">resources</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">build</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">project</span>&gt;</span><br><br></code></pre></td></tr></table></figure>

<h2 id="新建属性文件db-properties"><a href="#新建属性文件db-properties" class="headerlink" title="新建属性文件db.properties"></a>新建属性文件db.properties</h2><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-attr">jdbc.driverClassName</span>=<span class="hljs-string">com.mysql.jdbc.Driver</span><br><span class="hljs-attr">jdbc.url</span>=<span class="hljs-string">jdbc:mysql://localhost:13306/ssm?useUnicode=true&amp;characterEncoding=utf8</span><br><span class="hljs-attr">jdbc.username</span>=<span class="hljs-string">root</span><br><span class="hljs-attr">jdbc.password</span>=<span class="hljs-string">root123</span><br></code></pre></td></tr></table></figure>

<h2 id="新建环境配置文件-SqlMapConfig-xml"><a href="#新建环境配置文件-SqlMapConfig-xml" class="headerlink" title="新建环境配置文件(SqlMapConfig.xml)"></a>新建环境配置文件(SqlMapConfig.xml)</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span> ?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">configuration</span> <span class="hljs-keyword">PUBLIC</span> <span class="hljs-string">&quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span></span><br><span class="hljs-meta">        <span class="hljs-string">&quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">configuration</span>&gt;</span><br>    <span class="hljs-comment">&lt;!--读取jdbc.properties属性--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">properties</span> <span class="hljs-attr">resource</span>=<span class="hljs-string">&quot;jdbc.properties&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">properties</span>&gt;</span><br>    <span class="hljs-comment">&lt;!--设置日志输出--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">settings</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">setting</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;logImpl&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;STDOUT_LOGGING&quot;</span>/&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">settings</span>&gt;</span><br>    <span class="hljs-comment">&lt;!--注册实体类的别名--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">typeAliases</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">package</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;com.bjpowernode.pojo&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">package</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">typeAliases</span>&gt;</span><br>    <span class="hljs-comment">&lt;!--配置环境变量--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">environments</span> <span class="hljs-attr">default</span>=<span class="hljs-string">&quot;development&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">environment</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;development&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">transactionManager</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;JDBC&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">transactionManager</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">dataSource</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;POOLED&quot;</span>&gt;</span><br>                <span class="hljs-comment">&lt;!--</span><br><span class="hljs-comment">                    private String driver;</span><br><span class="hljs-comment">                    private String url;</span><br><span class="hljs-comment">                    private String username;</span><br><span class="hljs-comment">                    private String password;</span><br><span class="hljs-comment">                --&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;driver&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;$&#123;jdbc.driverClassName&#125;&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;url&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;$&#123;jdbc.url&#125;&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;username&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;$&#123;jdbc.username&#125;&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;$&#123;jdbc.password&#125;&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">dataSource</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">environment</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">environments</span>&gt;</span><br>    <span class="hljs-comment">&lt;!--注册mapper.xml文件--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">mappers</span>&gt;</span><br><br>        <span class="hljs-comment">&lt;!--&lt;package name=&quot;com.bjpowernode.mapper&quot;&gt;&lt;/package&gt;--&gt;</span><br>        <span class="hljs-comment">&lt;!--&lt;mapper class=&quot;com.bjpowernode.mapper.UsersMapper&quot;/&gt;--&gt;</span><br><span class="hljs-comment">&lt;!--        &lt;mapper url=&quot;file:///D:\learn\动力节点\mybatis-张阿荣\04_project\04_project\mybatisall\mybatis_002_users\src\main\resources\com\bjpowernode\mapper\UsersMapper.xml&quot;/&gt;--&gt;</span><br><span class="hljs-comment">&lt;!--        &lt;mapper resource=&quot;com/bjpowernode/mapper/UsersMapper.xml&quot;/&gt;--&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">mappers</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">configuration</span>&gt;</span><br></code></pre></td></tr></table></figure>

<h2 id="新建可视化窗口"><a href="#新建可视化窗口" class="headerlink" title="新建可视化窗口"></a>新建可视化窗口</h2><hr>
<p><img src="https://cdn.jsdelivr.net/gh/fgcy-333/gitnote-images/2022/8/27202208261727322.png" srcset="/img/loading.gif" lazyload></p>
<hr>
<hr>
<p><img src="https://cdn.jsdelivr.net/gh/fgcy-333/gitnote-images/2022/8/27202208261727891.png" srcset="/img/loading.gif" lazyload></p>
<hr>
<h2 id="新建实体类"><a href="#新建实体类" class="headerlink" title="新建实体类"></a>新建实体类</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.bjpowernode.pojo;<br><br><span class="hljs-keyword">import</span> java.util.Date;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Users</span> &#123;<br>    <span class="hljs-keyword">private</span> Integer id;<br>    <span class="hljs-keyword">private</span> String userName;<br>    <span class="hljs-keyword">private</span> Date birthday;<br>    <span class="hljs-keyword">private</span> String sex;<br>    <span class="hljs-keyword">private</span> String address;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<h2 id="新建mapper文件，完成数据库中的所有操作"><a href="#新建mapper文件，完成数据库中的所有操作" class="headerlink" title="新建mapper文件，完成数据库中的所有操作"></a>新建mapper文件，完成数据库中的所有操作</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span> ?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">mapper</span> <span class="hljs-keyword">PUBLIC</span> <span class="hljs-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span><br><span class="hljs-meta">        <span class="hljs-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;com.bjpowernode.mapper.UsersMapper&quot;</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!--</span><br><span class="hljs-comment">      //查询全部用户信息</span><br><span class="hljs-comment">    List&lt;Users&gt; getAll();</span><br><span class="hljs-comment">    --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getAll&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;users&quot;</span> &gt;</span><br>        select id,username,birthday,sex,address<br>        from users<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!--</span><br><span class="hljs-comment">      //根据用户主键查用户</span><br><span class="hljs-comment">    Users getById(Integer id);</span><br><span class="hljs-comment">    --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getById&quot;</span> <span class="hljs-attr">parameterType</span>=<span class="hljs-string">&quot;int&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;users&quot;</span>&gt;</span><br>        select id,username,birthday,sex,address<br>        from users<br>        where id=#&#123;zar&#125;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!--</span><br><span class="hljs-comment">       //根据用户名模糊查询用户</span><br><span class="hljs-comment">    List&lt;Users&gt; getByName(String name);</span><br><span class="hljs-comment">    --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getByName&quot;</span> <span class="hljs-attr">parameterType</span>=<span class="hljs-string">&quot;string&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;users&quot;</span>&gt;</span><br>        select id,username,birthday,sex,address<br>        from users<br>        where username like &#x27;%$&#123;zar&#125;%&#x27;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br>    <span class="hljs-comment">&lt;!--</span><br><span class="hljs-comment">       //用户的更新</span><br><span class="hljs-comment">    int update(Users users);</span><br><span class="hljs-comment">    private Integer id;</span><br><span class="hljs-comment">    private String userName;</span><br><span class="hljs-comment">    private Date birthday;</span><br><span class="hljs-comment">    private String sex;</span><br><span class="hljs-comment">    private String address;</span><br><span class="hljs-comment">    --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">update</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;update&quot;</span> <span class="hljs-attr">parameterType</span>=<span class="hljs-string">&quot;users&quot;</span> &gt;</span><br>        update users set username = #&#123;userName&#125;,birthday=#&#123;birthday&#125;,sex=#&#123;sex&#125;,address=#&#123;address&#125;<br>        where id=#&#123;id&#125;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">update</span>&gt;</span><br><br><br>    <span class="hljs-comment">&lt;!--</span><br><span class="hljs-comment">      //增加用户</span><br><span class="hljs-comment">    int insert(Users users);</span><br><span class="hljs-comment">    --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">insert</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;insert&quot;</span> <span class="hljs-attr">parameterType</span>=<span class="hljs-string">&quot;users&quot;</span> &gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">selectKey</span>  <span class="hljs-attr">keyProperty</span>=<span class="hljs-string">&quot;id&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;int&quot;</span> <span class="hljs-attr">order</span>=<span class="hljs-string">&quot;AFTER&quot;</span>&gt;</span><br>        select last_insert_id()<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">selectKey</span>&gt;</span><br>        insert into users (username, birthday, sex, address) values(#&#123;userName&#125;,#&#123;birthday&#125;,#&#123;sex&#125;,#&#123;address&#125;)<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">insert</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!--</span><br><span class="hljs-comment">       //根据主键删除用户</span><br><span class="hljs-comment">    int delete(Integer id);</span><br><span class="hljs-comment">    --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">delete</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;delete&quot;</span> <span class="hljs-attr">parameterType</span>=<span class="hljs-string">&quot;int&quot;</span> &gt;</span><br>        delete from users<br>        where id=#&#123;id&#125;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">delete</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!--</span><br><span class="hljs-comment">       //优化后的模糊查询</span><br><span class="hljs-comment">    List&lt;Users&gt; getByNameGood(String name);</span><br><span class="hljs-comment">    --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getByNameGood&quot;</span> <span class="hljs-attr">parameterType</span>=<span class="hljs-string">&quot;string&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;users&quot;</span>&gt;</span><br>        select id,username,birthday,sex,address<br>        from users<br>        where username like concat(&#x27;%&#x27;,#&#123;name&#125;,&#x27;%&#x27;)<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!--</span><br><span class="hljs-comment">    //模糊用户名和地址查询</span><br><span class="hljs-comment">    //如果参数超过一个,则parameterType不写</span><br><span class="hljs-comment">    List&lt;Users&gt; getByNameOrAddress(</span><br><span class="hljs-comment">            @Param(&quot;columnName&quot;)</span><br><span class="hljs-comment">            String columnName,</span><br><span class="hljs-comment">            @Param(&quot;columnValue&quot;)</span><br><span class="hljs-comment">            String columnValue);</span><br><span class="hljs-comment">    --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getByNameOrAddress&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;users&quot;</span>&gt;</span><br>        select id,username,birthday,sex,address<br>        from users<br>        where $&#123;columnName&#125; like concat(&#x27;%&#x27;,#&#123;columnValue&#125;,&#x27;%&#x27;)<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span><br></code></pre></td></tr></table></figure>

<h2 id="新建测试类"><a href="#新建测试类" class="headerlink" title="新建测试类"></a>新建测试类</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyTest</span> &#123;<br>    SqlSession sqlSession;<br><br>    <span class="hljs-meta">@Before</span>  <span class="hljs-comment">//在所有的@Test方法执行前先执行的代码</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">openSqlSession</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>        <span class="hljs-comment">//使用文件流读取核心配置文件SqlMapConfig.xml</span><br>        <span class="hljs-type">InputStream</span> <span class="hljs-variable">in</span> <span class="hljs-operator">=</span> Resources.getResourceAsStream(<span class="hljs-string">&quot;SqlMapConfig.xml&quot;</span>);<br>        <span class="hljs-comment">//创建SqlSessionFactory工厂</span><br>        <span class="hljs-type">SqlSessionFactory</span> <span class="hljs-variable">factory</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SqlSessionFactoryBuilder</span>().build(in);<br>        <span class="hljs-comment">//取出sqlSession的对象</span><br>        sqlSession = factory.openSession();<br>    &#125;<br><br>    <span class="hljs-meta">@After</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">closeSqlSession</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-comment">//关闭sqlSession</span><br>        sqlSession.close();<br>    &#125;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testGetAll</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>        <span class="hljs-comment">//完成查询操作</span><br>        <span class="hljs-comment">//namespace.id</span><br>        List&lt;Student&gt; list = sqlSession.selectList(<span class="hljs-string">&quot;zar.getAll&quot;</span>);<br>        list.forEach(student -&gt; System.out.println(student));<br>    &#125;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testGetById</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>        <span class="hljs-comment">//按主键查学生</span><br>        <span class="hljs-type">Student</span> <span class="hljs-variable">stu</span> <span class="hljs-operator">=</span> sqlSession.selectOne(<span class="hljs-string">&quot;zar.getById&quot;</span>,<span class="hljs-number">3</span>);<br>        System.out.println(stu);<br>    &#125;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testGetByName</span><span class="hljs-params">()</span><span class="hljs-keyword">throws</span> IOException&#123;<br><br>        <span class="hljs-comment">//4.调用方法</span><br>        List&lt;Student&gt; list = sqlSession.selectList(<span class="hljs-string">&quot;zar.getByName&quot;</span>,<span class="hljs-string">&quot;李&quot;</span>);<br>        list.forEach(student -&gt; System.out.println(student));<br><br>    &#125;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testInsert</span><span class="hljs-params">()</span><span class="hljs-keyword">throws</span> IOException&#123;<br><br>        <span class="hljs-comment">//4.调用方法</span><br>       <span class="hljs-type">int</span> <span class="hljs-variable">num</span> <span class="hljs-operator">=</span> sqlSession.insert(<span class="hljs-string">&quot;zar.insert&quot;</span>,<span class="hljs-keyword">new</span> <span class="hljs-title class_">Student</span>(<span class="hljs-string">&quot;haha666&quot;</span>,<span class="hljs-string">&quot;haha@126.com&quot;</span>,<span class="hljs-number">23</span>));<br>       <span class="hljs-comment">//切记切记切记:在所有的增删改后必须手工提交事务!!!</span><br>        sqlSession.commit();<br><br>    &#125;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testDelete</span><span class="hljs-params">()</span><span class="hljs-keyword">throws</span> IOException &#123;<br><br>        <span class="hljs-comment">//4.调用方法</span><br>        <span class="hljs-type">int</span> <span class="hljs-variable">num</span> <span class="hljs-operator">=</span> sqlSession.delete(<span class="hljs-string">&quot;zar.delete&quot;</span>,<span class="hljs-number">1</span>);<br>        System.out.println(num);<br>        <span class="hljs-comment">//切记切记切记:在所有的增删改后必须手工提交事务!!!</span><br>        sqlSession.commit();<br><br>    &#125;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testUpdate</span><span class="hljs-params">()</span><span class="hljs-keyword">throws</span> IOException &#123;<br><br>        <span class="hljs-comment">//4.调用方法</span><br>        <span class="hljs-type">int</span> <span class="hljs-variable">num</span> <span class="hljs-operator">=</span> sqlSession.update(<span class="hljs-string">&quot;zar.update&quot;</span>,<span class="hljs-keyword">new</span> <span class="hljs-title class_">Student</span>(<span class="hljs-number">3</span>,<span class="hljs-string">&quot;hehe&quot;</span>,<span class="hljs-string">&quot;hehe@126.com&quot;</span>,<span class="hljs-number">30</span>));<br>        System.out.println(num);<br>        sqlSession.commit();<br><br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>



<h1 id="四、动态sql"><a href="#四、动态sql" class="headerlink" title="四、动态sql"></a>四、动态sql</h1><h2 id="1-0-概念"><a href="#1-0-概念" class="headerlink" title="1.0 概念"></a>1.0 概念</h2><p>动态 SQL 是 MyBatis 的强大特性之一<br>可以定义代码片断,可以进行逻辑判断,可以进行循环处理(批量处理),使条件判断更为简单</p>
<h1 id="lt-sql-gt-标签"><a href="#lt-sql-gt-标签" class="headerlink" title="&lt;sql&gt;标签"></a>&lt;sql&gt;标签</h1><p><strong>用来定义代码片断</strong>,可以将所有的列名,或复杂的条件定义为代码片断,供使用时调用<br>当多种类型的查询语句的查询字段或者查询条件相同时，可以将其定义为<strong>常量</strong>，方便调用</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--定义代码片断--&gt;</span><br> <span class="hljs-tag">&lt;<span class="hljs-name">sql</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;allColumns&quot;</span>&gt;</span><br>     id,username,birthday,sex,address<br> <span class="hljs-tag">&lt;/<span class="hljs-name">sql</span>&gt;</span><br></code></pre></td></tr></table></figure>



<h1 id="lt-include-gt-标签"><a href="#lt-include-gt-标签" class="headerlink" title="&lt;include&gt;标签"></a>&lt;include&gt;标签</h1><p>用来<strong>引用&lt;sql&gt;定义的代码</strong>片断</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml">//引用定义好的代码片断<br>  <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getAll&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;users&quot;</span> &gt;</span><br>       select <span class="hljs-tag">&lt;<span class="hljs-name">include</span> <span class="hljs-attr">refid</span>=<span class="hljs-string">&quot;allColumns&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">include</span>&gt;</span><br>       from users<br>   <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br></code></pre></td></tr></table></figure>



<h1 id="lt-if-gt-标签"><a href="#lt-if-gt-标签" class="headerlink" title="&lt;if&gt;标签"></a>&lt;if&gt;标签</h1><p>&lt;if&gt;:进行条件判断<br>    属性：test条件判断的取值可以是<strong>实体类的成员变量</strong>,可以是<strong>map的key</strong>,可以是**@Param注解的名称**.</p>
<p>​	<strong>属性test必须有值，里面的取值不需要${}或#{}，可以直接使用实体类的成员变量，map的key，有@Param(“xxxx”)标注的变量</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;userName != null and userName != &#x27;&#x27;&quot;</span>&gt;</span><br>   and username like concat(&#x27;%&#x27;,#&#123;userName&#125;,&#x27;%&#x27;)<br><span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span><br></code></pre></td></tr></table></figure>



<h1 id="lt-where-gt-标签"><a href="#lt-where-gt-标签" class="headerlink" title="&lt;where&gt;标签"></a>&lt;where&gt;标签</h1><p>&lt;where&gt;:进行<strong>多条件拼接</strong>,在查询,删除,更新中使用.</p>
<p>一般开发复杂业务的查询条件时，如果有多个查询条件，通常会使用&lt;where&gt;标签来进行控制。 </p>
<p><strong>标签可以自动的将第一个条件前面的逻辑运算符 (or ,and) 去掉</strong>，正如代码中写的，id 查询条件前面是有“and”关键字的</p>
<p>但是在打印出来的 SQL 中却没有，这就是&lt;where&gt; 的作用。</p>
<p><strong>where标签可以过滤掉 多余的 and 和 or</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">if</span>&gt;</span>配<span class="hljs-tag">&lt;<span class="hljs-name">where</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getByCondition&quot;</span> <span class="hljs-attr">parameterType</span>=<span class="hljs-string">&quot;users&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;users&quot;</span>&gt;</span><br>    select <span class="hljs-tag">&lt;<span class="hljs-name">include</span> <span class="hljs-attr">refid</span>=<span class="hljs-string">&quot;allColumns&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">include</span>&gt;</span><br>    from users<br>    <span class="hljs-tag">&lt;<span class="hljs-name">where</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;userName != null and userName != &#x27;&#x27;&quot;</span>&gt;</span><br>           and username like concat(&#x27;%&#x27;,#&#123;userName&#125;,&#x27;%&#x27;)<br>        <span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;birthday != null&quot;</span>&gt;</span><br>           and birthday = #&#123;birthday&#125;<br>        <span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;sex != null and sex != &#x27;&#x27;&quot;</span>&gt;</span><br>           and sex = #&#123;sex&#125;<br>        <span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;address != null and address != &#x27;&#x27;&quot;</span>&gt;</span><br>            and address like concat(&#x27;%&#x27;,#&#123;address&#125;,&#x27;%&#x27;)<br>        <span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">where</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br></code></pre></td></tr></table></figure>



<h1 id="lt-set-gt-标签"><a href="#lt-set-gt-标签" class="headerlink" title="&lt;set&gt;标签"></a>&lt;set&gt;标签</h1><p>&lt;set&gt;:有选择的进行更新处理,至少更新一列.能够保证如果没有传值进来,则数据库中的数据保持不变.</p>
<p><strong>使用set标签可以将动态的配置 SET 关键字</strong>，并<strong>剔除追加到条件末尾的任何不相关的逗号</strong>。</p>
<p>使用 if+set 标签修改后，在进行表单更新的操作中，哪个字段中有值才去更新，如果某项为 null 则不进行更新，而是保持数据库原值。</p>
<p>切记：<strong>至少更新一列。否则报错·······</strong> 可以过滤掉多余的逗号</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs xml"> 	<span class="hljs-tag">&lt;<span class="hljs-name">if</span>&gt;</span> 配 <span class="hljs-tag">&lt;<span class="hljs-name">set</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">update</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;updateBySet&quot;</span> <span class="hljs-attr">parameterType</span>=<span class="hljs-string">&quot;users&quot;</span>&gt;</span><br>       update users<br>       <span class="hljs-tag">&lt;<span class="hljs-name">set</span>&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;userName != null and userName != &#x27;&#x27;&quot;</span>&gt;</span><br>              username = #&#123;userName&#125;,<br>           <span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;birthday != null&quot;</span>&gt;</span><br>               birthday = #&#123;birthday&#125;,<br>           <span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;sex != null and sex != &#x27;&#x27;&quot;</span>&gt;</span><br>               sex = #&#123;sex&#125;,<br>           <span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;address != null and address != &#x27;&#x27;&quot;</span>&gt;</span><br>               address =#&#123;address&#125; ,<br>           <span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span><br>       <span class="hljs-tag">&lt;/<span class="hljs-name">set</span>&gt;</span><br>       where id = #&#123;id&#125;<br>   <span class="hljs-tag">&lt;/<span class="hljs-name">update</span>&gt;</span><br></code></pre></td></tr></table></figure>



<h1 id="lt-foreach-gt-标签"><a href="#lt-foreach-gt-标签" class="headerlink" title="&lt;foreach&gt;标签"></a>&lt;foreach&gt;标签</h1><h2 id="属性详解"><a href="#属性详解" class="headerlink" title="属性详解"></a><strong>属性详解</strong></h2><p>&lt;foreach&gt;主要用来进行集合或数组的遍历</p>
<p>主要有以下参数：</p>
<p>​	collection：入参类型 属性的值有三个分别是 <strong>list、array、map 三种</strong>，分别对应的参数类型为：<strong>List、数组、map 集合</strong>。【parameter中没有arry数组类型，						如果要使用数组，parameter必须不写】</p>
<p>​	item ：循环体中的具体对象或值。支持属性的点路径访问，如item.age,item.info.details，<strong>在list和数组中是其中的对象</strong>，<strong>在map中是value</strong>。</p>
<p>​	index ：<strong>在list和数组中,index是元素的序号</strong>，<strong>在map中，index是元素的key，该参数可选</strong>。</p>
<p>​	open ：表示该<strong>语句以什么开始</strong></p>
<p>​	close ：表示该<strong>语句以什么结束</strong></p>
<p>​	separator ：表示<strong>元素之间的分隔符</strong></p>
<p>​			例如在in()的时候，separator&#x3D;”,”会自动在元素中间用“,“隔开，避免手动输入逗号导致sql错误，如in(1,2,)这样。该参数可选</p>
<h2 id="批量查找"><a href="#批量查找" class="headerlink" title="批量查找"></a><strong>批量查找</strong></h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--</span><br><span class="hljs-comment">parameterType=&#x27;&#x27;除了是实体类之外其他的都不用写</span><br><span class="hljs-comment">8个基本数据类型 + String 当作是普通类型</span><br><span class="hljs-comment">当参数是普通类型时，且只有一个，可写可不写</span><br><span class="hljs-comment">当参数不止一个，接口中要用@Param注解</span><br><span class="hljs-comment">当参数是 list map 时可以不用写</span><br><span class="hljs-comment">不能这么写--》parameterType=&quot;array&quot; 因为mybatis没有数组类型 当只有一个入参时，可以不写（除非这是实体类）</span><br><span class="hljs-comment">--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getByIds&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;users&quot;</span>&gt;</span><br>    select<br>    <span class="hljs-tag">&lt;<span class="hljs-name">include</span> <span class="hljs-attr">refid</span>=<span class="hljs-string">&quot;allColumns&quot;</span>/&gt;</span><br>    from users<br>    where id in<br>    <span class="hljs-tag">&lt;<span class="hljs-name">foreach</span> <span class="hljs-attr">collection</span>=<span class="hljs-string">&quot;array&quot;</span> <span class="hljs-attr">item</span>=<span class="hljs-string">&quot;id&quot;</span> <span class="hljs-attr">separator</span>=<span class="hljs-string">&quot;,&quot;</span> <span class="hljs-attr">open</span>=<span class="hljs-string">&quot;(&quot;</span> <span class="hljs-attr">close</span>=<span class="hljs-string">&quot;)&quot;</span>&gt;</span><br>        #&#123;id&#125;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">foreach</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br></code></pre></td></tr></table></figure>

<h2 id="批量删除"><a href="#批量删除" class="headerlink" title="批量删除"></a><strong>批量删除</strong></h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs xml">   <span class="hljs-comment">&lt;!--</span><br><span class="hljs-comment">	#&#123;&#125;占位符、从入参中取值</span><br><span class="hljs-comment">	$&#123;&#125;字符串拼接、字符串替换</span><br><span class="hljs-comment">--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">delete</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;deleteBatch&quot;</span>&gt;</span><br>       delete<br>       from users<br>       where id in<br>       <span class="hljs-tag">&lt;<span class="hljs-name">foreach</span> <span class="hljs-attr">collection</span>=<span class="hljs-string">&quot;array&quot;</span> <span class="hljs-attr">open</span>=<span class="hljs-string">&quot;(&quot;</span> <span class="hljs-attr">close</span>=<span class="hljs-string">&quot;)&quot;</span> <span class="hljs-attr">separator</span>=<span class="hljs-string">&quot;,&quot;</span> <span class="hljs-attr">item</span>=<span class="hljs-string">&quot;id&quot;</span>&gt;</span><br>           #&#123;id&#125;<br>       <span class="hljs-tag">&lt;/<span class="hljs-name">foreach</span>&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">delete</span>&gt;</span><br></code></pre></td></tr></table></figure>

<h2 id="批量添加"><a href="#批量添加" class="headerlink" title="批量添加"></a><strong>批量添加</strong></h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs xml">  <span class="hljs-comment">&lt;!--</span><br><span class="hljs-comment">	#&#123;&#125;占位符、从入参中取值</span><br><span class="hljs-comment">	$&#123;&#125;字符串拼接、字符串替换</span><br><span class="hljs-comment">--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">insert</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;addBatch&quot;</span>&gt;</span><br>       insert into users (username, birthday, sex, address) values<br>       <span class="hljs-comment">&lt;!--</span><br><span class="hljs-comment">			批量添加不用open close 因为这是在整个循环之前和之后添加的</span><br><span class="hljs-comment">		而我们需要的是这种：insert into users (username, birthday, sex, address) values(?,?,?,?),(?,?,?,?),(?,?,?,?)</span><br><span class="hljs-comment">		而不是这种：insert into users (username, birthday, sex, address) values( ?,?,?,?,  ?,?,?,? ,  ?,?,?,? )</span><br><span class="hljs-comment">	--&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">foreach</span> <span class="hljs-attr">collection</span>=<span class="hljs-string">&quot;list&quot;</span> <span class="hljs-attr">item</span>=<span class="hljs-string">&quot;user&quot;</span> <span class="hljs-attr">separator</span>=<span class="hljs-string">&quot;,&quot;</span>&gt;</span><br>           (#&#123;user.username&#125;,#&#123;user.birthDate&#125;,#&#123;user.sex&#125;,#&#123;user.address&#125;)<br>       <span class="hljs-tag">&lt;/<span class="hljs-name">foreach</span>&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">insert</span>&gt;</span><br></code></pre></td></tr></table></figure>

<h2 id="批量更新"><a href="#批量更新" class="headerlink" title="批量更新"></a><strong>批量更新</strong></h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">update</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;updateBatch&quot;</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">foreach</span> <span class="hljs-attr">collection</span>=<span class="hljs-string">&quot;list&quot;</span> <span class="hljs-attr">separator</span>=<span class="hljs-string">&quot;;&quot;</span> <span class="hljs-attr">item</span>=<span class="hljs-string">&quot;user&quot;</span>&gt;</span><br>           update users<br>           <span class="hljs-tag">&lt;<span class="hljs-name">set</span>&gt;</span><br>               <span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;user.username!=null and user.username!=&#x27;&#x27;&quot;</span>&gt;</span><br>                   username=#&#123;user.username&#125;,<br>               <span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span><br>               <span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;user.birthDate!=null&quot;</span>&gt;</span><br>                   birthday=#&#123;user.birthDate&#125;,<br>               <span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span><br>               <span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;user.sex!=null and user.sex!=&#x27;&#x27;&quot;</span>&gt;</span><br>                   sex=#&#123;user.sex&#125;,<br>               <span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span><br>               <span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;user.address!=null and user.address!=&#x27;&#x27;&quot;</span>&gt;</span><br>                   address=#&#123;user.address&#125;<br>               <span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span><br>           <span class="hljs-tag">&lt;/<span class="hljs-name">set</span>&gt;</span><br>           where id = #&#123;user.id&#125;<br>       <span class="hljs-tag">&lt;/<span class="hljs-name">foreach</span>&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">update</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p><strong>注意：</strong></p>
<p>要使用批量更新，必须在jdbc.properties属性文件中的url中添加&amp;allowMultiQueries&#x3D;true，允许多行操作</p>
<h1 id="指定参数位置"><a href="#指定参数位置" class="headerlink" title="指定参数位置"></a>指定参数位置</h1><h2 id="使用场景"><a href="#使用场景" class="headerlink" title="使用场景"></a>使用场景</h2><p>如果入参是多个,可以通过指定参数位置进行传参.<br>mybatis-3.3 版本和之前的版本使用#{0},#{1}方式， 从 mybatis3.4 开始使用#{arg0}方式。</p>
<h2 id="指定参数位置获取值"><a href="#指定参数位置获取值" class="headerlink" title="指定参数位置获取值"></a>指定参数位置获取值</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs xml">例如:查询指定日期范围内的用户信息.<br>    <span class="hljs-comment">&lt;!--</span><br><span class="hljs-comment">     		//查询指定日期范围内的用户</span><br><span class="hljs-comment">    		List&lt;Users&gt; getByBirthday(Date begin, Date end);</span><br><span class="hljs-comment">    --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getByBirthday&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;users&quot;</span>&gt;</span><br>        select <span class="hljs-tag">&lt;<span class="hljs-name">include</span> <span class="hljs-attr">refid</span>=<span class="hljs-string">&quot;allColumns&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">include</span>&gt;</span><br>        from users<br>        where birthday between #&#123;arg0&#125; and #&#123;arg1&#125;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br></code></pre></td></tr></table></figure>



<h2 id="Param指定参数名称"><a href="#Param指定参数名称" class="headerlink" title="@Param指定参数名称"></a>@Param指定参数名称</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--</span><br><span class="hljs-comment">        List&lt;Users&gt; getByColunm(@Param(&quot;columnName&quot;) String columnName,</span><br><span class="hljs-comment">                             	@Param(&quot;columnValue&quot;) String columnValue);</span><br><span class="hljs-comment">--&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getByColunm&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;users&quot;</span>&gt;</span><br>    select <span class="hljs-tag">&lt;<span class="hljs-name">include</span> <span class="hljs-attr">refid</span>=<span class="hljs-string">&quot;columns&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">include</span>&gt;</span><br>    from users<br>    where $&#123;columnName&#125; =#&#123;columnValue&#125;<br><span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br></code></pre></td></tr></table></figure>



<h1 id="入参是map"><a href="#入参是map" class="headerlink" title="入参是map"></a>入参是map</h1><h2 id="使用场景-1"><a href="#使用场景-1" class="headerlink" title="使用场景"></a>使用场景</h2><p>入参是map,是因为当传递的数据有多个,不适合使用指定下标或指定名称的方式来进行传参【使用下标的方式是语义不明；使用指定名称的方式比较麻烦，每个参数都要加注解】</p>
<p>又加上参数不一定与对象的成员变量一致,考虑使用map集合来进行传递</p>
<p>map使用的是键值对的方式.当在sql语句中使用的时候**#{键名},${键名}**,用的是键的名称.</p>
<p>  <strong>如果入参超过一个以上,使用map封装查询条件,更有语义,查询条件更明确.</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testGetUsersByDate</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> ParseException &#123;<br>    <span class="hljs-type">SimpleDateFormat</span> <span class="hljs-variable">sdf</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SimpleDateFormat</span>(<span class="hljs-string">&quot;yyyy-MM-dd&quot;</span>);<br>    <span class="hljs-type">Date</span> <span class="hljs-variable">begin</span> <span class="hljs-operator">=</span> sdf.parse(<span class="hljs-string">&quot;2000-01-01&quot;</span>);<br>    <span class="hljs-type">Date</span> <span class="hljs-variable">end</span> <span class="hljs-operator">=</span> sdf.parse(<span class="hljs-string">&quot;2010-01-01&quot;</span>);<br>    HashMap&lt;String, Date&gt; map = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();<br>    map.put(<span class="hljs-string">&quot;begin&quot;</span>, begin);<br>    map.put(<span class="hljs-string">&quot;end&quot;</span>, end);<br>    List&lt;Users&gt; users = mapper.getUsersByDates(map);<br>    users.forEach(System.out::println);<br>&#125;<br></code></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getUsersByDates&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;users&quot;</span>&gt;</span><br>    select<br>    <span class="hljs-tag">&lt;<span class="hljs-name">include</span> <span class="hljs-attr">refid</span>=<span class="hljs-string">&quot;allColumns&quot;</span>/&gt;</span><br>    from users<br>    where birthday between #&#123;begin&#125; and #&#123;end&#125;<br><span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br></code></pre></td></tr></table></figure>



<h1 id="返回值是map"><a href="#返回值是map" class="headerlink" title="返回值是map"></a>返回值是map</h1><h2 id="使用场景-2"><a href="#使用场景-2" class="headerlink" title="使用场景"></a><strong>使用场景</strong></h2><p>返回值是map的适用场景,如果数据不能使用对象来进行封装,可能查询的数据来自多张表中的某些列</p>
<p>这种情况下,使用map,但是map的返回方式破坏了对象的封装,返回来的数据是一个一个单独的数据, 之间不相关</p>
<p><strong>map使用表中的列名或别名做为键名进行返回数据.</strong></p>
<h2 id="map封装返回值是一行"><a href="#map封装返回值是一行" class="headerlink" title="map封装返回值是一行"></a><strong>map封装返回值是一行</strong></h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;GetOneMap&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;map&quot;</span>&gt;</span><br>    select username, address<br>    from users<br>    where id = #&#123;id&#125;<br><span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br></code></pre></td></tr></table></figure>



<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testGetReturnMapOne</span><span class="hljs-params">()</span>&#123;<br>    Map&lt;String,Object&gt; map = mapper.GetOneMap(<span class="hljs-number">7</span>);<br>    System.out.println(map);<br>    System.out.println(map.get(<span class="hljs-string">&quot;username&quot;</span>));<br>&#125;<br></code></pre></td></tr></table></figure>



<h2 id="返回值是map多行"><a href="#返回值是map多行" class="headerlink" title="返回值是map多行"></a><strong>返回值是map多行</strong></h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml">   <span class="hljs-comment">&lt;!--这里resultType是泛型--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getMaps&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;map&quot;</span>&gt;</span><br>       select username, address<br>       from users<br>   <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br></code></pre></td></tr></table></figure>



<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testGetReturnMap</span><span class="hljs-params">()</span>&#123;<br>    List&lt;Map&lt;String,Object&gt;&gt; list = mapper.getMaps();<br>    list.forEach(map-&gt; System.out.println(map));<br>&#125;<br></code></pre></td></tr></table></figure>



<h1 id="列名与类中成员变量名称不一致"><a href="#列名与类中成员变量名称不一致" class="headerlink" title="列名与类中成员变量名称不一致"></a>列名与类中成员变量名称不一致</h1><h2 id="解决方案一"><a href="#解决方案一" class="headerlink" title="解决方案一"></a>解决方案一</h2><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">使用列的别名，别名与类中的成员变量名一样，即可完成注入<br></code></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getAll&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;book&quot;</span>&gt;</span><br>    select bookid id,bookname name<br>    from book<br><span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br></code></pre></td></tr></table></figure>





<h2 id="解决方案二"><a href="#解决方案二" class="headerlink" title="解决方案二"></a>解决方案二</h2><p>使用&lt;resultMap&gt;标签进行映射</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getAllBook&quot;</span> <span class="hljs-attr">resultMap</span>=<span class="hljs-string">&quot;bookmap&quot;</span>&gt;</span><br>    select bookid, bookname<br>    from book<br><span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">resultMap</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;bookmap&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;book&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">id</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;id&quot;</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;bookid&quot;</span>/&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">id</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;name&quot;</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;bookname&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">resultMap</span>&gt;</span><br></code></pre></td></tr></table></figure>



<h1 id="五、表的关联关系"><a href="#五、表的关联关系" class="headerlink" title="五、表的关联关系"></a>五、表的关联关系</h1><h2 id="1-0-概念-1"><a href="#1-0-概念-1" class="headerlink" title="1.0 概念"></a>1.0 概念</h2><p>我们通常说的关联关系有以下四种，一对多关联，多对一关联，一对一关联，多对多关联。关联关系是有方向的</p>
<p><strong>如果是高并发的场景中，不适合做表的关联</strong></p>
<p><strong>关联关系是有方向的.</strong></p>
<p>​	  1)一对多关联:一个老师可以教多个学生,多个学生只有一个老师来教,<strong>站在老师方,就是一对多关联.</strong></p>
<p>​	  2)多对一关联:一个老师可以教多个学生,多个学生只有一个老师来教,<strong>站在学生方,就是多对一关联.</strong></p>
<p>​	  3)一对一关联:一个学生对应一个学号，一个学号对应一个学生</p>
<pre><code class="hljs"> 4)多对多关联:一个学生可以选多门课，一门课可以被多个学生选
</code></pre>
<h1 id="多对一关联"><a href="#多对一关联" class="headerlink" title="多对一关联"></a>多对一关联</h1><p>在多对一关联关系中，多方(订单)中持有一方(客户)的对象，要使用标签&lt;association&gt;标签来映射一方的属性。</p>
<p><strong>&lt;association&gt;在&lt;resultMap&gt;标签中使用 使用javaType指定实体类的类型</strong></p>
<p>一个客户有多张订单 一张订单对应一个客户</p>
<p>实体类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Customer</span> &#123;<br>    <span class="hljs-keyword">private</span> Integer id;<br>    <span class="hljs-keyword">private</span> String name;<br>    <span class="hljs-keyword">private</span> Integer age;<br>    <span class="hljs-keyword">private</span> List&lt;Order&gt; orders;<br>&#125;<br></code></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Order</span> &#123;<br>    <span class="hljs-keyword">private</span> Integer id;<br>    <span class="hljs-keyword">private</span> String orderNumber;<br>    <span class="hljs-keyword">private</span> Double orderPrice;<br>    <span class="hljs-keyword">private</span> Customer customer;<br>&#125;<br></code></pre></td></tr></table></figure>



<p>mapper</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs xml"> <span class="hljs-tag">&lt;<span class="hljs-name">resultMap</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;orderMap&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;order&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">id</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;id&quot;</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;oid&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;orderNumber&quot;</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;orderNumber&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;orderPrice&quot;</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;orderPrice&quot;</span>/&gt;</span><br>     <br>       <span class="hljs-comment">&lt;!--association 是多对一 --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">association</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;customer&quot;</span> <span class="hljs-attr">javaType</span>=<span class="hljs-string">&quot;customer&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">id</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;id&quot;</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;cid&quot;</span>/&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;name&quot;</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;name&quot;</span>/&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;age&quot;</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;age&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">association</span>&gt;</span><br>     <br><span class="hljs-tag">&lt;/<span class="hljs-name">resultMap</span>&gt;</span><br><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getOrderById&quot;</span> <span class="hljs-attr">resultMap</span>=<span class="hljs-string">&quot;orderMap&quot;</span>&gt;</span><br>        select c.id cid, c.name, c.age, o.id oid, o.orderNumber, o.orderPrice<br>        from orders o<br>                 inner join customer c on o.customer_id = c.id<br>        where o.id = #&#123;oid&#125;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br></code></pre></td></tr></table></figure>

<h1 id="一对多关联"><a href="#一对多关联" class="headerlink" title="一对多关联"></a>一对多关联</h1><p><strong>某方持有一方集合</strong></p>
<p>在一对多关联关系中，一方(客户)中有多方(订单)的集合 ，所以要使用&lt;collection&gt;标签来映射多方的属性</p>
<p><strong>&lt;collection&gt;在&lt;resultMap&gt;标签中使用   ； 使用ofType指定实体类的类型</strong></p>
<p>实体类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Customer</span> &#123;<br>    <span class="hljs-keyword">private</span> Integer id;<br>    <span class="hljs-keyword">private</span> String name;<br>    <span class="hljs-keyword">private</span> Integer age;<br>    <span class="hljs-keyword">private</span> List&lt;Order&gt; orders;<br>&#125;<br></code></pre></td></tr></table></figure>



<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Order</span> &#123;<br>    <span class="hljs-keyword">private</span> Integer id;<br>    <span class="hljs-keyword">private</span> String orderNumber;<br>    <span class="hljs-keyword">private</span> Double orderPrice;<br>    <span class="hljs-keyword">private</span> Customer customer;<br>&#125;<br></code></pre></td></tr></table></figure>



<p>mapper</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">resultMap</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;customermap&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;customer&quot;</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">id</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;id&quot;</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;cid&quot;</span>/&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;name&quot;</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;name&quot;</span>/&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;age&quot;</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;age&quot;</span>/&gt;</span><br>       <br>       <span class="hljs-comment">&lt;!--collection 是一对多 --&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">collection</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;orders&quot;</span> <span class="hljs-attr">ofType</span>=<span class="hljs-string">&quot;order&quot;</span>&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">id</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;id&quot;</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;oid&quot;</span>/&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;orderNumber&quot;</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;orderNumber&quot;</span>/&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;orderPrice&quot;</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;orderPrice&quot;</span>/&gt;</span><br>       <span class="hljs-tag">&lt;/<span class="hljs-name">collection</span>&gt;</span><br>       <br>   <span class="hljs-tag">&lt;/<span class="hljs-name">resultMap</span>&gt;</span><br><br><br>   <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getCustomerById&quot;</span> <span class="hljs-attr">resultMap</span>=<span class="hljs-string">&quot;customermap&quot;</span>&gt;</span><br>       select c.id cid, c.name, c.age, o.id oid, o.orderNumber, o.orderPrice<br>       from customer c<br>                left join orders o on c.id = o.customer_id<br>       where c.id = #&#123;id&#125;<br>   <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br></code></pre></td></tr></table></figure>

<h1 id="一对一关联"><a href="#一对一关联" class="headerlink" title="一对一关联"></a>一对一关联</h1><p><strong>某方持有一方对象</strong></p>
<p>实体类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Classes</span> &#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> cid;<br>    <span class="hljs-keyword">private</span> String cname;<br>    <span class="hljs-keyword">private</span> Teacher teacher；<br>&#125; <br></code></pre></td></tr></table></figure>



<p>mapper</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">resultMap</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;classesmap&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;classes&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">id</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;cid&quot;</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;cid&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">id</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;cname&quot;</span> <span class="hljs-attr">column</span>= <span class="hljs-string">&quot;cname &quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">result</span>&gt;</span><br>    <br>    <span class="hljs-tag">&lt;<span class="hljs-name">association</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;teacher&quot;</span> <span class="hljs-attr">javaType</span>=<span class="hljs-string">&quot;teacher&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">id</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;tid&quot;</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;tid&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">id</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;tname&quot;</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;tname&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">result</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;age&quot;</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;tage&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">result</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">association</span>&gt;</span><br>    <br><span class="hljs-tag">&lt;/<span class="hljs-name">resultMap</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;findById&quot;</span> <span class="hljs-attr">parameterType</span>=<span class="hljs-string">&quot;int&quot;</span> <span class="hljs-attr">resultMap</span>=<span class="hljs-string">&quot;classesmap&quot;</span>&gt;</span><br>    select c.*,t.* <br>    from classes c, teacher t <br>    where c.ctid=t.tid and c.cid=#&#123;cid&#125;<br><span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br></code></pre></td></tr></table></figure>



<h1 id="多对多关联"><a href="#多对多关联" class="headerlink" title="多对多关联"></a>多对多关联</h1><p>多对多关联中，需要通过中间表化解关联关系。</p>
<p>中间表描述两张主键表的关联。</p>
<p><strong>中间表没有对应的实体类</strong>。但有表</p>
<p>Mapper.xml文件中也没有中间表的对应标签描述，只是在查询语句中使用中间表来进行关联 </p>
<p>一本书有多个分类，一个分类有多本书</p>
<ul>
<li>实体类</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Book</span> &#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> bid;<br>    <span class="hljs-keyword">private</span> String bname;<br>    <span class="hljs-comment">//目的:就是在查询图书时,将图书所属的类型全部取出来</span><br>    <span class="hljs-keyword">private</span> List&lt;category&gt; categoryList=<span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>mapper</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">resultMap</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;bookmap&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;book&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">id</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;bid&quot;</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;bid&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">id</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;bname&quot;</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;bname&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">result</span>&gt;</span><br>    <br>    <span class="hljs-tag">&lt;<span class="hljs-name">collection</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;categoryList&quot;</span> <span class="hljs-attr">ofType</span>=<span class="hljs-string">&quot;category&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">id</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;cid&quot;</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;cid&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">id</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot; cname&quot;</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;cname &quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">result</span>&gt;</span> <br>        <br>    <span class="hljs-tag">&lt;/<span class="hljs-name">collection</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">resultMap</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;findALL&quot;</span> <span class="hljs-attr">resultMap</span>=<span class="hljs-string">&quot;bookmap&quot;</span>&gt;</span><br>select * <br>    from book b inner join middle m <br>    	on b.bid = m.m_bid <br>    inner join category c <br>    	on m.m_cid = c.cid<br><span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br></code></pre></td></tr></table></figure>



<ul>
<li>book</li>
</ul>
<hr>
<p><img src="https://cdn.jsdelivr.net/gh/fgcy-333/gitnote-images/2022/8/27202208261727356.png" srcset="/img/loading.gif" lazyload></p>
<hr>
<ul>
<li>category</li>
</ul>
<hr>
<p><img src="https://cdn.jsdelivr.net/gh/fgcy-333/gitnote-images/2022/8/27202208261727947.png" srcset="/img/loading.gif" lazyload></p>
<hr>
<ul>
<li>中间表(关联表)</li>
</ul>
<hr>
<p><img src="https://cdn.jsdelivr.net/gh/fgcy-333/gitnote-images/2022/8/27202208261727510.png" srcset="/img/loading.gif" lazyload></p>
<hr>
<ul>
<li>查询结果</li>
</ul>
<hr>
<p><img src="https://cdn.jsdelivr.net/gh/fgcy-333/gitnote-images/2022/8/27202208261727015.png" srcset="/img/loading.gif" lazyload></p>
<hr>
<p>因为book表和category表中都没有存储外键关联其他表，所以只能借助中间表进行关联查询</p>
<h1 id="嵌套查询"><a href="#嵌套查询" class="headerlink" title="嵌套查询"></a>嵌套查询</h1><ul>
<li>mapper1</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs xml">    <span class="hljs-tag">&lt;<span class="hljs-name">resultMap</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;customermap2&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;customer&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">id</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;id&quot;</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;id&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;name&quot;</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;name&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;age&quot;</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;age&quot;</span>/&gt;</span><br>        <br>    <span class="hljs-comment">&lt;!--</span><br><span class="hljs-comment">		property=“ordersList”表示的是实体类customer的属性ordersList</span><br><span class="hljs-comment">		ofType=&quot;orders&quot;表示的是集合中的泛型是Order类型</span><br><span class="hljs-comment">		column=&quot;id&quot;表示的是关联列，该值由使用该resultMap的select语句中提供</span><br><span class="hljs-comment">		select=&quot;selectordersByCustomerId&quot;代表执行的是哪一个mapper下的select语句</span><br><span class="hljs-comment">	--&gt;</span><br>   <br>    <span class="hljs-comment">&lt;!--column:是当前客户表的id,传给嵌套查询作为入参进行查询返回该客户名下的所有订单集合--&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">collection</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;orders&quot;</span> <span class="hljs-attr">ofType</span>=<span class="hljs-string">&quot;order&quot;</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;id&quot;</span></span><br><span class="hljs-tag">                    <span class="hljs-attr">select</span>=<span class="hljs-string">&quot;com.fgcy.mapper.OrderMapper.getOrdersByCustomerId&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">resultMap</span>&gt;</span> <br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getCustomerByIdPro&quot;</span> <span class="hljs-attr">resultMap</span>=<span class="hljs-string">&quot;customermap2&quot;</span>&gt;</span><br>        select id,name,age<br>        from customer<br>        where name like concat(&#x27;%&#x27;,#&#123;name&#125;,&#x27;%&#x27;)<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br></code></pre></td></tr></table></figure>

<ul>
<li>mapper2</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getOrdersByCustomerId&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;order&quot;</span>&gt;</span><br>    select id, orderNumber, orderPrice<br>    from orders<br>    where customer_id = #&#123;id&#125;<br><span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br></code></pre></td></tr></table></figure>



<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>无论是什么关联关系，如果某方持有另一方的<strong>集合</strong>，则使用&lt;collection&gt;标签完成映射  <strong>使用 ofType指定泛型类型</strong></p>
<p>如果某方持有另一方的<strong>对象</strong>，则使用&lt;association&gt;标签完成映射。 <strong>使用javaType指定对象类型</strong></p>
<h1 id="六、事务"><a href="#六、事务" class="headerlink" title="六、事务"></a>六、事务</h1><h2 id="1-0-什么是事务"><a href="#1-0-什么是事务" class="headerlink" title="1.0 什么是事务"></a>1.0 什么是事务</h2><p>一个完整的逻辑单元，不可再分；</p>
<p>多个操作同时完成,或同时失败称为事务处理.</p>
<p>事务有四个特性:一致性,持久性,原子性,隔离性.</p>
<h2 id="2-0-Mybatis中事务"><a href="#2-0-Mybatis中事务" class="headerlink" title="2.0 Mybatis中事务"></a>2.0 Mybatis中事务</h2><p>在事务管理器中设置</p>
<p>Mybatis 框架是对 JDBC 的封装，所以 Mybatis 框架的事务控制方式有两种</p>
<p>一种是容器进行事务管理的【MANAGED】，一种是程序员手工决定事务的提交与回滚【JDBC】</p>
<p>在MyBatis框架中设置事务</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">transactionManager</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;JDBC&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">transactionManager</span>&gt;</span>  ===&gt;程序员自己控制处理的提交和回滚<br></code></pre></td></tr></table></figure>



<p>  可设置为自动提交</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">sqlSession = factory.openSession();  ===&gt;默认是手工提交事务,设置为<span class="hljs-literal">false</span>也是手工提交事务,如果设置为<span class="hljs-literal">true</span>,则为自动提交.<br>sqlSession = factory.openSession(<span class="hljs-literal">true</span>);  ===&gt;设置为自动提交,在增删改后不需要commit();<br></code></pre></td></tr></table></figure>



<hr>
<p><img src="https://cdn.jsdelivr.net/gh/fgcy-333/gitnote-images/2022/8/27202208261727376.png" srcset="/img/loading.gif" lazyload alt="image-20220513161716308"></p>
<hr>
<p>Connection 对象的 setAutoCommit()方法来设置事务提交方式的。自动提交和手工提交。&lt;transactionManager&gt;标签用于指定MyBatis 所使用的事务管理器。</p>
<p>MyBatis 支持两种事务管理器类型：JDBC、MANAGED</p>
<p>JDBC：使用 JDBC 的事务管理机制。即，通过 Connection 的 commit()方法提交，通过 rollback()方法回滚。</p>
<p>但默认情况下，MyBatis 将自动提交功能关闭了，改为了手动提交。即程序中需要显式的对事务进行提交或回滚。从日志的输出信息中可以看到。</p>
<p>MANAGED：由容器管理</p>
<p><strong>所以：切记切记进行完增删改后一定要sqlSession.commit();</strong></p>
<p>在获得SqlSession的时候,如果openSession()是无参或者是false,则必须手工提交事务</p>
<p>如果openSession(true),则为自动提交事务，在执行完增删改后无须commit(),事务自动提交。</p>
<p>session &#x3D; factory.openSession(true);</p>
<h1 id="七、缓存"><a href="#七、缓存" class="headerlink" title="七、缓存"></a>七、缓存</h1><h2 id="1-0-缓存概念"><a href="#1-0-缓存概念" class="headerlink" title="1.0 缓存概念"></a>1.0 缓存概念</h2><p>将用户经常查询的数据放在缓存（内存）中，用户去查询数据就不用从磁盘上(关系型数据库数据文件)查询</p>
<p>从缓存中查询，从而提高查询效率，解决了高并发系统的性能问题</p>
<p>mybatis提供查询缓存，用于减轻数据库压力，提高数据库性能</p>
<h1 id="缓存执行机制"><a href="#缓存执行机制" class="headerlink" title="缓存执行机制"></a>缓存执行机制</h1><p>MyBatis框架提供两级缓存,一级缓存和二级缓存.默认开启一级缓存</p>
<p>缓存就是为了提交查询效率</p>
<h2 id="使用mybatis查询数据的执行流程"><a href="#使用mybatis查询数据的执行流程" class="headerlink" title="使用mybatis查询数据的执行流程"></a>使用mybatis查询数据的执行流程</h2><hr>
<p><img src="https://cdn.jsdelivr.net/gh/fgcy-333/gitnote-images/2022/8/27202208261727327.png" srcset="/img/loading.gif" lazyload></p>
<hr>
<p>在进行数据库访问时，首先去访问缓存，如果缓存中有要访问的数据，则直接返回客户端；</p>
<p>如果没有则去访问数据库，在库中得到数据后，先在缓存放一份，再从缓存中返回客户端；</p>
<p>当数据库发生commit操作时，清空缓存</p>
<h2 id="一级缓存与二级缓存的作用范围"><a href="#一级缓存与二级缓存的作用范围" class="headerlink" title="一级缓存与二级缓存的作用范围"></a>一级缓存与二级缓存的作用范围</h2><hr>
<p><img src="https://cdn.jsdelivr.net/gh/fgcy-333/gitnote-images/2022/8/27202208261727546.png" srcset="/img/loading.gif" lazyload></p>
<hr>
<h1 id="一级缓存"><a href="#一级缓存" class="headerlink" title="一级缓存"></a>一级缓存</h1><h2 id="使用一级缓存查询数据执行流程"><a href="#使用一级缓存查询数据执行流程" class="headerlink" title="使用一级缓存查询数据执行流程"></a>使用一级缓存查询数据执行流程</h2><p>第一次发起查询用户id为1的用户信息，先去找缓存中是否有id为1的用户信息，如果没有，从数据库查询用户信息。</p>
<p>得到用户信息，将用户信息存储到一级缓存中。然后从缓存中返回；</p>
<p>如果sqlSession去执行commit操作（执行插入、更新、删除），则清空SqlSession中的一级缓存，这样做的目的为了让缓存中存储的是最新的信息，避免脏读。</p>
<p>第二次发起查询用户id为1的用户信息，先去找缓存中是否有id为1的用户信息，缓存中有，直接从缓存中获取用户信息。如果没有重复第一次查询操作</p>
<hr>
<p><img src="https://cdn.jsdelivr.net/gh/fgcy-333/gitnote-images/2022/8/27202208261727686.png" srcset="/img/loading.gif" lazyload></p>
<hr>
<h2 id="一级缓存验证-1"><a href="#一级缓存验证-1" class="headerlink" title="一级缓存验证(1)"></a>一级缓存验证(1)</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyTe</span> &#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> SqlSession sqlSession;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> UsersMapper mapper;<br><br>    <span class="hljs-meta">@BeforeClass</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">openSession</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-keyword">final</span> <span class="hljs-type">InputStream</span> <span class="hljs-variable">is</span> <span class="hljs-operator">=</span> Resources.getResourceAsStream(<span class="hljs-string">&quot;SqlMapConfig.xml&quot;</span>);<br>            <span class="hljs-type">SqlSessionFactory</span> <span class="hljs-variable">sessionFactory</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SqlSessionFactoryBuilder</span>().build(is);<br>            sqlSession = sessionFactory.openSession();<br>            mapper = sqlSession.getMapper(UsersMapper.class);<br><br>        &#125; <span class="hljs-keyword">catch</span> (IOException e) &#123;<br>            e.printStackTrace();<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-meta">@AfterClass</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">closeSession</span><span class="hljs-params">()</span> &#123;<br>        sqlSession.close();<br>    &#125;<br><br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">test2</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;FOR ONE&quot;</span>);<br>        mapper.findAll().forEach(System.out::println);<br>        System.out.println(<span class="hljs-string">&quot;---------------------------------&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span>  <span class="hljs-keyword">void</span> <span class="hljs-title function_">test1</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;FOR TWO&quot;</span>);<br>        mapper.findAll().forEach(System.out::println);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>结果1</li>
</ul>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs routeros">Created<span class="hljs-built_in"> connection </span>215219944.<br>Setting autocommit <span class="hljs-keyword">to</span> <span class="hljs-literal">false</span> on JDBC<span class="hljs-built_in"> Connection </span>[com.mysql.jdbc.JDBC4Connection@cd3fee8]<br>==&gt;  Preparing: select id, username, birthday, sex,<span class="hljs-built_in"> address </span><span class="hljs-keyword">from</span><span class="hljs-built_in"> users</span><br><span class="hljs-built_in"></span>==&gt; Parameters: <br>&lt;==    Columns: id, username, birthday, sex,<span class="hljs-built_in"> address</span><br><span class="hljs-built_in"></span>&lt;==        Row: 2, 张三, 2001-07-12, 1, 北京市<br>&lt;==        Row: 3, 张小明, 1999-02-22, 1, 河南<br>&lt;==      Total: 9<br>Users&#123;<span class="hljs-attribute">id</span>=2, <span class="hljs-attribute">username</span>=<span class="hljs-string">&#x27;张三&#x27;</span>, <span class="hljs-attribute">birthDate</span>=<span class="hljs-literal">null</span>, <span class="hljs-attribute">sex</span>=1, <span class="hljs-attribute">address</span>=<span class="hljs-string">&#x27;北京市&#x27;</span>&#125;<br>Users&#123;<span class="hljs-attribute">id</span>=3, <span class="hljs-attribute">username</span>=<span class="hljs-string">&#x27;张小明&#x27;</span>, <span class="hljs-attribute">birthDate</span>=<span class="hljs-literal">null</span>, <span class="hljs-attribute">sex</span>=1, <span class="hljs-attribute">address</span>=<span class="hljs-string">&#x27;河南&#x27;</span>&#125;<br><span class="hljs-keyword">FOR</span> ONE<br>Users&#123;<span class="hljs-attribute">id</span>=2, <span class="hljs-attribute">username</span>=<span class="hljs-string">&#x27;张三&#x27;</span>, <span class="hljs-attribute">birthDate</span>=<span class="hljs-literal">null</span>, <span class="hljs-attribute">sex</span>=1, <span class="hljs-attribute">address</span>=<span class="hljs-string">&#x27;北京市&#x27;</span>&#125;<br>Users&#123;<span class="hljs-attribute">id</span>=3, <span class="hljs-attribute">username</span>=<span class="hljs-string">&#x27;张小明&#x27;</span>, <span class="hljs-attribute">birthDate</span>=<span class="hljs-literal">null</span>, <span class="hljs-attribute">sex</span>=1, <span class="hljs-attribute">address</span>=<span class="hljs-string">&#x27;河南&#x27;</span>&#125;<br>---------------------------------<br>Resetting autocommit <span class="hljs-keyword">to</span> <span class="hljs-literal">true</span> on JDBC<span class="hljs-built_in"> Connection </span>[com.mysql.jdbc.JDBC4Connection@cd3fee8]<br>Closing JDBC<span class="hljs-built_in"> Connection </span>[com.mysql.jdbc.JDBC4Connection@cd3fee8]<br>Returned<span class="hljs-built_in"> connection </span>215219944 <span class="hljs-keyword">to</span> pool.<br></code></pre></td></tr></table></figure>



<ul>
<li>验证2</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyTe</span> &#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> SqlSession sqlSession;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> UsersMapper mapper;<br><br>    <span class="hljs-meta">@BeforeClass</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">openSession</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-keyword">final</span> <span class="hljs-type">InputStream</span> <span class="hljs-variable">is</span> <span class="hljs-operator">=</span> Resources.getResourceAsStream(<span class="hljs-string">&quot;SqlMapConfig.xml&quot;</span>);<br>            <span class="hljs-type">SqlSessionFactory</span> <span class="hljs-variable">sessionFactory</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SqlSessionFactoryBuilder</span>().build(is);<br>            sqlSession = sessionFactory.openSession();<br>            mapper = sqlSession.getMapper(UsersMapper.class);<br><br>        &#125; <span class="hljs-keyword">catch</span> (IOException e) &#123;<br>            e.printStackTrace();<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-meta">@AfterClass</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">closeSession</span><span class="hljs-params">()</span> &#123;<br>        sqlSession.close();<br>    &#125;<br><br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">test1</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;FOR ONE&quot;</span>);<br>        mapper.findAll().forEach(System.out::println);<br>        System.out.println(<span class="hljs-string">&quot;---------------------------------&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">test2</span><span class="hljs-params">()</span> &#123;<br>        mapper.addUser(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Users</span>(<span class="hljs-string">&quot;fff&quot;</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(), <span class="hljs-number">1</span>, <span class="hljs-string">&quot;aaa&quot;</span>));<br>        sqlSession.commit();<br>    &#125;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">test3</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;FOR TWO&quot;</span>);<br>        mapper.findAll().forEach(System.out::println);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>结果2</li>
</ul>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs routeros">Created<span class="hljs-built_in"> connection </span>215219944.<br>Setting autocommit <span class="hljs-keyword">to</span> <span class="hljs-literal">false</span> on JDBC<span class="hljs-built_in"> Connection </span>[com.mysql.jdbc.JDBC4Connection@cd3fee8]<br>==&gt;  Preparing: select id, username, birthday, sex,<span class="hljs-built_in"> address </span><span class="hljs-keyword">from</span><span class="hljs-built_in"> users</span><br><span class="hljs-built_in"></span>==&gt; Parameters: <br>&lt;==    Columns: id, username, birthday, sex,<span class="hljs-built_in"> address</span><br><span class="hljs-built_in"></span>&lt;==        Row: 2, 张三, 2001-07-12, 1, 北京市<br>&lt;==        Row: 3, 张小明, 1999-02-22, 1, 河南<br>&lt;==      Total: 9<br>Users&#123;<span class="hljs-attribute">id</span>=2, <span class="hljs-attribute">username</span>=<span class="hljs-string">&#x27;张三&#x27;</span>, <span class="hljs-attribute">birthDate</span>=<span class="hljs-literal">null</span>, <span class="hljs-attribute">sex</span>=1, <span class="hljs-attribute">address</span>=<span class="hljs-string">&#x27;北京市&#x27;</span>&#125;<br>Users&#123;<span class="hljs-attribute">id</span>=3, <span class="hljs-attribute">username</span>=<span class="hljs-string">&#x27;张小明&#x27;</span>, <span class="hljs-attribute">birthDate</span>=<span class="hljs-literal">null</span>, <span class="hljs-attribute">sex</span>=1, <span class="hljs-attribute">address</span>=<span class="hljs-string">&#x27;河南&#x27;</span>&#125;<br>---------------------------------<br>==&gt;  Preparing: insert into<span class="hljs-built_in"> users </span>(id,username, birthday, sex, address) values (?,?, ?, ?, ?)<br>==&gt; Parameters: <span class="hljs-literal">null</span>, fff(String), 2022-04-17 16:10:52.569(Timestamp), 1(Integer), aaa(String)<br>&lt;==    Updates: 1<br>==&gt;  Preparing: select last_insert_id()<br>==&gt; Parameters: <br>&lt;==    Columns: last_insert_id()<br>&lt;==        Row: 17<br>&lt;==      Total: 1<br>Committing JDBC<span class="hljs-built_in"> Connection </span>[com.mysql.jdbc.JDBC4Connection@cd3fee8]<br><span class="hljs-keyword">FOR</span> TWO<br>==&gt;  Preparing: select id, username, birthday, sex,<span class="hljs-built_in"> address </span><span class="hljs-keyword">from</span><span class="hljs-built_in"> users</span><br><span class="hljs-built_in"></span>==&gt; Parameters: <br>&lt;==    Columns: id, username, birthday, sex,<span class="hljs-built_in"> address</span><br><span class="hljs-built_in"></span>&lt;==        Row: 2, 张三, 2001-07-12, 1, 北京市<br>&lt;==        Row: 3, 张小明, 1999-02-22, 1, 河南<br>&lt;==      Total: 10<br>Users&#123;<span class="hljs-attribute">id</span>=2, <span class="hljs-attribute">username</span>=<span class="hljs-string">&#x27;张三&#x27;</span>, <span class="hljs-attribute">birthDate</span>=<span class="hljs-literal">null</span>, <span class="hljs-attribute">sex</span>=1, <span class="hljs-attribute">address</span>=<span class="hljs-string">&#x27;北京市&#x27;</span>&#125;<br>Users&#123;<span class="hljs-attribute">id</span>=3, <span class="hljs-attribute">username</span>=<span class="hljs-string">&#x27;张小明&#x27;</span>, <span class="hljs-attribute">birthDate</span>=<span class="hljs-literal">null</span>, <span class="hljs-attribute">sex</span>=1, <span class="hljs-attribute">address</span>=<span class="hljs-string">&#x27;河南&#x27;</span>&#125;<br>Users&#123;<span class="hljs-attribute">id</span>=17, <span class="hljs-attribute">username</span>=<span class="hljs-string">&#x27;fff&#x27;</span>, <span class="hljs-attribute">birthDate</span>=<span class="hljs-literal">null</span>, <span class="hljs-attribute">sex</span>=1, <span class="hljs-attribute">address</span>=<span class="hljs-string">&#x27;aaa&#x27;</span>&#125;<br>Resetting autocommit <span class="hljs-keyword">to</span> <span class="hljs-literal">true</span> on JDBC<span class="hljs-built_in"> Connection </span>[com.mysql.jdbc.JDBC4Connection@cd3fee8]<br>Closing JDBC<span class="hljs-built_in"> Connection </span>[com.mysql.jdbc.JDBC4Connection@cd3fee8]<br>Returned<span class="hljs-built_in"> connection </span>215219944 <span class="hljs-keyword">to</span> pool.<br></code></pre></td></tr></table></figure>



<h1 id="二级缓存"><a href="#二级缓存" class="headerlink" title="二级缓存"></a>二级缓存</h1><p>Mybatis默认开启一级缓存，但二级缓存不是；</p>
<p>mybaits的二级缓存是mapper范围级别，一级缓存是sqlSession级别</p>
<h2 id="实现步骤"><a href="#实现步骤" class="headerlink" title="实现步骤"></a>实现步骤</h2><ul>
<li><p>除了在SqlMapConfig.xml设置二级缓存的总开关</p>
</li>
<li><p>还要在具体的mapper.xml中开启二级缓存</p>
</li>
<li><p>并且要让实体类实现serializable接口</p>
</li>
</ul>
<h3 id="1-在核心配置文件加入设置"><a href="#1-在核心配置文件加入设置" class="headerlink" title="1 在核心配置文件加入设置"></a>1 在核心配置文件加入设置</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">settings</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">setting</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;cacheEnabled&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;true&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">settings</span>&gt;</span><br></code></pre></td></tr></table></figure>



<h3 id="2-在mapper-xml文件中二启二级缓存，使用"><a href="#2-在mapper-xml文件中二启二级缓存，使用" class="headerlink" title="2 在mapper.xml文件中二启二级缓存，使用"></a>2 在mapper.xml文件中二启二级缓存，使用</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;xxxx.xxxx.xxxx&quot;</span>&gt;</span><br><span class="hljs-comment">&lt;!--&lt;cache&gt;&lt;/cache&gt;--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">cache</span>/&gt;</span><br>.......<br>......<br><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span><br></code></pre></td></tr></table></figure>



<h3 id="3-实体类必须实现java-io-serializable接口，保证实体可序列化"><a href="#3-实体类必须实现java-io-serializable接口，保证实体可序列化" class="headerlink" title="3 实体类必须实现java.io.serializable接口，保证实体可序列化"></a>3 实体类必须实现java.io.serializable接口，保证实体可序列化</h3><h2 id="验证1"><a href="#验证1" class="headerlink" title="验证1"></a>验证1</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TeMy</span> &#123;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">test1</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        <span class="hljs-keyword">final</span> <span class="hljs-type">InputStream</span> <span class="hljs-variable">is</span> <span class="hljs-operator">=</span> Resources.getResourceAsStream(<span class="hljs-string">&quot;SqlMapConfig.xml&quot;</span>);<br>        <span class="hljs-type">SqlSessionFactory</span> <span class="hljs-variable">sessionFactory</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SqlSessionFactoryBuilder</span>().build(is);<br>        <span class="hljs-type">SqlSession</span> <span class="hljs-variable">session1</span> <span class="hljs-operator">=</span> sessionFactory.openSession();<br>        <span class="hljs-type">SqlSession</span> <span class="hljs-variable">session2</span> <span class="hljs-operator">=</span> sessionFactory.openSession();<br>        <span class="hljs-type">SqlSession</span> <span class="hljs-variable">session3</span> <span class="hljs-operator">=</span> sessionFactory.openSession();<br>        <span class="hljs-type">UsersMapper</span> <span class="hljs-variable">mapper1</span> <span class="hljs-operator">=</span> session1.getMapper(UsersMapper.class);<br>        <span class="hljs-type">UsersMapper</span> <span class="hljs-variable">mapper2</span> <span class="hljs-operator">=</span> session2.getMapper(UsersMapper.class);<br>        <span class="hljs-type">UsersMapper</span> <span class="hljs-variable">mapper3</span> <span class="hljs-operator">=</span> session3.getMapper(UsersMapper.class);<br><br>        mapper1.findAll().forEach(System.out::println);<br>        session1.close();<br>        mapper3.findAll().forEach(System.out::println);<br>        session3.close();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>结果1</li>
</ul>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs n1ql">Created connection 1691185247.<br>Setting autocommit to false on JDBC Connection [com.mysql.jdbc.JDBC4Connection@64cd705f]<br>==&gt;  Preparing: <span class="hljs-keyword">select</span> id, username, birthday, sex, address <span class="hljs-keyword">from</span> users<br>==&gt; Parameters: <br>&lt;==    Columns: id, username, birthday, sex, address<br>&lt;==        Row: <span class="hljs-number">2</span>, 张三, <span class="hljs-number">2001</span><span class="hljs-number">-07</span><span class="hljs-number">-12</span>, <span class="hljs-number">1</span>, 北京市<br>&lt;==        Row: <span class="hljs-number">3</span>, 张小明, <span class="hljs-number">1999</span><span class="hljs-number">-02</span><span class="hljs-number">-22</span>, <span class="hljs-number">1</span>, 河南<br>&lt;==        Row: <span class="hljs-number">17</span>, fff, <span class="hljs-number">2022</span><span class="hljs-number">-04</span><span class="hljs-number">-17</span>, <span class="hljs-number">1</span>, aaa<br>&lt;==      Total: <span class="hljs-number">10</span><br>Users&#123;id=<span class="hljs-number">2</span>, username=<span class="hljs-string">&#x27;张三&#x27;</span>, birthDate=<span class="hljs-literal">null</span>, sex=<span class="hljs-number">1</span>, address=<span class="hljs-string">&#x27;北京市&#x27;</span>&#125;<br>Users&#123;id=<span class="hljs-number">3</span>, username=<span class="hljs-string">&#x27;张小明&#x27;</span>, birthDate=<span class="hljs-literal">null</span>, sex=<span class="hljs-number">1</span>, address=<span class="hljs-string">&#x27;河南&#x27;</span>&#125;<br>Resetting autocommit <span class="hljs-keyword">to</span> <span class="hljs-literal">true</span> <span class="hljs-keyword">on</span> JDBC Connection [com.mysql.jdbc.JDBC4Connection@<span class="hljs-number">64</span>cd705f]<br>Closing JDBC Connection [com.mysql.jdbc.JDBC4Connection@<span class="hljs-number">64</span>cd705f]<br>Returned connection <span class="hljs-number">1691185247</span> <span class="hljs-keyword">to</span> <span class="hljs-keyword">pool</span>.<br><span class="hljs-keyword">As</span> you are <span class="hljs-keyword">using</span> functionality that deserializes <span class="hljs-keyword">object</span> streams, it <span class="hljs-keyword">is</span> recommended <span class="hljs-keyword">to</span> define the JEP<span class="hljs-number">-290</span> serial filter. Please refer <span class="hljs-keyword">to</span> https://docs.oracle.com/pls/topic/lookup?ctx=javase15&amp;id=GUID<span class="hljs-number">-8296</span>D8E8<span class="hljs-number">-2</span>B93<span class="hljs-number">-4</span>B9A<span class="hljs-number">-856E-0</span>A65AF9B8C66<br>Cache Hit Ratio [com.fgcy.mapper.UsersMapper]: <span class="hljs-number">0.5</span><br>Users&#123;id=<span class="hljs-number">2</span>, username=<span class="hljs-string">&#x27;张三&#x27;</span>, birthDate=<span class="hljs-literal">null</span>, sex=<span class="hljs-number">1</span>, address=<span class="hljs-string">&#x27;北京市&#x27;</span>&#125;<br>Users&#123;id=<span class="hljs-number">3</span>, username=<span class="hljs-string">&#x27;张小明&#x27;</span>, birthDate=<span class="hljs-literal">null</span>, sex=<span class="hljs-number">1</span>, address=<span class="hljs-string">&#x27;河南&#x27;</span>&#125;<br></code></pre></td></tr></table></figure>



<ul>
<li>验证2</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TeMy</span> &#123;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">test1</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        <span class="hljs-keyword">final</span> <span class="hljs-type">InputStream</span> <span class="hljs-variable">is</span> <span class="hljs-operator">=</span> Resources.getResourceAsStream(<span class="hljs-string">&quot;SqlMapConfig.xml&quot;</span>);<br>        <span class="hljs-type">SqlSessionFactory</span> <span class="hljs-variable">sessionFactory</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SqlSessionFactoryBuilder</span>().build(is);<br>        <span class="hljs-type">SqlSession</span> <span class="hljs-variable">session1</span> <span class="hljs-operator">=</span> sessionFactory.openSession();<br>        <span class="hljs-type">SqlSession</span> <span class="hljs-variable">session2</span> <span class="hljs-operator">=</span> sessionFactory.openSession();<br>        <span class="hljs-type">SqlSession</span> <span class="hljs-variable">session3</span> <span class="hljs-operator">=</span> sessionFactory.openSession();<br>        <span class="hljs-type">UsersMapper</span> <span class="hljs-variable">mapper1</span> <span class="hljs-operator">=</span> session1.getMapper(UsersMapper.class);<br>        <span class="hljs-type">UsersMapper</span> <span class="hljs-variable">mapper2</span> <span class="hljs-operator">=</span> session2.getMapper(UsersMapper.class);<br>        <span class="hljs-type">UsersMapper</span> <span class="hljs-variable">mapper3</span> <span class="hljs-operator">=</span> session3.getMapper(UsersMapper.class);<br><br>        mapper1.findAll().forEach(System.out::println);<br>        session1.close();<br><br>        mapper2.addUser(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Users</span>(<span class="hljs-string">&quot;fff&quot;</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(), <span class="hljs-number">1</span>, <span class="hljs-string">&quot;aaa&quot;</span>));<br>        session2.commit();<br>        session2.close();<br><br>        mapper3.findAll().forEach(System.out::println);<br>        session3.close();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>结果</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs java">reated connection <span class="hljs-number">1691185247.</span><br>Setting autocommit to <span class="hljs-literal">false</span> on JDBC Connection [com.mysql.jdbc.JDBC4Connection@64cd705f]<br>==&gt;  Preparing: select id, username, birthday, sex, address from users<br>==&gt; Parameters: <br>&lt;==    Columns: id, username, birthday, sex, address<br>&lt;==        Row: <span class="hljs-number">2</span>, 张三, <span class="hljs-number">2001</span>-<span class="hljs-number">07</span>-<span class="hljs-number">12</span>, <span class="hljs-number">1</span>, 北京市<br>&lt;==        Row: <span class="hljs-number">3</span>, 张小明, <span class="hljs-number">1999</span>-<span class="hljs-number">02</span>-<span class="hljs-number">22</span>, <span class="hljs-number">1</span>, 河南<br>&lt;==      Total: <span class="hljs-number">10</span><br>Users&#123;id=<span class="hljs-number">2</span>, username=<span class="hljs-string">&#x27;张三&#x27;</span>, birthDate=<span class="hljs-literal">null</span>, sex=<span class="hljs-number">1</span>, address=<span class="hljs-string">&#x27;北京市&#x27;</span>&#125;<br>Users&#123;id=<span class="hljs-number">3</span>, username=<span class="hljs-string">&#x27;张小明&#x27;</span>, birthDate=<span class="hljs-literal">null</span>, sex=<span class="hljs-number">1</span>, address=<span class="hljs-string">&#x27;河南&#x27;</span>&#125;<br>Resetting autocommit to <span class="hljs-literal">true</span> on JDBC Connection [com.mysql.jdbc.JDBC4Connection@64cd705f]<br>Closing JDBC Connection [com.mysql.jdbc.JDBC4Connection@64cd705f]<br>Returned connection <span class="hljs-number">1691185247</span> to pool.<br>Opening JDBC Connection<br>Checked out connection <span class="hljs-number">1691185247</span> from pool.<br>Setting autocommit to <span class="hljs-literal">false</span> on JDBC Connection [com.mysql.jdbc.JDBC4Connection@64cd705f]<br>==&gt;  Preparing: insert into <span class="hljs-title function_">users</span> <span class="hljs-params">(id,username, birthday, sex, address)</span> values (?,?, ?, ?, ?)<br>==&gt; Parameters: <span class="hljs-literal">null</span>, fff(String), <span class="hljs-number">2022</span>-<span class="hljs-number">04</span>-<span class="hljs-number">17</span> <span class="hljs-number">16</span>:<span class="hljs-number">40</span>:<span class="hljs-number">34.247</span>(Timestamp), <span class="hljs-number">1</span>(Integer), aaa(String)<br>&lt;==    Updates: <span class="hljs-number">1</span><br>==&gt;  Preparing: select <span class="hljs-title function_">last_insert_id</span><span class="hljs-params">()</span><br>==&gt; Parameters: <br>&lt;==    Columns: last_insert_id()<br>&lt;==        Row: <span class="hljs-number">20</span><br>&lt;==      Total: <span class="hljs-number">1</span><br>Committing JDBC Connection [com.mysql.jdbc.JDBC4Connection@64cd705f]<br>Resetting autocommit to <span class="hljs-literal">true</span> on JDBC Connection [com.mysql.jdbc.JDBC4Connection@64cd705f]<br>Closing JDBC Connection [com.mysql.jdbc.JDBC4Connection@64cd705f]<br>Returned connection <span class="hljs-number">1691185247</span> to pool.<br>Cache Hit Ratio [com.fgcy.mapper.UsersMapper]: <span class="hljs-number">0.0</span><br>Opening JDBC Connection<br>Checked out connection <span class="hljs-number">1691185247</span> from pool.<br>Setting autocommit to <span class="hljs-literal">false</span> on JDBC Connection [com.mysql.jdbc.JDBC4Connection@64cd705f]<br>==&gt;  Preparing: select id, username, birthday, sex, address from users<br>==&gt; Parameters: <br>&lt;==    Columns: id, username, birthday, sex, address<br>&lt;==        Row: <span class="hljs-number">2</span>, 张三, <span class="hljs-number">2001</span>-<span class="hljs-number">07</span>-<span class="hljs-number">12</span>, <span class="hljs-number">1</span>, 北京市<br>&lt;==        Row: <span class="hljs-number">3</span>, 张小明, <span class="hljs-number">1999</span>-<span class="hljs-number">02</span>-<span class="hljs-number">22</span>, <span class="hljs-number">1</span>, 河南<br>&lt;==      Total: <span class="hljs-number">11</span><br>Users&#123;id=<span class="hljs-number">2</span>, username=<span class="hljs-string">&#x27;张三&#x27;</span>, birthDate=<span class="hljs-literal">null</span>, sex=<span class="hljs-number">1</span>, address=<span class="hljs-string">&#x27;北京市&#x27;</span>&#125;<br>Users&#123;id=<span class="hljs-number">3</span>, username=<span class="hljs-string">&#x27;张小明&#x27;</span>, birthDate=<span class="hljs-literal">null</span>, sex=<span class="hljs-number">1</span>, address=<span class="hljs-string">&#x27;河南&#x27;</span>&#125;<br><br>Resetting autocommit to <span class="hljs-literal">true</span> on JDBC Connection [com.mysql.jdbc.JDBC4Connection@64cd705f]<br>Closing JDBC Connection [com.mysql.jdbc.JDBC4Connection@64cd705f]<br>Returned connection <span class="hljs-number">1691185247</span> to pool.<br></code></pre></td></tr></table></figure>



<h1 id="八、ORM"><a href="#八、ORM" class="headerlink" title="八、ORM"></a>八、ORM</h1><h2 id="1-0-ORM概念"><a href="#1-0-ORM概念" class="headerlink" title="1.0 ORM概念"></a>1.0 ORM概念</h2><p>(Object Relational Mapping):对象关系映射</p>
<p>  MyBatis框架是ORM非常优秀的框架.</p>
<p><strong>编写程序的时候，以面向对象的方式处理数据，保存数据的时候，却以关系型数据库的方式存储</strong></p>
<h2 id="2-0-持久化操作"><a href="#2-0-持久化操作" class="headerlink" title="2.0 持久化操作"></a>2.0 持久化操作</h2><p><strong>持久化等同于ORM，将对象中的字段与数据库中的字段关联起来形成映射关系；</strong></p>
<p>包括两点：</p>
<p>​	<strong>一是将内存中的对象保存到关系型数据库中</strong></p>
<p>​	<strong>二是将数据库中的记录读取到内存中形成对象</strong></p>
<p>  MyBatis是持久化层优秀的框架.</p>
<hr>
<p><img src="https://cdn.jsdelivr.net/gh/fgcy-333/gitnote-images/2022/8/27202208261728556.png" srcset="/img/loading.gif" lazyload></p>
<hr>
<h1 id="九、源码追踪"><a href="#九、源码追踪" class="headerlink" title="九、源码追踪"></a>九、源码追踪</h1><ul>
<li><strong>断点追踪</strong></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br></pre></td><td class="code"><pre><code class="hljs java">在这四个地方加断点：<br>	<span class="hljs-type">SqlSessionFactory</span> <span class="hljs-variable">sessionFactory</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SqlSessionFactoryBuilder</span>().build(is);<br>    sqlSession = sessionFactory.openSession();<br>    mapper = sqlSession.getMapper(UsersMapper.class);<br>	List&lt;Users&gt; users = mapper.findAll();<br><br>使用ctrl+alt+ 《--<br><br><span class="hljs-number">1</span>）XMLConfigBuilder：进行sqlMapConfig.xml文件的解析的<br>=============》root的值<br>    &lt;configuration&gt;<br>    &lt;properties resource=<span class="hljs-string">&quot;db.properties&quot;</span>/&gt;    <br>    &lt;settings&gt;<br>        &lt;setting name=<span class="hljs-string">&quot;cacheEnabled&quot;</span> value=<span class="hljs-string">&quot;true&quot;</span>/&gt;        <br>        &lt;setting name=<span class="hljs-string">&quot;lazyLoadingEnabled&quot;</span> value=<span class="hljs-string">&quot;true&quot;</span>/&gt;        <br>        &lt;setting name=<span class="hljs-string">&quot;mapUnderscoreToCamelCase&quot;</span> value=<span class="hljs-string">&quot;true&quot;</span>/&gt;        <br>        &lt;setting name=<span class="hljs-string">&quot;logImpl&quot;</span> value=<span class="hljs-string">&quot;STDOUT_LOGGING&quot;</span>/&gt;        <br>    &lt;/settings&gt;<br>    &lt;typeAliases&gt;<br>        &lt;typeAlias alias=<span class="hljs-string">&quot;users&quot;</span> type=<span class="hljs-string">&quot;com.fgcy.pojo.Users&quot;</span>/&gt;        <br>    &lt;/typeAliases&gt;<br>    &lt;environments <span class="hljs-keyword">default</span>=<span class="hljs-string">&quot;development&quot;</span>&gt;<br>        &lt;environment id=<span class="hljs-string">&quot;development&quot;</span>&gt;<br>            &lt;transactionManager type=<span class="hljs-string">&quot;JDBC&quot;</span>/&gt;            <br>            &lt;dataSource type=<span class="hljs-string">&quot;POOLED&quot;</span>&gt;<br>                &lt;property name=<span class="hljs-string">&quot;driver&quot;</span> value=<span class="hljs-string">&quot;$&#123;jdbc.driverClassName&#125;&quot;</span>/&gt;                <br>                &lt;property name=<span class="hljs-string">&quot;url&quot;</span> value=<span class="hljs-string">&quot;$&#123;jdbc.url&#125;&quot;</span>/&gt;                <br>                &lt;property name=<span class="hljs-string">&quot;username&quot;</span> value=<span class="hljs-string">&quot;$&#123;jdbc.username&#125;&quot;</span>/&gt;                <br>                &lt;property name=<span class="hljs-string">&quot;password&quot;</span> value=<span class="hljs-string">&quot;$&#123;jdbc.password&#125;&quot;</span>/&gt;                <br>            &lt;/dataSource&gt;<br>        &lt;/environment&gt;<br>    &lt;/environments&gt;<br>    &lt;mappers&gt;<br>        &lt;mapper class=<span class="hljs-string">&quot;com.fgcy.mapper.UsersMapper&quot;</span>/&gt;        <br>    &lt;/mappers&gt;<br>&lt;/configuration&gt;<br><br><span class="hljs-number">2</span>）解析properties<br><span class="hljs-title function_">propertiesElement</span><span class="hljs-params">(root.evalNode(<span class="hljs-string">&quot;properties&quot;</span>)</span>);        <br>===============》context的值<br>    &lt;properties resource=<span class="hljs-string">&quot;db.properties&quot;</span>/&gt;<br>	context.getStringAttribute(<span class="hljs-string">&quot;resource&quot;</span>);<span class="hljs-comment">//db.properties</span><br>	<span class="hljs-built_in">this</span>.parser.setVariables(defaults);<br>【<br>	defaults的值：<br>		<span class="hljs-string">&quot;jdbc.url&quot;</span> -&gt; <span class="hljs-string">&quot;jdbc:mysql://localhost:13306/ssm?useUnicode=true&amp;characterEncoding=utf8&amp;allowMultiQueries=true&quot;</span><br>        <span class="hljs-string">&quot;jdbc.username&quot;</span> -&gt; <span class="hljs-string">&quot;root&quot;</span><br>        <span class="hljs-string">&quot;jdbc.password&quot;</span> -&gt; <span class="hljs-string">&quot;root123&quot;</span><br>        <span class="hljs-string">&quot;jdbc.driverClassName&quot;</span> -&gt; <span class="hljs-string">&quot;com.mysql.jdbc.Driver&quot;</span><br> 】<br>    <span class="hljs-built_in">this</span>.configuration.setVariables(defaults);<br><br><span class="hljs-number">3</span>)解析typeAliases<br>===========&gt;parent的值<br>    &lt;typeAliases&gt;<br>        &lt;typeAlias alias=<span class="hljs-string">&quot;users&quot;</span> type=<span class="hljs-string">&quot;com.fgcy.pojo.Users&quot;</span>/&gt;    <br>    &lt;/typeAliases&gt;<br>===============》child值<br>    XNode child : parent.getChildren() <span class="hljs-comment">//得到子节点</span><br>	&lt;typeAlias alias=<span class="hljs-string">&quot;users&quot;</span> type=<span class="hljs-string">&quot;com.fgcy.pojo.Users&quot;</span>/&gt;<br>     <span class="hljs-comment">//使用别名和对象类型进行注册</span><br>     typeAliasRegistry.registerAlias(alias, clazz);<br><br><span class="hljs-number">4</span>）解析environments<br>==========》context的值<br>&lt;environments <span class="hljs-keyword">default</span>=<span class="hljs-string">&quot;development&quot;</span>&gt;<br>    &lt;environment id=<span class="hljs-string">&quot;development&quot;</span>&gt;<br>        &lt;transactionManager type=<span class="hljs-string">&quot;JDBC&quot;</span>/&gt;        <br>        &lt;dataSource type=<span class="hljs-string">&quot;POOLED&quot;</span>&gt;<br>            &lt;property name=<span class="hljs-string">&quot;driver&quot;</span> value=<span class="hljs-string">&quot;com.mysql.jdbc.Driver&quot;</span>/&gt;            <br>            &lt;property name=<span class="hljs-string">&quot;url&quot;</span> 		      value=<span class="hljs-string">&quot;jdbc:mysql://localhost:13306/ssmuseUnicode=true&amp;characterEncoding=utf8&amp;allowMultiQueries=true&quot;</span>/&gt;            <br>            &lt;property name=<span class="hljs-string">&quot;username&quot;</span> value=<span class="hljs-string">&quot;root&quot;</span>/&gt;            <br>            &lt;property name=<span class="hljs-string">&quot;password&quot;</span> value=<span class="hljs-string">&quot;root123&quot;</span>/&gt;            <br>        &lt;/dataSource&gt;<br>    &lt;/environment&gt;<br>&lt;/environments&gt;<br><br>   environment = context.getStringAttribute(<span class="hljs-string">&quot;default&quot;</span>);<span class="hljs-comment">//development</span><br>	XNode child : context.getChildren() <span class="hljs-comment">//遍历子节点</span><br>===========》第一个child的值<br>    &lt;environment id=<span class="hljs-string">&quot;development&quot;</span>&gt;<br>    &lt;transactionManager type=<span class="hljs-string">&quot;JDBC&quot;</span>/&gt;    <br>    &lt;dataSource type=<span class="hljs-string">&quot;POOLED&quot;</span>&gt;<br>        &lt;property name=<span class="hljs-string">&quot;driver&quot;</span> value=<span class="hljs-string">&quot;com.mysql.jdbc.Driver&quot;</span>/&gt;        <br>        &lt;property name=<span class="hljs-string">&quot;url&quot;</span> value=<span class="hljs-string">&quot;jdbc:mysql://localhost:13306/ssm?allowMultiQueries=true&quot;</span>/&gt;        <br>        &lt;property name=<span class="hljs-string">&quot;username&quot;</span> value=<span class="hljs-string">&quot;root&quot;</span>/&gt;        <br>        &lt;property name=<span class="hljs-string">&quot;password&quot;</span> value=<span class="hljs-string">&quot;root123&quot;</span>/&gt;        <br>    &lt;/dataSource&gt;<br>&lt;/environment&gt;<br>此时datasource对象初始成功<br>        <br><span class="hljs-number">4</span>）解析mapper<br>==============》parent的值        <br>        &lt;mappers&gt;<br>            &lt;mapper class=<span class="hljs-string">&quot;com.fgcy.mapper.UsersMapper&quot;</span>/&gt;    <br>        &lt;/mappers&gt;<br>                <br>XNode child : parent.getChildren()<span class="hljs-comment">//遍历子节点</span><br>==============》第一个child的值<br>  	&lt;mapper class=<span class="hljs-string">&quot;com.fgcy.mapper.UsersMapper&quot;</span>/&gt;<br>	<span class="hljs-comment">//先手判断是不是标签名是不是package 优先级最高</span><br>    <span class="hljs-keyword">if</span> (<span class="hljs-string">&quot;package&quot;</span>.equals(child.getName())) &#123;<br>          <span class="hljs-type">String</span> <span class="hljs-variable">mapperPackage</span> <span class="hljs-operator">=</span> child.getStringAttribute(<span class="hljs-string">&quot;name&quot;</span>);<br>          configuration.addMappers(mapperPackage);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>          <span class="hljs-type">String</span> <span class="hljs-variable">resource</span> <span class="hljs-operator">=</span> child.getStringAttribute(<span class="hljs-string">&quot;resource&quot;</span>);<br>          <span class="hljs-type">String</span> <span class="hljs-variable">url</span> <span class="hljs-operator">=</span> child.getStringAttribute(<span class="hljs-string">&quot;url&quot;</span>);<br>          <span class="hljs-type">String</span> <span class="hljs-variable">mapperClass</span> <span class="hljs-operator">=</span> child.getStringAttribute(<span class="hljs-string">&quot;class&quot;</span>);<br>        <span class="hljs-comment">//优先级第二resource</span><br>          <span class="hljs-keyword">if</span> (resource != <span class="hljs-literal">null</span> &amp;&amp; url == <span class="hljs-literal">null</span> &amp;&amp; mapperClass == <span class="hljs-literal">null</span>) &#123;<br>            ErrorContext.instance().resource(resource);<br>            <span class="hljs-type">InputStream</span> <span class="hljs-variable">inputStream</span> <span class="hljs-operator">=</span> Resources.getResourceAsStream(resource);<br>            <span class="hljs-type">XMLMapperBuilder</span> <span class="hljs-variable">mapperParser</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">XMLMapperBuilder</span>(inputStream, configuration, resource, configuration.getSqlFragments());<br>            mapperParser.parse();<br>            <span class="hljs-comment">//优先级第三url</span><br>          &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (resource == <span class="hljs-literal">null</span> &amp;&amp; url != <span class="hljs-literal">null</span> &amp;&amp; mapperClass == <span class="hljs-literal">null</span>) &#123;<br>            ErrorContext.instance().resource(url);<br>            <span class="hljs-type">InputStream</span> <span class="hljs-variable">inputStream</span> <span class="hljs-operator">=</span> Resources.getUrlAsStream(url);<br>            <span class="hljs-type">XMLMapperBuilder</span> <span class="hljs-variable">mapperParser</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">XMLMapperBuilder</span>(inputStream, configuration, url, configuration.getSqlFragments());<br>            mapperParser.parse();<br>              <span class="hljs-comment">//优先级第四class</span><br>          &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (resource == <span class="hljs-literal">null</span> &amp;&amp; url == <span class="hljs-literal">null</span> &amp;&amp; mapperClass != <span class="hljs-literal">null</span>) &#123;<br>            Class&lt;?&gt; mapperInterface = Resources.classForName(mapperClass);<br>              <span class="hljs-comment">//将mapper注册给configuration</span><br>            configuration.addMapper(mapperInterface);<br></code></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-number">6</span>)SqlSession解析<br>alt + <span class="hljs-number">7</span> 列出本类或接口中的全部成员（属性+方法）<br>ctrl + h 列出本类或本接口中的实现类或子类，改变按钮可以的到父类或父接口<br><br><span class="hljs-number">7</span>）MapperProxy解析<br>	<span class="hljs-comment">//拿到一个被动态代理的对象</span><br>    <span class="hljs-keyword">final</span> MapperProxy&lt;T&gt; mapperProxy = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MapperProxy</span>&lt;&gt;(sqlSession, mapperInterface, methodCache);<br>    <span class="hljs-keyword">return</span> (T) Proxy.newProxyInstance(mapperInterface.getClassLoader(), <span class="hljs-keyword">new</span> <span class="hljs-title class_">Class</span>[] &#123; mapperInterface &#125;, mapperProxy);<br><br><span class="hljs-number">8</span>）MapperMethod：执行代理增强功能的类<br>    mapperProxy对象所属的类实现了InvocationHandler接口<br>    以下是invoke方法的具体逻辑：<br>            <span class="hljs-keyword">if</span> (Object.class.equals(method.getDeclaringClass())) &#123;<br>                <span class="hljs-keyword">return</span> method.invoke(<span class="hljs-built_in">this</span>, args);<br>            &#125;<br><br>            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.isDefaultMethod(method)) &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.invokeDefaultMethod(proxy, method, args);<br>            &#125;<br>重点：<br>      <span class="hljs-type">MapperMethod</span> <span class="hljs-variable">mapperMethod</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">this</span>.cachedMapperMethod(method);<br>      <span class="hljs-keyword">return</span> mapperMethod.execute(<span class="hljs-built_in">this</span>.sqlSession, args);<br>在MapperMethod类中：<br>        <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> MapperMethod.SqlCommand command;<span class="hljs-comment">//对象mapper.xml文件中的sql语句 静态内部类</span><br>    	<span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> MapperMethod.MethodSignature method;<span class="hljs-comment">//对应mapper.java中的方法  静态内部类</span><br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SqlCommand</span> &#123;<br>        <span class="hljs-comment">//sql语句的id属性值</span><br>        <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> String name;<br>        <span class="hljs-comment">//对象select标签</span><br>        <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> SqlCommandType type;<br>    &#125;<br></code></pre></td></tr></table></figure>


                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/%E8%A7%86%E9%A2%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" class="category-chain-item">视频学习笔记</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/Mybatis-DongLi/">#Mybatis-DongLi</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>Mybatis-dongli</div>
      <div>http://example.com/2023/03/30/动力-Mybatis/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>Author</div>
          <div>John Doe</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>Posted on</div>
          <div>March 30, 2023</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>Licensed under</div>
          <div>
            
              
              
                <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - Attribution">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2023/03/30/%E5%8A%A8%E5%8A%9B-SpringBoot/" title="SpringBoot-dongli">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">SpringBoot-dongli</span>
                        <span class="visible-mobile">Previous</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2023/03/30/%E5%8A%A8%E5%8A%9B-SpringMVC/" title="SpringMVC-dongli">
                        <span class="hidden-mobile">SpringMVC-dongli</span>
                        <span class="visible-mobile">Next</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  
  
    <article id="comments" lazyload>
      

    </article>
  


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>Table of Contents</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">Keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>WAITING</span></a> 
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="busuanzi_container_site_pv" style="display: none">
        总访问量 
        <span id="busuanzi_value_site_pv"></span>
         次
      </span>
    
    
      <span id="busuanzi_container_site_uv" style="display: none">
        总访客数 
        <span id="busuanzi_value_site_uv"></span>
         人
      </span>
    
    
  
</div>

  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>

  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">Blog works best with JavaScript enabled</div>
  </noscript>
</body>
</html>
